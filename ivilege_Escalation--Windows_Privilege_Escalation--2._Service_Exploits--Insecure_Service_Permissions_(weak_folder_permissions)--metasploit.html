<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>metasploit</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>metasploit</h1><br/>Prerequisite:<br />â€¢ meterpreter session<br /><br />To exploit this vulnerability we can use the module:<br />    <strong>exploit/windows/local/service_permissions</strong><br /> <br /> This module will try to identify services that the user has write access on the binary path and if this succeeds, will write a payload in a temporary folder, reconfigure the binary path of the service to point into the payload and not in the original executable and finally will attempt to restart the service in order for the payload to be executed as SYSTEM.<br /> <br />we can check the code here:   <br /><div class="codebox"><pre>gedit <span style="color:#ff9d00;font-weight:700">/</span>usr<span style="color:#ff9d00;font-weight:700">/</span>share<span style="color:#ff9d00;font-weight:700">/</span>metasploit-framework<span style="color:#ff9d00;font-weight:700">/</span>modules<span style="color:#ff9d00;font-weight:700">/</span>exploits<span style="color:#ff9d00;font-weight:700">/</span>windows<span style="color:#ff9d00;font-weight:700">/</span>local<span style="color:#ff9d00;font-weight:700">/</span>service_permissions.rb</pre></div><br /><br /><a href=""><img src="images/928-1.png" alt="images/928-1.png" /></a><br /><br /></div>
</body>
</html>
