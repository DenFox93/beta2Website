<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>MSRPC (135)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>MSRPC (135)</h1><br/>We can query the RPC locator service and individual RPC endpoints to <span style="text-decoration:underline;">catalog interesting services running over TCP, UDP, HTTP, and SMB (via named pipes)</span>. Each IFID value gathered through this process denotes an RPC service<br /><div class="codebox"><pre>msf&gt; use auxiliary<span style="color:#ff9d00;font-weight:700">/</span>scanner<span style="color:#ff9d00;font-weight:700">/</span>dcerpc<span style="color:#ff9d00;font-weight:700">/</span>endpoint_mapper</pre></div><br /><br /><strong>Notable RPC Interfaces</strong><br />• IFID: 12345778-1234-abcd-ef00-0123456789ab<br />    Named Pipe: <strong>\pipe\lsarpc</strong><br />    Description: LSA interface, used to enumerate users.<br />• IFID: 3919286a-b10c-11d0-9ba8-00c04fd92ef5<br />    Named Pipe: <strong>\pipe\lsarpc</strong><br />    Description: LSA Directory Services (DS) interface, used to enumerate domains and trust relationships.<br />• IFID: 12345778-1234-abcd-ef00-0123456789ac<br />    Named Pipe: <strong>\pipe\samr</strong><br />    Description: LSA SAMR interface, used to access public SAM database elements (e.g., usernames) and brute-force user passwords regardless of account lockout policy.<br />• IFID: 1ff70682-0a51-30e8-076d-740be8cee98b<br />    Named Pipe: <strong>\pipe\atsvc</strong><br />    Description: Task scheduler, used to remotely execute commands.<br />• IFID: 338cd001-2244-31f1-aaaa-900038001003<br />    Named Pipe: <strong>\pipe\winreg</strong><br />    Description: Remote registry service, used to access and modify the system registry.<br />• IFID: 367abb81-9844-35f1-ad32-98f038001003<br />    Named Pipe: <strong>\pipe\svcctl</strong><br />    Description: Service control manager and server services, used to remotely start and stop services and execute commands.<br />• IFID: 4b324fc8-1670-01d3-1278-5a47bf6ee188<br />    Named Pipe: <strong>\pipe\srvsvc</strong><br />    Description: Service control manager and server services, used to remotely start and stop services and execute commands.<br />• IFID: 4d9f4ab8-7d1c-11cf-861e-0020af6e7c57<br />    Named Pipe: <strong>\pipe\epmapper</strong><br />    Description: DCOM interface, used for brute-force password grinding and information gathering via WM.<br /><br /><br /><br /> <br /> <br /> <br /> 99fcfec4-5260-101b-bbcb-00aa0021347a → it is an interface ID of the RPCSS(<a href="https://www.blackhat.com/presentations/win-usa-04/bh-win-04-seki-up2.pdf">source</a>): IOXIDResolver on a Windows 2000,XP,2003 systems<br /><a href=""><img src="images/419-1.png" alt="images/419-1.png" /></a><br /> Exploit for this RPCSS services: windows/dcerpc/ms03_026_dcom<br />    <a href=""><img src="images/419-2.png" alt="images/419-2.png" /></a><br /> <br /> <br /><strong> Bibliography:</strong><br /> <a href="https://book.hacktricks.xyz/pentesting/135-pentesting-msrpc">https://book.hacktricks.xyz/pentesting/135-pentesting-msrpc</a></div>
</body>
</html>
