<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Log Poisoning</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Log Poisoning</h1><br/><br /><br />We have seen in <a href="--Penetration_Test_Methodology--WebApp_Pentest--Exploitation--Server-side--File_Inclusion--Remote_Code_Execution_(RCE)--LFI_-_File_Upload.html">LFI/File Upload</a>  that if we include any file that contains PHP code, it will get executed, as long as the vulnerable function as the Execute privileges. <br /><br />The Log Poisoning attack rely on the same concept of <a href="--Penetration_Test_Methodology--WebApp_Pentest--Exploitation--Server-side--File_Inclusion--Remote_Code_Execution_(RCE)--LFI_-_File_Upload.html">LFI/File Upload</a>: <br />1. Writing PHP code in a field we control that gets logged into a log file (i.e. poison/contaminate the log file)<br />2. Then include that log file to execute the PHP code<br /><br />Prerequisites:<br />• read privileges over the logged files<br /><br /><br /><strong><h3>Vulnerable Functions that allow the execution of files uploaded</h3></strong><br /><table class="table"><tr><th>Function</th><th>Read Content</th><th>Execute</th><th>Remote URL</th></tr></table><br /><table class="table"><tr><th>PHP</th><th> </th><th> </th><th> </th></tr><tr><td>include()/include_once()</td><td>✅</td><td>✅</td><td>✅</td></tr><tr><td>require()/require_once()</td><td>✅</td><td>✅</td><td>❌</td></tr></table><br /><table class="table"><tr><th>NodeJS</th><th> </th><th> </th><th> </th></tr><tr><td>res.render()</td><td>✅</td><td>✅</td><td>❌</td></tr></table><br /><table class="table"><tr><th>Java</th><th> </th><th> </th><th> </th></tr><tr><td>import</td><td>✅</td><td>✅</td><td>✅</td></tr></table><br /><table class="table"><tr><th>.NET</th><th> </th><th> </th><th> </th></tr><tr><td>include</td><td>✅</td><td>✅</td><td>✅</td></tr></table><br /><br /><br /><strong>Wordlists</strong><br />Server Configuration Files<br />   ◇ Linux<br />      ▪ Seclists: <a href="https://raw.githubusercontent.com/DragonJAR/Security-Wordlist/main/LFI-WordList-Linux">https://raw.githubusercontent.com/DragonJAR/Security-Wordlist/main/LFI-WordList-Linux</a><br />      <br />   ◇ Windows<br />      ▪ Seclists: <a href="https://raw.githubusercontent.com/DragonJAR/Security-Wordlist/main/LFI-WordList-Windows">https://raw.githubusercontent.com/DragonJAR/Security-Wordlist/main/LFI-WordList-Windows</a><br /><br /><br /><br /><br /><br /><strong>Bibliography:</strong><br /><a href="https://academy.hackthebox.com/">https://academy.hackthebox.com/</a></div>
</body>
</html>
