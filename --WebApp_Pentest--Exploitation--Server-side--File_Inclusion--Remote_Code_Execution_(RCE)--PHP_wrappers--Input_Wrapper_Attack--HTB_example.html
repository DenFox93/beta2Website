<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>HTB example</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>HTB example</h1><br/><br /><br />0. Once we have found a LFI<br />    <a href=""><img src="images/2355-1.png" alt="images/2355-1.png" /></a><br /><br /><strong>1. Read PHP Configurations through “</strong><a href="tation--Server-side--File_Inclusion--Local_File_Inclusion(LFI)_File_Disclosure--PHP_Filters_(PHP_Wrappers)--2._PHP_Source_Code_Disclosure.html">PHP Source Code Disclosure</a><strong>”</strong><br />    PHP configurations file can also be found in:<br />   ◇ Apache → /etc/php/X.Y/apache2/php.ini<br />   ◇ Nginx → /etc/php/X.Y/fpm/php.ini<br />	*where X.Y is the PHP version of the webapp version<br />	where the PHP version available are:<br />	<div class="codebox"><pre>8.1<br />8.0<br />7.4<br />7.3<br />7.2<br />7.1<br />7.0<br />5.6<br />5.5<br />5.4<br />5.3<br />5.2<br />5.1<br />5.0<br />4.4<br />4.3<br />4.2<br />4.1<br />4.0</pre></div><br />	To do that we can use Burp Intruder<br />    <a href=""><img src="images/2355-2.png" alt="images/2355-2.png" /></a><br />    <a href=""><img src="images/2355-3.png" alt="images/2355-3.png" /></a><br />    The Encoded data is inside the response<br />    <a href=""><img src="images/2355-4.png" alt="images/2355-4.png" /></a><br /><br />Now we can decode it and grep for <code>allow_url_include</code> or <code>expect</code><br /><div class="codebox"><pre>cat encoded.txt | base64 -d | grep -E &#39;allow_url_include|expect&#39;</pre></div><br />    <a href=""><img src="images/2355-5.png" alt="images/2355-5.png" /></a><br />    This mean that COULD be possible all the PHP wrappers attacks<br />   ◇ Data Wrapper Attack<br />   ◇ Input Wrapper Attack<br />   ◇ Expect Wrapper Attack<br /><br /><strong>2. Remote Code Execution</strong><br />Attack with the Input wrapper attack<br />• with Burp<br />   <a href=""><img src="images/2355-6.png" alt="images/2355-6.png" /></a><br />• with Curl<br />   ◇ GET and POST<br />       <a href=""><img src="images/2355-7.png" alt="images/2355-7.png" /></a><br />   ◇ only POST<br />       <a href=""><img src="images/2355-8.png" alt="images/2355-8.png" /></a><br />      <br /></div>
</body>
</html>
