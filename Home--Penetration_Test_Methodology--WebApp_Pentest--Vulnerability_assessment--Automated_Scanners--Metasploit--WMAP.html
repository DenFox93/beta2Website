<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>WMAP</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>WMAP</h1><br/>GitHub: <a href="https://github.com/rapid7/metasploit-framework/blob/04e8752b9b74cbaad7cb0ea6129c90e3172580a2/plugins/wmap.rb">https://github.com/rapid7/metasploit-framework/blob/04e8752b9b74cbaad7cb0ea6129c90e3172580a2/plugins/wmap.rb</a><br /><strong>Architecture(How it works)</strong> <br />    <a href=""><img src="images/1627-1.png" alt="images/1627-1.png" /></a><br /><br /><br />WMAP is a <span style="text-decoration:underline;">Web assessment plugin</span> for the metasploit framework from Efrain Torres (<a href="https://twitter.com/etlow">@etlow</a>), a tool that is been presented for the first time at the <a href="https://defcon.org/images/defcon-17/dc-17-presentations/defcon-17-efrain_torres-metasploit_goes_web.pdf">DefCon 17 (August 2009)</a>.<br />The best documentation of this plugin can be found here: <a href="https://github.com/rapid7/metasploit-framework/blob/8909ad12ba83b22b90c196815991817f70530ae5/documentation/wmap.txt">documentation github</a> <br /><br /><strong>Phases</strong><br />1. Metasploit Crawler/Spider<br />    Metasploit includes its own application with spidering/crawling capabilities. <br />    The below crawlers are <span style="text-decoration:underline;">not serviceable replacements for Burp or ZAP</span>, but be aware of them as a potential feature to employ when needed.<br />       ◇ <strong>auxiliary/crawler/msfcrawler</strong>   (better, developed directly by Efrain Torres)<br />       ◇ auxiliary/scanner/http/crawler<br />2. Import sites to the database<br />   ◇ use <a href="tion_Test_Methodology--WebApp_Pentest--Vulnerability_assessment--Automated_Scanners--Metasploit--Continue_from_previous_Scans_(db_import).html">db_import</a> to import previous scans from other tools<br />       <div class="codebox"><pre>root@kali# systemctl start postgresql<br />root@kali# msfdb init<br />root@kali# msfconsole<br />msf&gt; workspace -a [nameNewWorkspace]          <span style="color:#0088ff;font-weight:400">#create a new workspace</span><br />msf&gt; db_import [<span style="color:#ff9d00;font-weight:700">file</span>]                         <span style="color:#0088ff;font-weight:400">#import file</span></pre></div><br />   ◇ import manually with wmap_sites <br />       <div class="codebox"><pre>msf&gt; wmap_sites -a www.example.net,http<span style="color:#ff9d00;font-weight:700">://</span>192.168.1.66</pre></div><br />3. Launch <span style="text-decoration:underline;">WMAP plugin</span><br />    <div class="codebox"><pre>msf&gt; load wmap<br />msf&gt; <span style="color:#ff9d00;font-weight:700">help</span> wmap</pre></div><br />    <a href=""><img src="images/1627-2.png" alt="images/1627-2.png" /></a><br />    <a href=""><img src="images/1627-3.png" alt="images/1627-3.png" /></a><br />4. Targets of wmap<br />    The target of wmap are the ones that are stored in the database after that we have <span style="text-decoration:underline;">crawled/spidered (point 1)</span> or <span style="text-decoration:underline;">imported (point 2)</span><br />    <div class="codebox"><pre>msf&gt; wmap_sites -l                                            <span style="color:#0088ff;font-weight:400">#list of posssible targets in the database</span><br />msf&gt; wmap_targets -t www.example.net,http<span style="color:#ff9d00;font-weight:700">://</span>192.168.1.66      <span style="color:#0088ff;font-weight:400">#define targets</span><br />msf&gt; wmap_targets -l                                          <span style="color:#0088ff;font-weight:400">#list of targets</span></pre></div><br />5. List of enabled modules by default<br />    <div class="codebox"><pre>msf&gt; wmap_run -t</pre></div><br />    <a href=""><img src="images/1627-4.png" alt="images/1627-4.png" /></a><br />6. Launch only modules that we want (from the previous list)<br />    To include “external” modules of metasploit that are not originally tought for WMAP see <a href="https://github.com/rapid7/metasploit-framework/blob/8909ad12ba83b22b90c196815991817f70530ae5/documentation/wmap.txt#:~:text=Wmap%20modules%20are%20normal,can%20be%20included%20in%20a%20module%20if%20needed">here</a> and here<br />    <div class="codebox"><pre>msf&gt; wmap_run -h<br />msf&gt; wmap_run -m [regex]                <span style="color:#0088ff;font-weight:400">#Launch only modules that name match provided regex</span><br />msf&gt; wmap_run -p [regex]                <span style="color:#0088ff;font-weight:400">#Only test path defined by regex</span></pre></div><br />    <a href=""><img src="images/1627-5.png" alt="images/1627-5.png" /></a><br /><br />8. Launch the scan<br />    <div class="codebox"><pre>msf&gt; wmap_run -e</pre></div><br />    <a href=""><img src="images/1627-6.png" alt="images/1627-6.png" /></a><br />9. Results of the scan<br />    <div class="codebox"><pre>msf&gt; wmap_vulns -l</pre></div><br />    <a href=""><img src="images/1627-7.png" alt="images/1627-7.png" /></a><br />    <br />Bibliography:<br /><a href="https://null-byte.wonderhowto.com/how-to/use-metasploits-wmap-module-scan-web-applications-for-common-vulnerabilities-0187572/">https://null-byte.wonderhowto.com/how-to/use-metasploits-wmap-module-scan-web-applications-for-common-vulnerabilities-0187572/</a><br /></div>
</body>
</html>
