<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>search exploit for Windows</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>search exploit for Windows</h1><br/><br />site: <a href="https://github.com/bitsadmin/wesng">https://github.com/bitsadmin/wesng</a><br /><br /><strong><h3>Windows Exploit Suggester New Generation</h3></strong><br />This is a tool for identifying missing patches on the Windows target which may indicate possible vulnerabilities.<br />The tool takes the output from the ‘systeminfo’ command and compares the target’s patch levels (hotfixes installed) against the latest version of the vulnerability database. <br />It use the following databases:<br />• Microsoft Security Bulletin Data: KBs for older systems <br />• MSRC: The Microsoft Security Update API of the Microsoft Security Response Center (MSRC): Standard source of information for modern Microsoft Updates<br />• NIST National Vulnerability Database (NVD): Complement vulnerabilities with Exploit-DB links<br />These are combined into a single .csv file which is compressed(definitions.zip) and hosted in this GitHub repository.<br /><br />1. Install<br />    <div class="codebox"><pre>root@kali<span style="color:#ff9d00;font-weight:700">:/</span># <span style="color:#ff9d00;font-weight:700">cd</span> <span style="color:#ff9d00;font-weight:700">/</span>home<span style="color:#ff9d00;font-weight:700">/</span>kali<span style="color:#ff9d00;font-weight:700">/</span>bin<br />root@kali<span style="color:#ff9d00;font-weight:700">:/</span>home<span style="color:#ff9d00;font-weight:700">/</span>kali<span style="color:#ff9d00;font-weight:700">/</span>bin# git clone https<span style="color:#ff9d00;font-weight:700">://</span>github.com<span style="color:#ff9d00;font-weight:700">/</span>bitsadmin<span style="color:#ff9d00;font-weight:700">/</span>wesng.git<br />root@kali<span style="color:#ff9d00;font-weight:700">:/</span>home<span style="color:#ff9d00;font-weight:700">/</span>kali<span style="color:#ff9d00;font-weight:700">/</span>bin# <span style="color:#ff9d00;font-weight:700">cd</span> wesng<br /></pre></div><br />  <br />2. update the database that we will use:<br />    <div class="codebox"><pre>root@kali<span style="color:#ff9d00;font-weight:700">:/</span>home<span style="color:#ff9d00;font-weight:700">/</span>kali<span style="color:#ff9d00;font-weight:700">/</span>bin<span style="color:#ff9d00;font-weight:700">/</span>wesng# python wes.py --update<br />root@kali<span style="color:#ff9d00;font-weight:700">:/</span>home<span style="color:#ff9d00;font-weight:700">/</span>kali<span style="color:#ff9d00;font-weight:700">/</span>bin<span style="color:#ff9d00;font-weight:700">/</span>wesng# <span style="color:#ff9d00;font-weight:700">ls</span> </pre></div><br />    <a href=""><img src="images/937-1.png" alt="images/937-1.png" /></a><br /><br />3. retrieve the system information from the target machine and run wes.py:<br />   ◇ <span style="text-decoration:underline;">systeminfo</span> &lt;---- BETTER<br />       <div class="codebox"><pre>C<span style="color:#ff9d00;font-weight:700">:\</span>&gt; systeminfo</pre></div><br />       <a href=""><img src="images/937-2.png" alt="images/937-2.png" /></a><br />       Copy the results in a txt file that we will give to wesng<br />       <div class="codebox"><pre>root@kali<span style="color:#ff9d00;font-weight:700">:/</span>home<span style="color:#ff9d00;font-weight:700">/</span>kali<span style="color:#ff9d00;font-weight:700">/</span>bin<span style="color:#ff9d00;font-weight:700">/</span>wesng# <span style="color:#ff9d00;font-weight:700">cat</span> <span style="color:#ff9d00;font-weight:700">/</span>home<span style="color:#ff9d00;font-weight:700">/</span>kali<span style="color:#ff9d00;font-weight:700">/</span>Desktop<span style="color:#ff9d00;font-weight:700">/</span>sysinfo.txt          <span style="color:#0088ff;font-weight:400">#contnent of the file</span></pre></div><br />        run wes.py<br />        <div class="codebox"><pre>root@kali<span style="color:#ff9d00;font-weight:700">:/</span>home<span style="color:#ff9d00;font-weight:700">/</span>kali<span style="color:#ff9d00;font-weight:700">/</span>bin<span style="color:#ff9d00;font-weight:700">/</span>wesng# python wes.py <span style="color:#ff9d00;font-weight:700">/</span>home<span style="color:#ff9d00;font-weight:700">/</span>kali<span style="color:#ff9d00;font-weight:700">/</span>Desktop<span style="color:#ff9d00;font-weight:700">/</span>sysinfo.txt <span style="color:#ff9d00;font-weight:700">|&amp;</span> <span style="color:#ff9d00;font-weight:700">tee</span> <span style="color:#ff9d00;font-weight:700">/</span>home<span style="color:#ff9d00;font-weight:700">/</span>kali<span style="color:#ff9d00;font-weight:700">/</span>Desktop<span style="color:#ff9d00;font-weight:700">/</span>outputWes.txt    <span style="color:#0088ff;font-weight:400">#better</span></pre></div><br />        or<br />        <div class="codebox"><pre>root@kali<span style="color:#ff9d00;font-weight:700">:/</span>home<span style="color:#ff9d00;font-weight:700">/</span>kali<span style="color:#ff9d00;font-weight:700">/</span>bin<span style="color:#ff9d00;font-weight:700">/</span>wesng# python wes.py <span style="color:#ff9d00;font-weight:700">/</span>home<span style="color:#ff9d00;font-weight:700">/</span>kali<span style="color:#ff9d00;font-weight:700">/</span>Desktop<span style="color:#ff9d00;font-weight:700">/</span>sysinfo.txt --output <span style="color:#ff9d00;font-weight:700">/</span>home<span style="color:#ff9d00;font-weight:700">/</span>kali<span style="color:#ff9d00;font-weight:700">/</span>Desktop<span style="color:#ff9d00;font-weight:700">/</span>outputWes2.txt</pre></div><br />   ◇ <span style="text-decoration:underline;">wmi KB hotfixes</span><br />        If we’re unable to read the hotfixes installed from the &quot;systeminfo&quot; command then we can also try using the WMI command-line (WMIC) utility<br />        <a href=""><img src="images/937-3.png" alt="images/937-3.png" /></a><br />       <div class="codebox"><pre>C<span style="color:#ff9d00;font-weight:700">:</span><span style="color:#333333;font-weight:400">\&gt;</span> wmic qfe list full</pre></div><br />        run wes.py with the option --patches followed by the KB hotfixes found with wmic<br />       <div class="codebox"><pre>python wes.py <span style="color:#ff9d00;font-weight:700">/</span>home<span style="color:#ff9d00;font-weight:700">/</span>kali<span style="color:#ff9d00;font-weight:700">/</span>Desktop<span style="color:#ff9d00;font-weight:700">/</span>sysinfo.txt --patches KB2534111 KB2999226 KB3004394 KB976902 <span style="color:#ff9d00;font-weight:700">|&amp;</span> <span style="color:#ff9d00;font-weight:700">tee</span> <span style="color:#ff9d00;font-weight:700">/</span>home<span style="color:#ff9d00;font-weight:700">/</span>kali<span style="color:#ff9d00;font-weight:700">/</span>Desktop<span style="color:#ff9d00;font-weight:700">/</span>outputWes.txt</pre></div><br /><br />5. We can search informations for the CVE here:<br />    <a href="https://www.securityfocus.com/bid">https://www.securityfocus.com/bid</a><br /><br />To know other possible commands of wesng:<br /><div class="codebox"><pre>root@kali<span style="color:#ff9d00;font-weight:700">:/</span>home<span style="color:#ff9d00;font-weight:700">/</span>kali<span style="color:#ff9d00;font-weight:700">/</span>bin<span style="color:#ff9d00;font-weight:700">/</span>wesng# python wes.py</pre></div><br />OPTIONS:<br />--impact &quot;Remote Code Execution&quot;  → filter output for remote execution vulnerability<br />--impact “Elevation of Privilege” → filter output for privilege escalation vulnerability<br /><br /><br /></div>
</body>
</html>
