<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>DOM-Based (Type 0)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>DOM-Based (Type 0)</h1><br/><a href="Home--Penetration_Test_Methodology--WebApp_Pentest--web_application_basics--HTTP_&_HTTPS_protocol--Document_Object_Model_(DOM).html">Document Object Model (DOM)</a> [seen in Web Application → Web Application basics → Document Object Model(DOM)]<br /><br />DOM XSS occurs when<br />• JavaScript is used to change the page source through the Document Object Model (DOM).<br /><br />In a DOM XSS we have access to the source code of the vulnerable function, this is usually done by inspecting the javascript(.js) file.<br />Because of that is possible to precisely write the required payload for a successful injection.<br /><br />As <a href="Home--Penetration_Test_Methodology--WebApp_Pentest--web_application_basics--HTTP_&_HTTPS_protocol--Document_Object_Model_(DOM).html">we have seen in this explanation</a> Document Object Model (DOM) is a standard interface provided by JavaScript that allows for dynamic access to the pieces of the current page and browser window.<br />A DOM-based XSS attack is possible if the web application writes data to the Document Object Model without proper sanitization. The attacker can manipulate this data to include XSS content on the web page, for example, malicious JavaScript code.<br />An attacker may use several DOM objects to create a Cross-site Scripting attack. The most popular objects from this perspective are document.url, document.location, and document.referrer.<br />The DOM events are often used in XSS exploitation because they <span style="text-decoration:underline;">allow us to avoid using suspicious characters like  &lt; and &gt; </span><br /><br />• <strong>What is in common with the other XSS</strong><br />   ◇ Exploitation still leads to JavaScript execution<br />   ◇ Flaw still more overtly impactful to the client<br />   ◇ Difficulty convincing many organizations of the importance<br />   ◇ Methods of discovery and exploitation of Dom-Based <span style="text-decoration:underline;">often</span> closer to Reflected XSS than Stored<br />      ▪ BUT<span style="text-decoration:underline;"> there can be both persistent and non-persistent versions of DOM-Based XSS</span><br />• <strong>Which are the differences with the other XSS</strong><br />   ◇ It is not the server that deliver the attacker’s JavaScript to the client, instead the Javascript execution occur with the rendering of the Web Application in the Client side<br /><br /><br /><strong><h3>Source</h3></strong><strong><h3> &amp; </h3></strong><strong><h3>Sink</h3></strong><br />• <span style="color:#ffa500;text-decoration:underline;">Source</span> is the JavaScript object that takes the user input, and it can be any input parameter like a URL parameter or an input field<br />• <span style="color:#a020f0;text-decoration:underline;">Sink</span> is the function that writes the user input to a DOM Object on the page. If the Sink function does not properly sanitize the user input, it would be vulnerable to an XSS attack<br />	Some of the commonly used JavaScript functions to write to DOM objects are<br />   ◇ Document Object Properties and Methods that can be used on HTML documents<br />      ▪ <a href="ation_Test_Methodology--WebApp_Pentest--Exploitation--Client-Side--Cross_Site_Scripting(XSS)--Classes_of_XSS--DOM-Based_(Type_0)--write().html">document.write()</a><br />      ▪ document.writeln()<br />      ▪ document.domain<br />      ▪  <a href="ion_Test_Methodology--WebApp_Pentest--Exploitation--Client-Side--Cross_Site_Scripting(XSS)--Classes_of_XSS--DOM-Based_(Type_0)--innerHTML.html">element.innerHTML</a><br />      ▪ element.outerHTML<br />      ▪ element.insertAdjacentHTML<br />      ▪ element.onevent<br />   ◇ jQuery methods (a JavaScript Library)<br />      ▪ <a href="thodology--WebApp_Pentest--Exploitation--Client-Side--Cross_Site_Scripting(XSS)--Classes_of_XSS--DOM-Based_(Type_0)--JQuery_attr()_method.html">attr()</a><br />      ▪ add()<br />      ▪ after()<br />      ▪ append()<br /><br /><br /><br /><span style="color:#a5452a;">example payloads:</span><br />   ◇ &quot; onload=&quot;javascript:alert(&#39;XSS Example&#39;)<br />      <div class="codebox"><pre>http://example.com/index.php?name=&quot; onload=&quot;javascript:alert(&#39;XSS Example&#39;)</pre></div><br />   ◇ &quot; onload=&quot;alert(String.fromCharCode(88,83,83))<br />      <div class="codebox"><pre>http://example.com/index.php?name=&quot; onload=&quot;alert(String.fromCharCode(88,83,83))</pre></div><br />      by avoid using single quotes can be more harder to detect<br /><br /><strong>Bibliography:</strong><br />• <a href="https://www.acunetix.com/blog/articles/dom-xss-explained/">https://www.acunetix.com/blog/articles/dom-xss-explained/</a><br />• <a href="http://www.webappsec.org/projects/articles/071105.shtml">http://www.webappsec.org/projects/articles/071105.shtml</a><br />• <a href="https://portswigger.net/web-security/cross-site-scripting/dom-based">https://portswigger.net/web-security/cross-site-scripting/dom-based</a></div>
</body>
</html>
