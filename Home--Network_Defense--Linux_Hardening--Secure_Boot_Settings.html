<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Secure Boot Settings</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Secure Boot Settings</h1><br/><br />A bootloader is the first software program that runs when a computers starts. <br />It is responsible for loading and transferring control to the Operating System kernel software. The kernel in turn will initialize the rest of the operating system. <br /><br /><br /><br /><br />The recommendations in this section focus on securing the bootloader and settings involved in boot process directly<br /><br />• Ensure permissions on bootloader config are not overridden<br />    Check the permission of /boot/grub/grub.cfg. <br />    Setting the permissions to read and write for root only (400) prevents non-root users from seeing the boot parameters or changing them. Non-root users (444) who read the boot parameters may be able to identify weaknesses in security upon boot and be able to exploit them.<br />    <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">grep</span> -E <span style="color:#3ad900;font-weight:400">&#39;^\s*chmod\s+[0-7][0-7][0-7]\s+\$\{grub_cfg\}\.new&#39;</span> -A 1 -B1 <span style="color:#ff9d00;font-weight:700">/</span>usr<span style="color:#ff9d00;font-weight:700">/</span>sbin<span style="color:#ff9d00;font-weight:700">/</span>grub-mkconfig</pre></div><br />    <a href=""><img src="images/2200-1.png" alt="images/2200-1.png" /></a><br /><br />• Ensure bootloader password is set<br />    Setting the boot loader password will require that anyone rebooting the system must enter a password before being able to<br />    <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">grep</span> <span style="color:#3ad900;font-weight:400">&quot;^set superusers&quot;</span> <span style="color:#ff9d00;font-weight:700">/</span>boot<span style="color:#ff9d00;font-weight:700">/</span>grub<span style="color:#ff9d00;font-weight:700">/</span>grub.cfg</pre></div><br />     grep &quot;^set superusers&quot; /boot/grub/grub.cfg<br />    <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">grep</span> <span style="color:#3ad900;font-weight:400">&quot;^password&quot;</span> <span style="color:#ff9d00;font-weight:700">/</span>boot<span style="color:#ff9d00;font-weight:700">/</span>grub<span style="color:#ff9d00;font-weight:700">/</span>grub.cfg</pre></div><br />     password_pbkdf2 &lt;username&gt; &lt;encrypted-password&gt;<br /><br />• Ensure permissions on bootloader config are configured<br />    The grub configuration file contains information on boot settings and passwords for unlocking boot options.<br />    Setting the permissions to read and write for root only prevents non-root users from seeing the boot parameters or changing them. Non-root users who read the boot parameters may be able to identify weaknesses in security upon boot and be able to exploit them.<br />    <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">stat</span> <span style="color:#ff9d00;font-weight:700">/</span>boot<span style="color:#ff9d00;font-weight:700">/</span>grub<span style="color:#ff9d00;font-weight:700">/</span>grub.cfg</pre></div><br /><br />• Ensure Authentication required for single user mode<br />    requiring authentication in single user mode prevents an unauthorized user from rebooting the system into single user to gain root privileges without credentials.<br />    To determine if the a password is set for the root user.<br />    <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">grep</span> -Eq <span style="color:#3ad900;font-weight:400">&#39;^root:\$[0-9]&#39;</span> <span style="color:#ff9d00;font-weight:700">/</span>etc<span style="color:#ff9d00;font-weight:700">/</span>shadow <span style="color:#ff9d00;font-weight:700">||</span> <span style="color:#ff9d00;font-weight:700">echo</span> <span style="color:#3ad900;font-weight:400">&quot;root is locked&quot;</span></pre></div><br />    <a href=""><img src="images/2200-2.png" alt="images/2200-2.png" /></a><br />    </div>
</body>
</html>
