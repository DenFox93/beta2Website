<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>HTTP Tampering</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>HTTP Tampering</h1><br/><br /><br /><strong><h3>HTTP Verb Tampering</h3></strong><br />sending malicious requests using unexpected verbs (methods), may lead to bypassing the web application&#39;s authorization mechanism or even bypassing its security controls against other web attacks. <br /><br /><strong>HTTP Verbs</strong><br />HTTP has 9 different verbs(<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods">https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods</a>) that can be accepted as HTTP methods by web servers. <br />Commonly used HTTP verbs:<br /><table class="table"><tr><th>Verb</th><th>Description</th></tr><tr><td>GET</td><td>The GET method requests a representation of the specified resource. Requests using GET should only retrieve data</td></tr><tr><td>HEAD</td><td>Identical to a GET request, but its response only contains the headers, without the response body</td></tr><tr><td>POST</td><td>The POST method submits an entity to the specified resource, often causing a change in state or side effects on the server</td></tr><tr><td>PUT</td><td>Writes the request payload to the specified location</td></tr><tr><td>DELETE</td><td>Deletes the resource at the specified location</td></tr><tr><td>OPTIONS</td><td>Shows different options accepted by a web server, like accepted HTTP verbs</td></tr><tr><td>PATCH</td><td>Apply partial modifications to the resource at the specified location</td></tr></table><br /><br /><strong>HTTP Tampering can be caused by two types of Vulnerabilities:</strong><br />• <span style="color:#9141ac;">Insecure Configurations</span><br />• <span style="color:#ff7800;">Insecure Coding</span><br /><br /><strong><span style="color:#9141ac;">Insecure Configurations</span></strong><br />A web server&#39;s authentication configuration may be limited to specific HTTP methods, which would leave some HTTP methods accessible without authentication.<br /><span style="text-decoration:underline;">Note</span>: not very commin since is usually avoided by secure web server configurations, as documentation often cautions against it.<br />Apache Manual:<br />   ◇  <a href="https://httpd.apache.org/docs/2.4/mod/core.html#:~:text=will%20be%20used.-,%3CLimit%3E%20Directive,-Description%3A">https://httpd.apache.org/docs/2.4/mod/core.html#:~:text=will%20be%20used.-,%3CLimit%3E%20Directive,-Description%3A</a><br />   ◇ <a href="http://svn.apache.org/repos/asf/httpd/httpd/tags/2.0.26/docs/manual/mod/core.html#limit">http://svn.apache.org/repos/asf/httpd/httpd/tags/2.0.26/docs/manual/mod/core.html#limit</a><br /><span style="color:#865e3c;">Example of misconfiguration(XML):</span><br />	In this example only requests done with GET and POST require an authentication. Because of that an attacker can use a different HTTP method (like HEAD) to bypass this authentication<h3><br />	</h3><div class="codebox"><pre>&lt;Limit GET POST&gt;<br />    Require valid-user<br />&lt;/Limit&gt;</pre></div><br /><br /><strong><span style="color:#ff7800;">Insecure Coding</span></strong> <br />Insecure coding could lead to HTTP Verb Tampering vulnerabilities (though some may not consider this Verb Tampering).<br />This can occur when a web developer applies specific filters to mitigate particular vulnerabilities while not covering all HTTP methods with that filter.<br /><span style="text-decoration:underline;">Note</span>: more common then <span style="color:#9141ac;">insecure configurations</span>, as it is due to mistakes made in coding<br /><span style="color:#865e3c;">Example of Insecure Coding (php):</span><br />	In this example is done an input sanitization filter only on the GET parameter. If an attacker use a POST request, the GET parameters would be empty (will not include any bad characters). The request would pass the security filter, which would make the function vulnerable to SQL Injection.<br />	<div class="codebox"><pre>$pattern = &quot;/^[A-Za-z\s]+$/&quot;;<br /><br />if(preg_match($pattern, $_GET[&quot;code&quot;])) {<br />    $query = &quot;Select * from ports where port_code like &#39;%&quot; . $_REQUEST[&quot;code&quot;] . &quot;%&#39;&quot;;<br />    ...SNIP...<br />}</pre></div><br /></div>
</body>
</html>
