<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Windows Powershell</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Windows Powershell</h1><br/><br />1. <strong>net view</strong>: Check Available Shared Folders<br />	<div class="codebox"><pre>net view [address]</pre></div><br />	<a href=""><img src="images/2636-1.png" alt="images/2636-1.png" /></a><br /><br />2. <strong>Get-ChildItem</strong> (gci): Show content of the shared folder<br />	<div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">Get-ChildItem</span> <span style="color:#ff9d00;font-weight:700">\\</span>[address]<span style="color:#ff9d00;font-weight:700">\</span>folder</pre></div><br />	<a href=""><img src="images/2636-2.png" alt="images/2636-2.png" /></a><br /><br />3. <strong>New-PSDrive</strong>: We can connect to a file share with the following command and map its content to the drive letter N<br />   ◇ anonymous authentication<br />	<div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">New-PSDrive</span> <span style="color:#333333;font-weight:400">-Name</span> <span style="color:#3ad900;font-weight:400">&quot;N&quot;</span> <span style="color:#ff9d00;font-weight:700">-</span>Root <span style="color:#3ad900;font-weight:400">&quot;\\[address]\folder&quot;</span> <span style="color:#ff9d00;font-weight:700">-</span>PSProvider <span style="color:#3ad900;font-weight:400">&quot;FileSystem&quot;</span></pre></div><br />	<a href=""><img src="images/2636-3.png" alt="images/2636-3.png" /></a><br />   ◇ authenticate with user and password<br />  	<div class="codebox"><pre><span style="color:#0088ff;font-weight:400">$username</span> <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#333333;font-weight:400">&#39;plaintext&#39;</span><br /><span style="color:#0088ff;font-weight:400">$password</span> <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#333333;font-weight:400">&#39;Password123&#39;</span><br /><span style="color:#0088ff;font-weight:400">$secpassword</span> <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#ff9d00;font-weight:700">ConvertTo-SecureString</span> <span style="color:#0088ff;font-weight:400">$password</span> <span style="color:#ff9d00;font-weight:700">-</span>AsPlainText <span style="color:#ff9d00;font-weight:700">-</span>Force<br /><span style="color:#0088ff;font-weight:400">$cred</span> <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#ff9d00;font-weight:700">New-Object</span> System.Management.Automation.PSCredential <span style="color:#0088ff;font-weight:400">$username</span>, <span style="color:#0088ff;font-weight:400">$secpassword</span><br /><span style="color:#ff9d00;font-weight:700">New-PSDrive</span> <span style="color:#333333;font-weight:400">-Name</span> <span style="color:#3ad900;font-weight:400">&quot;N&quot;</span> <span style="color:#ff9d00;font-weight:700">-</span>Root <span style="color:#3ad900;font-weight:400">&quot;[address]\folder&quot;</span> <span style="color:#ff9d00;font-weight:700">-</span>PSProvider <span style="color:#3ad900;font-weight:400">&quot;FileSystem&quot;</span> <span style="color:#ff9d00;font-weight:700">-</span>Credential <span style="color:#0088ff;font-weight:400">$cred</span></pre></div><br />  With the shared folder mapped as the n drive, we can execute Windows commands as if this shared folder is on our local computer.<br />		<a href=""><img src="images/2636-4.png" alt="images/2636-4.png" /></a><br /><br />4. <strong>Get-ChildItem</strong>: find how many files the shared folder and its subdirectories contain the new created n drive<br />	<div class="codebox"><pre>N<span style="color:#ff9d00;font-weight:700">:</span><br />N<span style="color:#ff9d00;font-weight:700">:\</span>&gt; (<span style="color:#ff9d00;font-weight:700">Get-ChildItem</span> <span style="color:#ff9d00;font-weight:700">-</span>File <span style="color:#ff9d00;font-weight:700">-</span>Recurse | <span style="color:#ff9d00;font-weight:700">Measure-Object</span>).Count</pre></div><br />	<a href=""><img src="images/2636-5.png" alt="images/2636-5.png" /></a><br />	it this example only one file<br /><br />5. <strong>Get-ChildItem</strong>: To list all the files<br />	<div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">Get-ChildItem</span> <span style="color:#ff9d00;font-weight:700">-</span>Recurse <span style="color:#ff9d00;font-weight:700">-</span>Path N<span style="color:#ff9d00;font-weight:700">:\</span></pre></div><br />	<a href=""><img src="images/2636-6.png" alt="images/2636-6.png" /></a><br /><br />6. <strong>Get-ChildItem</strong>: To search for specific file<br />	With `dir` we can search for specific names in files such as:<br />      ▪ cred<br />      ▪ password<br />      ▪ users<br />      ▪ secrets<br />      ▪ key<br />      ▪ Common File Extensions for source code such as: .cs, .c, .go, .java, .php, .asp, .aspx, .html.<br />   ◇ -Include<br />	<div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">Get-ChildItem</span> <span style="color:#ff9d00;font-weight:700">-</span>Recurse <span style="color:#ff9d00;font-weight:700">-</span>Path N<span style="color:#ff9d00;font-weight:700">:\</span> <span style="color:#ff9d00;font-weight:700">-</span>Include <span style="color:#ff9d00;font-weight:700">*</span>PATTERN<span style="color:#ff9d00;font-weight:700">*</span> <span style="color:#ff9d00;font-weight:700">-</span>File</pre></div><br />	<a href=""><img src="images/2636-7.png" alt="images/2636-7.png" /></a><br />   ◇ Select-String<br />	<div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">Get-ChildItem</span> <span style="color:#ff9d00;font-weight:700">-</span>Recurse <span style="color:#ff9d00;font-weight:700">-</span>Path N<span style="color:#ff9d00;font-weight:700">:\</span> | <span style="color:#ff9d00;font-weight:700">Select-String</span> <span style="color:#3ad900;font-weight:400">&quot;PATTERN&quot;</span> <span style="color:#ff9d00;font-weight:700">-</span>List</pre></div></div>
</body>
</html>
