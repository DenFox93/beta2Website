<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Permitted HTTP Verbs</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Permitted HTTP Verbs</h1><br/><strong><h3>Enumerating permitted HTTP Verbs on a Web Application with OPTIONS</h3></strong><h3> </h3><br />• nc<br />     <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">printf</span> <span style="color:#3ad900;font-weight:400">&quot;OPTIONS / HTTP/1.1\r\nHost:www.example.com\r\n\r\n&quot;</span>  <span style="color:#ff9d00;font-weight:700">|</span> nc www.example.com 80</pre></div><br />    <a href=""><img src="images/1677-1.png" alt="images/1677-1.png" /></a><br />• curl<br />    <div class="codebox"><pre>curl -i -X OPTIONS &lt;IP&gt;</pre></div><br />    <a href=""><img src="images/1677-2.png" alt="images/1677-2.png" /></a><br /><br /><a href="Home--Penetration_Test_Methodology--WebApp_Pentest--web_application_basics--HTTP_&_HTTPS_protocol--API--REST_APIs_and_HTTP_methods--PUT.html">PUT verb</a><br />We will be able to use the PUT verb only on writable directories. Leave a directory writable by anyone is one of the biggest mistake that an Administrator can do.<br />1. enumerate verbs<br />    <div class="codebox"><pre>curl -i -X OPTIONS &lt;IP&gt;</pre></div><br />2. Looking for writable directories. It is a guess work, we need to study the application and understand what directories are used to store user submitted avatars, files, attachments…<br />3. Once we have a pool of candidate folders we will try our PUT command on them:<br />   ◇ manually       <div class="codebox"><pre>PUT /[writable directory]//new.html HTTP/1.1<br />Host: example.com<br />Content-type: text/html<br />Content-length: 16<br />&lt;p&gt;New File&lt;p&gt;</pre></div><br />   ◇ davtest tool(<a href="https://github.com/cldrn/davtest">https://github.com/cldrn/davtest</a>)<br />   <div class="codebox"><pre>davtest -url www.example.com</pre></div><br />4. If the folder result vulnerable we need to exploit it by uploading a shell<br />   <br />   <br />Bibliography:<br />• <a href="https://book.hacktricks.xyz/pentesting/pentesting-web/put-method-webdav">https://book.hacktricks.xyz/pentesting/pentesting-web/put-method-webdav</a><br />• <a href="https://www.yeahhub.com/http-put-method-exploitation-live-penetration-testing/">https://www.yeahhub.com/http-put-method-exploitation-live-penetration-testing/</a></div>
</body>
</html>
