<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Appended Extensions (PHP < 5.3/5.4)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Appended Extensions (PHP < 5.3/5.4)</h1><br/><br /><br />An extension could be appended to the parameter (es: <code>language</code>)<br /><span style="color:#a52a2a;">example source code PHP:</span><br />    <div class="codebox"><pre>include($_GET[&#39;language&#39;] . <span style="color:#3ad900;font-weight:400">&quot;.php&quot;</span>);</pre></div><br /><br />    This is common in web application, as in this case, since because of that we would not have to write the extension every time we use need to change the language. <br />    In this case, if we try to read /etc/passwd, then the file included would be /etc/passwd.php, which does not exist<br /><br /><strong><h3>Bypasses</h3></strong><br />Some web applications append an extension to our input string (e.g. .php), to ensure that the file we include is in the expected extension. <br />• NOT WORK: <span style="text-decoration:underline;">With modern versions of PHP</span>, we may not be able to bypass this and will be restricted to only reading files in that extension, which may still be useful for example to reading source code<br />• WORK: With PHP versions &lt; 5.3/5.4, is possible to use one of the following vulnerabilities:<br />   ◇ <span style="color:#9141ac;">Path Truncation</span><br />   ◇ <span style="color:#e01b24;">Null Bytes</span><br /><br /></div>
</body>
</html>
