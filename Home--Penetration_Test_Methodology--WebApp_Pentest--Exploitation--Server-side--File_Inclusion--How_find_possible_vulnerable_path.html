<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>How find possible vulnerable path</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>How find possible vulnerable path</h1><br/><br /><strong><h3>Common place where find LFI</h3></strong><br /> <br /><strong>Template engines </strong><br />They are used to render server side data that is split in different components. <br />In fact in order to have most of the web application looking the same when navigating between pages,a templating engine displays:<br />   ◇ <span style="color:#00ff00;">A page that shows the common static parts</span>, such as the header, navigation bar, and footer, <br />   ◇ <span style="color:#a020f0;">Then dynamically loads other content that changes between pages</span>. <br />Otherwise, every page on the server would need to be modified when changes are made to any of the static parts.<br /><strong><span style="color:#a52a2a;">example:</span></strong> <span style="color:#00ff00;">/index.php</span>?<span style="color:#a020f0;">page</span>=<span style="color:#a020f0;">about</span><br />   ◇ <span style="color:#00ff00;">index.php sets static content</span> (e.g. header/footer),<br />   ◇ Then pulls the <span style="color:#a020f0;">dynamic content</span> specified in the parameter, which in this case may be read from a file called <span style="color:#a020f0;">about.php</span>. <br />   As we have control over the about portion of the request, it may be possible to have the web application grab other files and display them on the page.<br /><br /><strong>Parameter that change the directory source</strong><br /><strong><span style="color:#a52a2a;">example:</span></strong> GET ?<span style="color:#a020f0;">language</span>=<span style="color:#a020f0;">XXX</span><br />If a user changes the language from a drop-down menu, then the same page would be returned but with a different language parameter (e.g. ?<span style="color:#a020f0;">language</span>=<span style="color:#a020f0;">es</span>).<br />In such cases, <span style="text-decoration:underline;">changing the language may change the directory the web application is loading the pages from</span> (e.g. <span style="color:#a020f0;">/en/</span> or <span style="color:#a020f0;">/es/</span>).<br />If we have control over the path being loaded, then we may be able to exploit this vulnerability to read other files and potentially reach remote code execution.<br /><br /><br />• spider/crawl a website with Burp/ZAP and take note of the parameters used.<br />    <a href=""><img src="images/1732-1.png" alt="images/1732-1.png" /></a><br /><br />• <a href="Home--Penetration_Test_Methodology--WebApp_Pentest--Reconnaissance_(Information_Gathering)--Enumerate_parameters_(fuzzing).html">FUZZ the parameters with Wfuzz</a> like we have seen in the &quot;API Testing&quot; chapter</div>
</body>
</html>
