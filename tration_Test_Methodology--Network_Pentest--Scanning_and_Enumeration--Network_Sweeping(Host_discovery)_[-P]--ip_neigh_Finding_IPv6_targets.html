<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>ip neigh: Finding IPv6 targets</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>ip neigh: Finding IPv6 targets</h1><br/>Scanning targets using the IPv6 protocol can be helpful for penetration testers because many firewalls and IPSs <strong>do not filter, block, or detect attacks transmitted via IPv6</strong>.<br />Even if the target organization&#39;s ISP does not transmit IPv6 traffic to the target over the internet, chances are that the target systems themselves speak IPv6 and can be accessed locally within the DMZ and intranet using the protocol, especially from systems on the same subnet.<br />We can exploit a system across the internet using IPv4 to gain access to a DMZ or internal network. Then we can scan for and exploit other targets using IPv6.<br /><br />We can use IPv6 addresses in Nmap using the &quot;<strong>-6</strong>&quot; option.<br /><br /><strong><h3>find targets on the local network</h3></strong> <br />ff02::1 → multicast address for a local subnet to identify IPv6 hosts<br />ff02::2 → multicast address for a local subnet to identify IPv6 routers. <br /><br />We can use <span style="color:#00ff00;">ping6</span> to find targets/neighbors:<br /><div class="codebox"><pre>ping6 <span style="color:#ff9d00;font-weight:700">-</span>I eth0 ff02<span style="color:#ff9d00;font-weight:700">::</span><span style="color:#333333;font-weight:400">1</span>       <span style="color:#0088ff;font-weight:400">#hosts</span></pre></div><br /><div class="codebox"><pre>ping6 <span style="color:#ff9d00;font-weight:700">-</span>I eth0 ff02<span style="color:#ff9d00;font-weight:700">::</span><span style="color:#333333;font-weight:400">2</span>       <span style="color:#0088ff;font-weight:400">#routers</span></pre></div><br /><br />The neighbors are cached thanks to the discovery previously done by <span style="color:#00ff00;">ping6</span>, we can see them by typing:<br /><div class="codebox"><pre>ip neigh</pre></div><br /><br />Then we can launch an Nmap scan to the IPv6 host, for example it could be like that:<br /><div class="codebox"><pre>nmap <span style="color:#ff9d00;font-weight:700">-</span>Pn <span style="color:#ff9d00;font-weight:700">-sV</span> <span style="color:#ff9d00;font-weight:700">-</span><span style="color:#333333;font-weight:400">6</span> fe80<span style="color:#ff9d00;font-weight:700">::</span><span style="color:#333333;font-weight:400">5660</span><span style="color:#ff9d00;font-weight:700">:</span>9ff<span style="color:#ff9d00;font-weight:700">:</span>fe39<span style="color:#ff9d00;font-weight:700">:</span>296c</pre></div><br /><br /><br />example:<br /><a href=""><img src="images/640-1.png" alt="images/640-1.png" /></a><br /><a href=""><img src="images/640-2.png" alt="images/640-2.png" /></a></div>
</body>
</html>
