<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Injections in File Name</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Injections in File Name</h1><br/><br />It is possible use a malicious string for the uploaded file name, which may get executed or processed if the uploaded file name is displayed (i.e., reflected) on the page. <br />Possible Attacks:<br />• Command Injection<br />• XSS<br />• SQL Injection<br /><br /><span style="color:#865e3c;">example Command Injection in the file name:</span><br />If we name a file:<br />   ◇ file$(whoami).jpg<br />   ◇ file`whoami`.jpg <br />   ◇ file.jpg||whoami<br />And then the web application attempts to move the uploaded file with an OS command (e.g. mv file /tmp), then our file name would inject the whoami command, which would get executed, leading to remote code execution. <br /><br /><span style="color:#865e3c;">example XSS in the file name:</span><br />If we name a file:<br />   ◇ &lt;script&gt;alert(window.origin);&lt;/script&gt;.jpg<br />the XSS payload could get executed on the target&#39;s machine if the file name is disabled to them. <br /><br /><span style="color:#865e3c;">example SQL Injection in the file name:</span><br />If we name a file:<br />   ◇ &#39;;select+sleep(5);--.jpg<br />May lead to an SQL injection if the file name is insecurely used in an SQL query.<br /></div>
</body>
</html>
