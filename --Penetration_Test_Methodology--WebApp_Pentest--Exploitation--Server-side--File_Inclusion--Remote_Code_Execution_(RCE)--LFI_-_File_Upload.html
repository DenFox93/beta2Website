<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>LFI / File Upload</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>LFI / File Upload</h1><br/><br /><strong><h3>Differences between “LFI/File Uploads” , “PHP Wrappers” , “File Upload” vulnerabilities</h3></strong><br />The vulnerability exploited in <span style="text-decoration:underline;">LFI / File Upload</span> is <strong>different</strong> from <a href="Home--Penetration_Test_Methodology--WebApp_Pentest--Exploitation--Server-side--File_Inclusion--Remote_Code_Execution_(RCE)--PHP_wrappers.html">PHP Wrappers</a> and <a href="Home--Penetration_Test_Methodology--WebApp_Pentest--Exploitation--Server-side--File_Upload.html">File Upload</a>.<br />Because the vulnerability that allow to exploit the functionality:<br />• in the <strong>LFI/File Uploads</strong> the vulnerability reside in the functions in the source code(see below) that allow to execute the file<br />• in the <strong>PHP Wrappers</strong> we need one of the following settings enabled in the PHP configuration file php.ini to be able to execute commands<br />   ◇ <a href="st_Methodology--WebApp_Pentest--Exploitation--Server-side--File_Inclusion--Remote_Code_Execution_(RCE)--PHP_wrappers--Data_Wrapper_Attack.html">allow_url_include = On</a><br />   ◇ <a href="_Methodology--WebApp_Pentest--Exploitation--Server-side--File_Inclusion--Remote_Code_Execution_(RCE)--PHP_wrappers--Expect_Wrapper_Attack.html">extension = expect</a><br />• in the <strong>File Upload</strong> the vulnerability reside in the <a href="Home--Penetration_Test_Methodology--WebApp_Pentest--Exploitation--Server-side--File_Upload--Preventing_File_Upload_Vulnerabilities.html">functions in the source code that do not whitelist or blacklist adeguadetely</a> the file that gets uploaded. Because of that the file uploaded could be executed as PHP file<br /><br />For the attack in this section, we do <span style="text-decoration:underline;">NOT require the file upload form</span>(functions that file to blacklist/whitelist adeguately) to be vulnerable, but <span style="text-decoration:underline;">merely allow us to upload files</span>.<br />For example we do not need that the file need to contain in the name “.php” because once uploaded is the vulnerable function that allow to execute files:<br /><br /><strong><h3>Vulnerable Functions that allow the execution of files uploaded</h3></strong><br /><table class="table"><tr><th>Function</th><th>Read Content</th><th>Execute</th><th>Remote URL</th></tr></table><br /><table class="table"><tr><th>PHP</th><th> </th><th> </th><th> </th></tr><tr><td>include()/include_once()</td><td>✅</td><td>✅</td><td>✅</td></tr><tr><td>require()/require_once()</td><td>✅</td><td>✅</td><td>❌</td></tr></table><br /><table class="table"><tr><th>NodeJS</th><th> </th><th> </th><th> </th></tr><tr><td>res.render()</td><td>✅</td><td>✅</td><td>❌</td></tr></table><br /><table class="table"><tr><th>Java</th><th> </th><th> </th><th> </th></tr><tr><td>import</td><td>✅</td><td>✅</td><td>✅</td></tr></table><br /><table class="table"><tr><th>.NET</th><th> </th><th> </th><th> </th></tr><tr><td>include</td><td>✅</td><td>✅</td><td>✅</td></tr></table><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><strong>Bibliography:</strong><br /><a href="https://academy.hackthebox.com/">https://academy.hackthebox.com/</a></div>
</body>
</html>
