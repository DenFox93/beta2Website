<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Bypass Client-Side Validation</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Bypass Client-Side Validation</h1><br/><br />To modify the Client Side code we have two options:<br />• <span style="text-decoration:underline;">Request Modification</span> → modify the request from a proxy<br />• <span style="text-decoration:underline;">Disable FrontEnd Validation</span> → modify the Client Side Code<br /><br /><strong><h3>Request Modification</h3></strong><br />If we capture the upload request with Burp, we see the following request being sent by the web application:<br /><a href=""><img src="images/2286-1.png" alt="images/2286-1.png" /></a><br />The web application appears to be sending a standard HTTP upload request to /upload.php.<br />This way, we can now modify this request to meet our needs without having the front-end type validation restrictions<br /><span style="text-decoration:underline;">If the back-end server does not validate the uploaded file type</span>, then we should theoretically be able to send any file type/content, and it would be uploaded to the server.<br />The two important parts in the request are:<br />   ◇ Content-Type of the uploaded file<br />   ◇ filename=&quot;HTB.png&quot; <br />   ◇ file content at the end of the request<br />    <a href=""><img src="images/2286-2.png" alt="images/2286-2.png" /></a><br /><br /><br /><strong><h3>Disable Front-end Validation</h3></strong><br />Another method to bypass client-side validations is through manipulating the front-end code. As these functions are being completely processed within our web browser, we have complete control over them.<br /><span style="text-decoration:underline;">Note:</span> The modification we made to the source code is temporary and will not persist through page refreshes<br />Click <code>[CTRL+SHIFT+C]</code> to toggle the browser&#39;s Page Inspector, and then click on the element that represent the file uploaded <br />    <a href=""><img src="images/2286-3.png" alt="images/2286-3.png" /></a><br />   1) modify this and select All Files <br />       <a href=""><img src="images/2286-4.png" alt="images/2286-4.png" /></a><br />   2) Check also <span style="color:#ffa500;">osubmit=onsubmit=&quot;if(validate()){upload()}&quot;</span>, which appears to run a JavaScript code whenever we upload a file, which appears to be doing the file type validation. <br />       To get the details of this function, we can go to the browser&#39;s Console by clicking <code>[CTRL+SHIFT+K]</code>, and then we can type the function&#39;s name (validate) to get its details:  <br />        <a href=""><img src="images/2286-5.png" alt="images/2286-5.png" /></a><br />        <a href=""><img src="images/2286-6.png" alt="images/2286-6.png" /></a><br />      With the conditional <span style="color:#ffa500;">validate()</span> function removed from the file input, we should be able to select our PHP web shell through the file selection dialog and upload it normally with no validations, similar to what we did in the previous section.<br />       <a href=""><img src="images/2286-7.png" alt="images/2286-7.png" /></a><br />   3) If we Inspect the Webshell/Image uploaded can reveal where is located<br />       <a href=""><img src="images/2286-8.png" alt="images/2286-8.png" /></a> <br />   4) We have got a Webshell<br />   <a href=""><img src="images/2286-9.png" alt="images/2286-9.png" /></a><br />   <a href=""><img src="images/2286-10.png" alt="images/2286-10.png" /></a><br /> <br /> <br /> <br /><strong><h3> Cheat Sheet</h3></strong><br /> <table class="table"><tr><th>Client-Side Bypass</th><th> </th></tr><tr><td>[CTRL+SHIFT+C]</td><td>Toggle Page Insepctor</td></tr></table><br /></div>
</body>
</html>
