<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Import-Module</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Import-Module</h1><br/><br />With &quot;Import-Module&quot; cmdlet we can import a module into our current PowerShell session<br /><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">PS</span>&gt; <span style="color:#ff9d00;font-weight:700">Import-Module</span> .<span style="color:#ff9d00;font-weight:700">\</span>module.psm1</pre></div><br /><br />Once we import a PowerShell module, all of its various cmdlets and other components become available to us, and we can simply then execute the cmdlets that are part of the module.<br /><br />The modules need to be copied in one of the modules paths specified by the <strong>$Env:PSModulePath</strong> powershell environment variable<br />    <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">PS</span>&gt; <span style="color:#0088ff;font-weight:400">$Env</span><span style="color:#ff9d00;font-weight:700">:</span>PSModulePath</pre></div><br />    <a href=""><img src="images/1360-1.png" alt="images/1360-1.png" /></a><br />   ◇ C:\Users\$env:username\Documents\WindowsPowerShell\Modules  &lt;--- use this<br />   ◇ C:\Program Files\WindowsPowerShell\Modules<br />   ◇ C:\Windows\system32\WindowsPowerShell\v1.0\Modules<br />IMPORTANT: the folder that we will drop in one of these folder need to have the same name of module file (.psm1) <br /><br /><br /><span style="color:#a5452a;">example with Powersploit</span><br /><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">PS</span>&gt; (<span style="color:#ff9d00;font-weight:700">new-object</span> System.Net.WebClient).DownloadFile(<span style="color:#3ad900;font-weight:400">&quot;https://github.com/PowerShellMafia/PowerSploit/archive/refs/heads/master.zip&quot;</span>, <span style="color:#3ad900;font-weight:400">&quot;$env:userprofile\desktop\master.zip&quot;</span>);<span style="color:#0088ff;font-weight:400">$ZippedFilePath</span> <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#3ad900;font-weight:400">&quot;$env:userprofile\desktop\master.zip&quot;</span>;<span style="color:#0088ff;font-weight:400">$DestinationFolder</span> <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#3ad900;font-weight:400">&quot;$env:userprofile\Documents\WindowsPowerShell\Modules&quot;</span>; [<span style="color:#7f0044;font-weight:400">void</span>] (<span style="color:#ff9d00;font-weight:700">New-Item</span> <span style="color:#ff9d00;font-weight:700">-</span>Path <span style="color:#0088ff;font-weight:400">$DestinationFolder</span> <span style="color:#ff9d00;font-weight:700">-</span>ItemType Directory <span style="color:#ff9d00;font-weight:700">-</span>Force);<span style="color:#0088ff;font-weight:400">$Shell</span> <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#ff9d00;font-weight:700">new-object</span> <span style="color:#ff9d00;font-weight:700">-</span>com Shell.Application;<span style="color:#0088ff;font-weight:400">$Shell</span>.Namespace(<span style="color:#0088ff;font-weight:400">$DestinationFolder</span>).copyhere(<span style="color:#0088ff;font-weight:400">$Shell</span>.NameSpace(<span style="color:#0088ff;font-weight:400">$ZippedFilePath</span>).Items(),<span style="color:#333333;font-weight:400">4</span>);<span style="color:#ff9d00;font-weight:700">Rename-Item</span> <span style="color:#3ad900;font-weight:400">&quot;$env:userprofile\Documents\WindowsPowerShell\Modules\PowerSploit-master&quot;</span> <span style="color:#3ad900;font-weight:400">&quot;$env:userprofile\Documents\WindowsPowerShell\Modules\PowerSploit&quot;</span></pre></div><br />now we should see the modules of Powersploit that we can import<br /><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">PS</span>&gt; <span style="color:#ff9d00;font-weight:700">Get-Module</span> <span style="color:#ff9d00;font-weight:700">-</span>ListAvailable     <span style="color:#0088ff;font-weight:400">#list modules that we can import</span><br /><span style="color:#ff9d00;font-weight:700">PS</span>&gt; <span style="color:#ff9d00;font-weight:700">Import-Module</span> PowerSploit     <span style="color:#0088ff;font-weight:400">#import module</span></pre></div><br />    <a href=""><img src="images/1360-2.png" alt="images/1360-2.png" /></a><br /><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">PS</span>&gt; <span style="color:#ff9d00;font-weight:700">Get-Module</span>                   <span style="color:#0088ff;font-weight:400">#imported modules</span></pre></div><br />    <a href=""><img src="images/1360-3.png" alt="images/1360-3.png" /></a><br />List all the cmdlets(commands) that we have imported with the PowerSploit module<br /><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">PS</span>&gt; <span style="color:#ff9d00;font-weight:700">Get-Command</span> <span style="color:#ff9d00;font-weight:700">-</span>Module PowerSploit     <span style="color:#0088ff;font-weight:400">#list commands that we hhave imported with Powersploit</span></pre></div><br />    <a href=""><img src="images/1360-4.png" alt="images/1360-4.png" /></a><br />For help on a specific PowerSploit cmdlet<br /><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">PS</span>&gt; <span style="color:#ff9d00;font-weight:700">Get-Help</span> <span style="color:#ff9d00;font-weight:700">Write-</span>HihackDLL</pre></div><br />    <a href=""><img src="images/1360-5.png" alt="images/1360-5.png" /></a><br />    <br /></div>
</body>
</html>
