<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Enumerate Users with Tools</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Enumerate Users with Tools</h1><br/>• <strong>nmap </strong><a href="https://nmap.org/nsedoc/scripts/smtp-enum-users.html">smtp-enum-users.nse</a> (BEST for very basic enumration)<br />    Attempts to enumerate the users on a SMTP server by issuing the VRFY, EXPN or RCPT TO commands. The goal of this script is to discover all the user accounts in the remote system.<br />      <div class="codebox"><pre>root@kali<span style="color:#ff9d00;font-weight:700">:/</span># nmap --script smtp-enum-users.nse &lt;ipTargetMailServer&gt;</pre></div><br />    *the username tested are only 10 how we can see from the source code here: <a href="https://github.com/nmap/nmap/blob/master/nselib/data/usernames.lst">https://github.com/nmap/nmap/blob/master/nselib/data/usernames.lst</a><br /><br />• <strong>smtp-user-enum</strong> from Cytopia: <a href="https://github.com/cytopia/smtp-user-enum">https://github.com/cytopia/smtp-user-enum</a> (BEST for custom user list)<br />    To enumerate with a custom list of users in a text file<br />    Listof Metasploit: <a href="https://github.com/rapid7/metasploit-framework/blob/master/data/wordlists/unix_users.txt">https://github.com/rapid7/metasploit-framework/blob/master/data/wordlists/unix_users.txt</a><br />    <div class="codebox"><pre>root@kali<span style="color:#ff9d00;font-weight:700">:/</span># git clone https<span style="color:#ff9d00;font-weight:700">://</span>github.com<span style="color:#ff9d00;font-weight:700">/</span>cytopia<span style="color:#ff9d00;font-weight:700">/</span>smtp-user-enum.git<br />root@kali<span style="color:#ff9d00;font-weight:700">:/</span># .<span style="color:#ff9d00;font-weight:700">/</span>smtp-user-enum -U <span style="color:#ff9d00;font-weight:700">/</span>usr<span style="color:#ff9d00;font-weight:700">/</span>share<span style="color:#ff9d00;font-weight:700">/</span>wordlists<span style="color:#ff9d00;font-weight:700">/</span>metasploit<span style="color:#ff9d00;font-weight:700">/</span>unix_users.txt 192.168.147.197 25</pre></div><br />    <a href=""><img src="images/1384-1.png" alt="images/1384-1.png" /></a><br /><br />• <strong>smtp-user-enum</strong> from PentestMonkey: <a href="http://pentestmonkey.net/tools/user-enumeration/smtp-user-enum">http://pentestmonkey.net/tools/user-enumeration/smtp-user-enum</a><br />    Less updated, to enumerate with a custom list of users in a text file<br />    <div class="codebox"><pre>root@kali<span style="color:#ff9d00;font-weight:700">:/</span># <span style="color:#ff9d00;font-weight:700">mkdir</span> smtp-user-enum-PentestMokey<br />root@kali<span style="color:#ff9d00;font-weight:700">:/</span># <span style="color:#ff9d00;font-weight:700">cd</span> smtp-user-enum-PentestMokey<br />root@kali<span style="color:#ff9d00;font-weight:700">:/</span># <span style="color:#ff9d00;font-weight:700">wget</span> https<span style="color:#ff9d00;font-weight:700">://</span>raw.githubusercontent.com<span style="color:#ff9d00;font-weight:700">/</span>pentestmonkey<span style="color:#ff9d00;font-weight:700">/</span>smtp-user-enum<span style="color:#ff9d00;font-weight:700">/</span>master<span style="color:#ff9d00;font-weight:700">/</span>smtp-user-enum.pl        <span style="color:#0088ff;font-weight:400">#tool</span><br />root@kali<span style="color:#ff9d00;font-weight:700">:/</span># <span style="color:#ff9d00;font-weight:700">chmod</span> +x smtp-user-enum.pl<br />root@kali<span style="color:#ff9d00;font-weight:700">:/</span># .<span style="color:#ff9d00;font-weight:700">/</span>smtp-user-enum.pl -M RCPT -U <span style="color:#ff9d00;font-weight:700">/</span>usr<span style="color:#ff9d00;font-weight:700">/</span>share<span style="color:#ff9d00;font-weight:700">/</span>wordlists<span style="color:#ff9d00;font-weight:700">/</span>metasploit<span style="color:#ff9d00;font-weight:700">/</span>unix_users.txt -t 192.168.147.192<br />root@kali<span style="color:#ff9d00;font-weight:700">:/</span># .<span style="color:#ff9d00;font-weight:700">/</span>smtp-user-enum.pl -M VRFY -U <span style="color:#ff9d00;font-weight:700">/</span>usr<span style="color:#ff9d00;font-weight:700">/</span>share<span style="color:#ff9d00;font-weight:700">/</span>wordlists<span style="color:#ff9d00;font-weight:700">/</span>metasploit<span style="color:#ff9d00;font-weight:700">/</span>unix_users.txt -t 192.168.147.192<br />root@kali<span style="color:#ff9d00;font-weight:700">:/</span># .<span style="color:#ff9d00;font-weight:700">/</span>smtp-user-enum.pl -M EXPN -U <span style="color:#ff9d00;font-weight:700">/</span>usr<span style="color:#ff9d00;font-weight:700">/</span>share<span style="color:#ff9d00;font-weight:700">/</span>wordlists<span style="color:#ff9d00;font-weight:700">/</span>metasploit<span style="color:#ff9d00;font-weight:700">/</span>unix_users.txt -t 192.168.147.192</pre></div><br /><br />• Metasploit <strong>smtp_enum</strong>: <a href="https://www.rapid7.com/db/modules/auxiliary/scanner/smtp/smtp_enum">https://www.rapid7.com/db/modules/auxiliary/scanner/smtp/smtp_enum</a><br />    code: <a href="https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/smtp/smtp_enum.rb">https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/smtp/smtp_enum.rb</a><br />    By default as username list it use /usr/share/wordlists/metasploit/unix_users.txt<br />    <div class="codebox"><pre>msf&gt; use auxiliary<span style="color:#ff9d00;font-weight:700">/</span>scanner<span style="color:#ff9d00;font-weight:700">/</span>smtp<span style="color:#ff9d00;font-weight:700">/</span>smtp_enum<br />msf&gt; <span style="color:#ff9d00;font-weight:700">set</span> RHOSTS 192.168.147.192                                     <span style="color:#0088ff;font-weight:400">#target IP</span><br />msf&gt; <span style="color:#ff9d00;font-weight:700">set</span> USER_FILE <span style="color:#ff9d00;font-weight:700">/</span>usr<span style="color:#ff9d00;font-weight:700">/</span>share<span style="color:#ff9d00;font-weight:700">/</span>wordlists<span style="color:#ff9d00;font-weight:700">/</span>metasploit<span style="color:#ff9d00;font-weight:700">/</span>unix_users.txt   <span style="color:#0088ff;font-weight:400">#default</span><br />msf&gt; run</pre></div><br /><br /><strong><h2>List of usernames</h2></strong><br />To have a list of potential usernames we can use:<br />• <strong>Metasploit Unix Usernames</strong>(BEST for SMTP): <br />    List: <a href="https://github.com/rapid7/metasploit-framework/blob/master/data/wordlists/unix_users.txt">https://github.com/rapid7/metasploit-framework/blob/master/data/wordlists/unix_users.txt</a><br />    common Unix usernames<br />    <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">cat</span> <span style="color:#ff9d00;font-weight:700">/</span>usr<span style="color:#ff9d00;font-weight:700">/</span>share<span style="color:#ff9d00;font-weight:700">/</span>wordlists<span style="color:#ff9d00;font-weight:700">/</span>metasploit<span style="color:#ff9d00;font-weight:700">/</span>unix_users.txt</pre></div><br />• <strong>statistically-likely-usernames</strong>: list of usernames <a href="https://github.com/insidetrust/statistically-likely-usernames">https://github.com/insidetrust/statistically-likely-usernames</a><br />   ◇ john.txt contains popular names: <a href="https://github.com/insidetrust/statistically-likely-usernames/blob/master/john.txt">https://github.com/insidetrust/statistically-likely-usernames/blob/master/john.txt</a><br />    <div class="codebox"><pre>root@kali<span style="color:#ff9d00;font-weight:700">:/</span># <span style="color:#ff9d00;font-weight:700">wget</span> https<span style="color:#ff9d00;font-weight:700">://</span>raw.githubusercontent.com<span style="color:#ff9d00;font-weight:700">/</span>insidetrust<span style="color:#ff9d00;font-weight:700">/</span>statistically-likely-usernames<span style="color:#ff9d00;font-weight:700">/</span>master<span style="color:#ff9d00;font-weight:700">/</span>john.txt   <span style="color:#0088ff;font-weight:400">#complete list of popular names</span><br />root@kali<span style="color:#ff9d00;font-weight:700">:/</span># <span style="color:#ff9d00;font-weight:700">head</span> -n 50 john.txt &gt;&gt; users.txt                                                                    <span style="color:#0088ff;font-weight:400">#only first 50 names, very small!!!!</span></pre></div><br />• <strong>TheHarvester</strong>: <a href="https://github.com/laramies/theHarvester">https://github.com/laramies/theHarvester</a>  <br />    It can be a <em><span style="text-decoration:underline;">passive</span></em> reconnaissance using a search engine like google or an <em><span style="text-decoration:underline;">active</span></em> reconnaissance using a DNS<br />    <div class="codebox"><pre>./theharvester.py -d &lt;site to scan&gt; -l &lt;number of result&gt; -b &lt;search engine&gt;<br />theHarvester -d &lt;site to scan&gt; -l &lt;number of result&gt; -b &lt;search engine&gt;</pre></div><br />    <span style="color:#a5452a;">example:</span><br />    <a href="file://G:/Other computers/Yoga 520/CherryTree/screenshots2/PTP-elearnsecurity/2. Network Security/1. Information Gathering/theharvester.png"><img src="images/1384-2.png" alt="images/1384-2.png" /></a><br />    <strong>-d</strong>: Domain to search or company name<br />    <strong>-b</strong>: data source: all (simultaneously search in all the sources), baidu, bing, bingapi, dogpile, google, googleCSE, googleplus, google-profiles, linkedin, pgp, twitter, vhost, virustotal, threatcrowd, crtsh, netcraft, yahoo<br />    <strong>-l</strong>: limit the number of results to work with<br />    <strong>-c</strong>: perform a DNS brute force for the domain name(active reconnaissance)<br /></div>
</body>
</html>
