<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Online Brute Force Attacks (password based login)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Online Brute Force Attacks (password based login)</h1><br/><br /><strong><h1>Brute-force attacks</h1></strong><br /><br /><br /><br /><br /><strong><h3>Brute-forcing usernames</h3></strong><br />Usernames are especially easy to guess if they conform to a recognizable pattern, such as an email address. For example, it is very common to see business logins in the format firstname.lastname@somecompany.com. <br />During auditing, check whether the website discloses potential usernames publicly. <br /><br /><strong><h3>Brute-forcing passwords</h3></strong><br />Passwords are usually not stored in clear text on the systems but as hash values. <br />List of files that can contain hashed passwords:<br /><table class="table"><tr><th>Windows</th><th>Linux</th></tr><tr><td>unattend.xml</td><td>shadow</td></tr><tr><td>sysprep.inf</td><td>shadow.bak</td></tr><tr><td>SAM</td><td>password</td></tr></table><br />Since the password cannot be calculated backward from the hash value, the brute force method determines the hash values belonging to the randomly selected passwords until a hash value matches the stored hash value. In this case, the password is found. This method is also called offline brute-forcing<br /><br />Many websites adopt some form of password policy, which forces users to create high-entropy passwords that are, theoretically at least, harder to crack using brute-force alone. <br />We can use a basic knowledge of human behavior to exploit the vulnerabilities that users unwittingly introduce to this system. Rather than creating a strong password with a random combination of characters, users often take a password that they can remember and try to crowbar it into fitting the password policy. <br /><span style="color:#a52a2a;">example:</span> &quot;mypassword&quot; become Mypassword1! or Myp4$$w0rd<br />This knowledge of likely credentials and predictable patterns means that brute-force attacks can often be much more sophisticated, and therefore effective, than simply iterating through every possible combination of characters.<br /><br /><strong><h3>Username enumeration</h3></strong><br />Username enumeration is when an attacker is able to observe changes in the website&#39;s behavior in order to identify whether a given username is valid.<br />We should pay particular attention to any differences in:<br />◇ <strong>Status codes</strong>: During a brute-force attack, the returned HTTP status code is likely to be the same for the vast majority of guesses because most of them will be wrong. If a guess returns a different status code, this is a strong indication that the username was correct. It is best practice for websites to always return the same status code regardless of the outcome, but this practice is not always followed.<br />◇ <strong>Error messages</strong>: Sometimes the returned error message is different depending on whether both the username AND password are incorrect or only the password was incorrect. It is best practice for websites to use identical, generic messages in both cases, but small typing errors sometimes creep in. Just one character out of place makes the two messages distinct, even in cases where the character is not visible on the rendered page.<br />◇ <strong>Response times</strong>: If most of the requests were handled with a similar response time, any that deviate from this suggest that something different was happening behind the scenes. This is another indication that the guessed username might be correct. For example, a website might only check whether the password is correct if the username is valid. This extra step might cause a slight increase in the response time. This may be subtle, but an attacker can make this delay more obvious by entering an excessively long password that the website takes noticeably longer to handle.<br /><br /><br /><strong><h3>Bypass the IP-based brute-force protection</h3></strong><br />• <strong>X-Forwarded-For</strong> header → could allow us to spoof the IP address and bypass the IP-based brute-force protection.<br />	The X-Forwarded-For header <span style="text-decoration:underline;">is usually set by a proxy</span>, but it can also be added by an attacker. By adding his own X-Forwarded-For header, the attacker can spoof his IP address. If the IP block is implemented incorrectly, it can be bypassed by putting an allowed IP address in the header, even if the connection actually originated from a blocked IP address<br />   ◇ Add this header in the response → X-Forwarded-For: §IPaddress§<br />   ◇ Here we can find a proxy list: <a href="https://github.com/ShiftyTR/Proxy-List/blob/master/proxy.txt">https://github.com/ShiftyTR/Proxy-List/blob/master/proxy.txt</a><br />   ◇ see the chapter <a href="de--Authentication--Online_Brute_Force_Attacks_(password_based_login)--Login_Form_Brute_Forcing--Username_enumeration_via_response_timing.html">Username enumeration via response timing</a> as example<br /><br /><br /><strong><h3>Methods of Brute Force Attacks</h3></strong><br /><table class="table"><tr><th>Attack</th><th>Description</th></tr><tr><td>Online Brute Force Attack</td><td>Attacking a live application over the network, like HTTP, HTTPs, SSH, FTP, and others</td></tr><tr><td>Offline Brute Force Attack</td><td>Also known as Offline Password Cracking, where you attempt to crack a hash of an encrypted password.</td></tr><tr><td>Reverse Brute Force Attack</td><td>Also known as username brute-forcing, where you try a single common password with a list of usernames on a certain service.</td></tr><tr><td>Hybrid Brute Force Attack</td><td>Attacking a user by creating a customized password wordlist, built using known intelligence about the user or the service.</td></tr></table><br /><br /><br /><br />Bibliography:<br /><a href="https://portswigger.net/web-security/authentication/password-based">https://portswigger.net/web-security/authentication/password-based</a></div>
</body>
</html>
