<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>arpspoof (ARP Poisoning)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>arpspoof (ARP Poisoning)</h1><br/><strong>arpspoof</strong> is part of a collection of tools <span style="text-decoration:underline;">Dsniff</span>.<br />arpspoof redirects packets from a <span style="color:#ff8700;">target host</span> (or all hosts) on the LAN intended for <span style="color:#1e90ff;">another host</span> on the LAN by forging ARP replies<br /><br /><strong>Before run arpspoof</strong> we have to enable the <span style="text-decoration:underline;">Linux Kernel IP Forwarding</span>, a feature that transforms a Linux machine into a router. By doing that we tell to our machine to forward the packets that we intercept to the real destination host<br /><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">echo</span> 1 &gt; <span style="color:#ff9d00;font-weight:700">/</span>proc<span style="color:#ff9d00;font-weight:700">/</span>sys<span style="color:#ff9d00;font-weight:700">/</span>net<span style="color:#ff9d00;font-weight:700">/</span>ipv4<span style="color:#ff9d00;font-weight:700">/</span>ip_forward</pre></div><br /><br /><strong>Now we can run arpspoof</strong> <br /><div class="codebox"><pre>arpspoof -i &lt;interface&gt; -r -t &lt;target&gt; &lt;host&gt;</pre></div><br />    -i &lt;interface&gt; → interface is the NIC we want to use, for example, eth0 for our local LAN<br />    -r → Poison both hosts (<span style="color:#ff8700;">target</span> and <span style="color:#1e90ff;">host</span>) to capture traffic in both directions.  (only valid  in  conjuntion with -t)<br />    -t &lt;<span style="color:#ff8700;">target</span>&gt; → host from which we intercept the packets<br />    -r &lt;<span style="color:#1e90ff;">host</span>&gt; → host for which the packet were intended<br /><br />Now that the ARP Poisoning attack is complete we can intercept the traffic with wireshark<br /><br /><strong>Check if the Attack worked(only if we have access on the attacked machine)</strong><br />Find MAC address of our MitM machine <br /><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">ifconfig</span>      <span style="color:#0088ff;font-weight:400">#Linux MitM machine</span></pre></div><br /><a href=""><img src="images/806-1.png" alt="images/806-1.png" /></a><br />After the ARP Poisoning, the gateway(192.168.1.1) MAC address is our MAC address(MitM machine)<br />We have executed these commands on the <span style="color:#ff8700;">target</span> machine(attacked)<br /><div class="codebox"><pre>arp -a        <span style="color:#0088ff;font-weight:400">#Windows target machine</span></pre></div><br />before:<br />    <a href=""><img src="images/806-2.png" alt="images/806-2.png" /></a><br />after:<br />    <a href=""><img src="images/806-3.png" alt="images/806-3.png" /></a><br />    <br /><br /><br /></div>
</body>
</html>
