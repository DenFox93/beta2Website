<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>UI(Web or Mobile DApp) mitigations works? No!</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>UI(Web or Mobile DApp) mitigations works? No!</h1><br/><br /><span style="color:#a5452a;">vulnerable code</span><br /><div class="codebox"><pre>pragma solidity ^0.6.6;<br /><br />contract noAuth {<br />    mapping (address =&gt;uint) balances;<br />    function deposit() public payable{<br />        balances[msg.sender] = balances[msg.sender]+msg.value;<br />    }<br /><br />    function withdraw(uint amount) public payable {     <span style="color:#0088ff;font-weight:400">//&lt;--- PROBLEM</span><br />        msg.sender.transfer(amount);<br />    }<br /><br />    function kill() public {       <span style="color:#0088ff;font-weight:400">//&lt;--- PROBLEM</span><br />        selfdestruct(msg.sender);<br />    }<br />}</pre></div><br />   ◇ <span style="text-decoration:underline;">withdraw function</span>: receives an amount and transfers that amount to the address which calls the function<br />      ▪ It’s not validating the logic that users need to have funds associated with their account to make withdrawals<br />   ◇ <span style="text-decoration:underline;">kill function</span>: calls the built-in solidity selfdestruct function and transfers all of the contract’s funds to the caller of the function(msg.sender). This function will terminate the contracts functionality permanently and liquidate the contracts funds into the account address which ran the kill function. Much like the other two functions the kill function has no authorization, poses a risk to everyone’s funds, and leaves the whole contract vulnerable to termination.<br /><br /><strong><h3>UI(Web or Mobile DApp) mitigations works?</h3></strong><br /><span style="text-decoration:underline;">function kill() public</span> → A developer can mitigates the issues via a Web or Mobile DApp simply by not providing a way for a user to execute the Kill functionality unless that user is the administrator in the DApp? <span style="color:#ff0000;">No!</span><br /><span style="text-decoration:underline;">function withdraw(uint amount) public payable</span> → Can UI manages your funds on the DApp’s business logic? For example, restricting you from withdrawing funds if the address using the DApp does not have an appropriate balance. <span style="color:#ff0000;">No very insecure!</span> <br /><strong>Why UI mitigations does not work?</strong><br />These mitigations does not work because much like an API, we can call the smart contract public functions directly without ever accessing the UI. <br />In the web app world this would be equivalent to Indirect object reference (IDOR). We often see this with video games or web applications where the application from the front end looks good with solid restrictions. But then you start doing some enumeration you realize that all of the functionality comes from an API.<br />If you start poking around that API enumerating endpoints and fuzzing keywords you often will start finding API endpoints with interesting names that do things intended only for developers and administrators. This can lead to sensitive information disclosure or the ability to change and modify sensitive data. This is a very typical occurrence in web applications and Smart Contracts are no different.<br /></div>
</body>
</html>
