<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Scanning and Enumeration</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Scanning and Enumeration</h1><br/>Ports, Protocols, and Services (PPS) help us in identifying the types of applications running on a system and subsequently any potential weaknesses<br />In this phase we will use most of the time <strong>nmap</strong>(Network mapper) that is also available with a GUI called <a href="https://nmap.org/zenmap/">Zenmap</a><br /><br /><strong><h3>These are step to follow during the Scanning Phase</h3></strong><br />1. <strong>Network Sweeping</strong>: identify potential targets and the addresses they use<br />2. <strong>Network Tracing</strong>: determine network topology and draw a map<br />3. <strong>Port Scans</strong>: identifying openings in the targets<br />4. <strong>OS Fingerprinting</strong>: what kinds of target machines we are testing<br />5. <strong>Version Scans</strong>: discern the services and protocols we face<br />6. <strong>Vulnerability Scans</strong>:<br />     <br /><br /><strong><h3>Footprinting and Scanning all in one</h3></strong><br /><span style="color:#a020f0;">0.</span> Scan the LAN<br />    <div class="codebox"><pre>netdiscover -i tap0 -r 10.10.10.0<span style="color:#ff9d00;font-weight:700">/</span>24</pre></div><br />    <a href=""><img src="images/143-1.png" alt="images/143-1.png" /></a><br />    <div class="codebox"><pre>route -n</pre></div><br /><span style="color:#a020f0;">1.</span> <br /><div class="codebox"><pre>nmap -PE -sn -n -T4 &lt;address-range&gt; -oN output.nmap</pre></div><br />For additional information use these:<br /><div class="codebox"><pre>nmap <span style="color:#ff9d00;font-weight:700">-</span>n <span style="color:#ff9d00;font-weight:700">-</span>T4 <span style="color:#ff9d00;font-weight:700">--</span><span style="color:#00117f;font-weight:400">disable-arp-ping</span> <span style="color:#ff9d00;font-weight:700">-</span>PS21,<span style="color:#333333;font-weight:400">22</span>,<span style="color:#333333;font-weight:400">25</span>,<span style="color:#333333;font-weight:400">53</span>,<span style="color:#333333;font-weight:400">80</span>,<span style="color:#333333;font-weight:400">110</span>,<span style="color:#333333;font-weight:400">111</span>,<span style="color:#333333;font-weight:400">135</span>,<span style="color:#333333;font-weight:400">139</span>,<span style="color:#333333;font-weight:400">443</span>,<span style="color:#333333;font-weight:400">445</span> &lt;<span style="color:#00117f;font-weight:400">address-range</span>&gt;   <span style="color:#0088ff;font-weight:400">#TCP SYN &quot;Ping&quot;</span></pre></div><br /><div class="codebox"><pre>nmap <span style="color:#ff9d00;font-weight:700">-</span>n <span style="color:#ff9d00;font-weight:700">-</span>T4 <span style="color:#ff9d00;font-weight:700">--</span><span style="color:#00117f;font-weight:400">disable-arp-ping</span> <span style="color:#ff9d00;font-weight:700">-</span>PA21,<span style="color:#333333;font-weight:400">22</span>,<span style="color:#333333;font-weight:400">25</span>,<span style="color:#333333;font-weight:400">53</span>,<span style="color:#333333;font-weight:400">80</span>,<span style="color:#333333;font-weight:400">110</span>,<span style="color:#333333;font-weight:400">111</span>,<span style="color:#333333;font-weight:400">135</span>,<span style="color:#333333;font-weight:400">139</span>,<span style="color:#333333;font-weight:400">443</span>,<span style="color:#333333;font-weight:400">445</span> &lt;<span style="color:#00117f;font-weight:400">address-range</span>&gt;   <span style="color:#0088ff;font-weight:400">#TCP ACK &quot;Ping&quot;</span></pre></div><br /><div class="codebox"><pre>nmap <span style="color:#ff9d00;font-weight:700">-</span>sS <span style="color:#ff9d00;font-weight:700">-</span>sU <span style="color:#ff9d00;font-weight:700">--</span><span style="color:#00117f;font-weight:400">source-port</span> <span style="color:#333333;font-weight:400">53</span> <span style="color:#ff9d00;font-weight:700">-</span>p53 <span style="color:#ff9d00;font-weight:700">-</span>n &lt;netblock&gt;                                           <span style="color:#0088ff;font-weight:400">#scan for DNS</span></pre></div><br />    <strong>-oN</strong> → Output scan in normal format to the given filename( in this case output.nmap)<br /><span style="color:#a020f0;">2.</span><br /><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">cat</span> output.nmap <span style="color:#ff9d00;font-weight:700">|</span> <span style="color:#ff9d00;font-weight:700">grep</span> <span style="color:#3ad900;font-weight:400">&quot;Nmap scan report for&quot;</span> <span style="color:#ff9d00;font-weight:700">|</span> <span style="color:#ff9d00;font-weight:700">cut</span> -d <span style="color:#3ad900;font-weight:400">&quot; &quot;</span> -f 5 <span style="color:#ff9d00;font-weight:700">|&amp;</span> <span style="color:#ff9d00;font-weight:700">tee</span> ips.txt</pre></div> <br />    with thi command we save only the addresses found in the network  <br />   ◇ <strong>cut -d &quot; &quot; -f 5 </strong> →<strong> -d</strong> split text separated by a space, <strong>-f</strong> then select the fifth element<br />   ◇ <strong>|&amp; tee ips.txt</strong> → save output in the ips.txt file and show it on the terminal<br /><span style="color:#a020f0;">3.</span><br /><div class="codebox"><pre>nmap -sS -n -Pn -T4 -iL ips.txt                <span style="color:#0088ff;font-weight:400">#TCP scan</span></pre></div><br /><div class="codebox"><pre>nmap <span style="color:#ff9d00;font-weight:700">-</span>Pn <span style="color:#ff9d00;font-weight:700">-</span>T4 <span style="color:#ff9d00;font-weight:700">-</span>n <span style="color:#ff9d00;font-weight:700">-</span>sU <span style="color:#ff9d00;font-weight:700">--</span><span style="color:#00117f;font-weight:400">top-ports</span> <span style="color:#333333;font-weight:400">20</span> <span style="color:#ff9d00;font-weight:700">-</span>iL ips.txt   <span style="color:#0088ff;font-weight:400">#UDP scan</span></pre></div><br />or the point 4 that is more complete<br /><span style="color:#a020f0;">4.</span> <br /><div class="codebox"><pre>nmap --osscan-guess -O -sV -sC --traceroute --version-intensity 9 -T4 -p- -n -iL ips.txt</pre></div><br />    take some time, like 10 mins for target<br /><br /><strong><h3>Scanning Tips</h3></strong><br />• Configure scanning tools to use target IP addresses (10.10.20.20) or address ranges, not its domain names (<a href="http://www.example.com)">www.example.com)</a><br />    This because many networks use DNS to perform load balancing and other traffic distribution schemes across multiple targets. <br />    So if we attack a single domain name, <a href="http://www.example.com,">www.example.com,</a> we may actually be going after multiple hosts simultaneously without knowing it. <br />    This could lead to highly erroneous results because the result may contain merged results from multiple machines.<br />   ◇ This is not valid for web applications tests because shared web server host multiple target applications and use an IP address as your target causes your web scanning tools to omit the proper host header to access the right target content.<br /></div>
</body>
</html>
