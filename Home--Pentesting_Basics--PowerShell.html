<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>PowerShell</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>PowerShell</h1><br/>Powershell command from a Windows command prompt(cmd)<br /><div class="codebox"><pre>C<span style="color:#ff9d00;font-weight:700">:\</span>&gt; powershell.exe <span style="color:#ff9d00;font-weight:700">-</span>Command “[command]”</pre></div><br /><br /><strong><h3>Get Version of Powershell</h3></strong><br /><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">Get-Host</span></pre></div><br /><a href=""><img src="images/855-1.png" alt="images/855-1.png" /></a><a href=""><img src="images/855-2.png" alt="images/855-2.png" /></a><br />Powershell 1 → Server 2008<br />Powershell 2 → 7/Server 2008 R2<br />Powershell 3 → 8/Server 2012<br />Powershell 4 → 8.1/Server 2012 R2<br />Powershell 5 → 10<br /><br /><br /><br /><strong><h3>Run Powershell as administrator</h3></strong><br />• Via Run Command Window<br />   1) WinKey+R<br />   2) Type powershell<br />   3) Press Ctrl+Shift+Enter<br />   <a href=""><img src="images/855-3.png" alt="images/855-3.png" /></a><br />• Via command line<br />    <div class="codebox"><pre>powershell Start-Process powershell -Verb runAs</pre></div><br /><br /><strong><h3>Powershell directories</h3></strong><br />• Default: <br />    <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">%</span>appdata<span style="color:#ff9d00;font-weight:700">%\</span>Microsoft<span style="color:#ff9d00;font-weight:700">\</span>Windows<span style="color:#ff9d00;font-weight:700">\Start</span> Menu<span style="color:#ff9d00;font-weight:700">\</span>Programs<span style="color:#ff9d00;font-weight:700">\</span>Windows PowerShell</pre></div>l<br />    <a href=""><img src="images/855-4.png" alt="images/855-4.png" /></a><br />• v1.0<br />   To know the current environment architecture <br />    <div class="codebox"><pre>[Environment]<span style="color:#ff9d00;font-weight:700">::</span>Is64BitProcess</pre></div><br />    <a href=""><img src="images/855-5.png" alt="images/855-5.png" /></a><br />   ◇ 64 bit system<br />       <div class="codebox"><pre>C<span style="color:#ff9d00;font-weight:700">:\</span>Windows<span style="color:#ff9d00;font-weight:700">\</span>System32<span style="color:#ff9d00;font-weight:700">\</span>WindowsPowerShell<span style="color:#ff9d00;font-weight:700">\</span>v1.<span style="color:#333333;font-weight:400">0</span></pre></div><br />       <a href=""><img src="images/855-6.png" alt="images/855-6.png" /></a><br />   ◇ 32 bit system<br />       <div class="codebox"><pre>C<span style="color:#ff9d00;font-weight:700">:\</span>windows<span style="color:#ff9d00;font-weight:700">\</span>SysWOW64<span style="color:#ff9d00;font-weight:700">\</span>WindowsPowerShell<span style="color:#ff9d00;font-weight:700">\</span>v1.<span style="color:#333333;font-weight:400">0</span></pre></div><br /><br /><br />List of useful Powershell commands <br /><a href="https://gist.github.com/jivoi/c354eaaf3019352ce32522f916c03d70">https://gist.github.com/jivoi/c354eaaf3019352ce32522f916c03d70</a><br /><br />How Powershell is used during attacks:<br /><a href="https://docs.broadcom.com/doc/increased-use-of-powershell-in-attacks-16-en">https://docs.broadcom.com/doc/increased-use-of-powershell-in-attacks-16-en</a><br /></div>
</body>
</html>
