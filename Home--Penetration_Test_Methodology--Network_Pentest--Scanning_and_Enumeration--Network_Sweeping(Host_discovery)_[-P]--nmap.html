<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>nmap</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>nmap</h1><br/><br />Syntax of nmap:<br /><div class="codebox"><pre>nmap [Scan Type<span style="color:#ff9d00;font-weight:700">(</span>s<span style="color:#ff9d00;font-weight:700">)</span>] [Options] <span style="color:#ff9d00;font-weight:700">{</span>target<span style="color:#ff9d00;font-weight:700">(</span>s<span style="color:#ff9d00;font-weight:700">)}</span></pre></div><br /><br />TARGETS:<br />• DNS names<br />    <div class="codebox"><pre>nmap &lt;scan type&gt; target1.domain1.com target2.domain2.com</pre></div><br />• IP addresses<br />    <div class="codebox"><pre>nmap &lt;scan type&gt; 192.168.1.23 172.100.34.87 10.10.2.1 10.10.2.7</pre></div><br />• CIDR notation<br />    <div class="codebox"><pre>nmap &lt;scan type&gt; 10.0.0.0<span style="color:#ff9d00;font-weight:700">/</span>8 192.168.1.0<span style="color:#ff9d00;font-weight:700">/</span>24 200.200.1.0<span style="color:#ff9d00;font-weight:700">/</span>16</pre></div><br />• wildcards<br />    <div class="codebox"><pre>nmap &lt;scan type&gt; 192.168.1.* <span style="color:#0088ff;font-weight:400">#astersc converted to a range of 0-255</span></pre></div><br />    <div class="codebox"><pre>nmap &lt;scan type&gt; 192.168.*.3 <span style="color:#0088ff;font-weight:400">#astersc converted to a range of 0-255</span></pre></div><br />• ranges<br />    <div class="codebox"><pre>nmap &lt;scan type&gt; 10.13.22.0-32 10.11.83.200-255</pre></div><br />• octets lists<br />    <div class="codebox"><pre>nmap &lt;scan type&gt; 192.168.1.3,5,57 <span style="color:#0088ff;font-weight:400">#hosts with IP ending with 3,5 and 57</span></pre></div><br />    <div class="codebox"><pre>nmap &lt;scan type&gt; 192.168,169.1,5.3,5,57 </pre></div><br />• input file<br />    <div class="codebox"><pre>nmap &lt;scan type&gt; -iL hosts.txt</pre></div><br /><br /><br /><br /><strong>PORTS:</strong><br />By default when we chose a target nmap scan the <strong>most 1000 common ports</strong><br />If we want to scan custom ports we have to specify <strong>-p</strong> option<br />• ports comma separated list<br />    <div class="codebox"><pre>nmap –p 22,24,53,80,111,135,139,441,443,445,711,1025,1026,1029 -sS &lt;target&gt;</pre></div><br />    <div class="codebox"><pre>nmap –p <span style="color:#333333;font-weight:400">22</span>,<span style="color:#333333;font-weight:400">24</span>,<span style="color:#333333;font-weight:400">53</span>,<span style="color:#333333;font-weight:400">80</span>,<span style="color:#333333;font-weight:400">111</span>,<span style="color:#333333;font-weight:400">135</span>,<span style="color:#333333;font-weight:400">139</span>,<span style="color:#333333;font-weight:400">441</span>,<span style="color:#333333;font-weight:400">443</span>,<span style="color:#333333;font-weight:400">445</span>,<span style="color:#333333;font-weight:400">711</span>,<span style="color:#333333;font-weight:400">1025</span>,<span style="color:#333333;font-weight:400">1026</span>,<span style="color:#333333;font-weight:400">1029</span> <span style="color:#ff9d00;font-weight:700">-</span>sT &lt;target&gt;</pre></div><br />• port interval<br />    <div class="codebox"><pre>nmap –p 200-700 -sS &lt;target&gt;</pre></div><br />    <div class="codebox"><pre>nmap –p 200-700 -sT &lt;target&gt;</pre></div><br />• all ports(from 1 through 65535)<br />    <div class="codebox"><pre>nmap –p- -sS &lt;target&gt;</pre></div><br /><br /><strong><h3>Local Area Network</h3></strong><br />If we run a scan in a local network, nmap perform few more operations before performing the scan: ARP ping scan, DNS resolution of the target. nmap does these operations because is the faster way to discover live host in a local area network <br /><strong>--disable-arp-ping</strong> or <strong>--send-ip</strong> → The only way to perform a ICMP (ping sweep) with nmap is use these option, that the the inverse of -PR. <br />    -PR is the default scan type when scanning ethernet hosts that Nmap detects are on a local ethernet network.<br /><strong>-n</strong> → Never do DNS resolution. This is a HOST DISCOVERY option but we can use it with all SCAN TECHNIQUES<br />     <span style="text-decoration:underline;">When resolving IP addresses to hostnames is not required</span> we can use -n to decrease our scan times, and also help us stay a bit more “under the radar”, as reverse DNS lookups can generate more noise than necessary<br />     <br /><strong><h3>Output options</h3></strong><br />Instead of specify the file we ca use “-” and the correspondent output will be displayed directlyon the shell<br />• <strong>-oN &lt;file.nmap&gt;</strong> → Normal output: The normal human-readable output typically displayed on the screen will be stored into a file<br />• <strong>-oX &lt;file.xml&gt;</strong> → XML output: Creates an XML output that can be easily parsed by various tools.<br />• <strong>-oG &lt;file.gnmap&gt;</strong>→ Grepable output: Although deprecated (replaced by XML), it is still popular. This output lists each host on one line and can be easily used to search and parse with Unix tools such as grep, awl, cut, etc.<br />• <strong>-oA</strong> &lt;file.nmap&gt;: Output in normal, XML, and grepable formats at once.<br /><span style="color:#a5452a;">example:</span><br /><div class="codebox"><pre>nmap <span style="color:#ff9d00;font-weight:700">-</span>n <span style="color:#ff9d00;font-weight:700">-</span>sT <span style="color:#333333;font-weight:400">192.168</span>.<span style="color:#333333;font-weight:400">1.97</span> <span style="color:#ff9d00;font-weight:700">-</span>oA <span style="color:#ff9d00;font-weight:700">/</span>tmp<span style="color:#ff9d00;font-weight:700">/</span><span style="color:#333333;font-weight:400">192.168</span>.<span style="color:#333333;font-weight:400">1</span>.97_connect_scan</pre></div><br /><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">ls</span> <span style="color:#ff9d00;font-weight:700">/</span>tmp<span style="color:#ff9d00;font-weight:700">/</span><span style="color:#333333;font-weight:400">192.168</span>.<span style="color:#333333;font-weight:400">1</span>.97_connect_scan<span style="color:#ff9d00;font-weight:700">*</span></pre></div><br />    <a href=""><img src="images/416-1.png" alt="images/416-1.png" /></a><br /><div class="codebox"><pre>gedit <span style="color:#ff9d00;font-weight:700">/</span>tmp<span style="color:#ff9d00;font-weight:700">/</span><span style="color:#333333;font-weight:400">192.168</span>.<span style="color:#333333;font-weight:400">1</span>.97_connect_scan.gnmap</pre></div><br /><br /><br /><strong><h3>Use DNS of the internal Network</h3></strong><br />Find DNS into the network<br /><div class="codebox"><pre>nmap -p 53 -sV -sS [InternalNetwork]</pre></div><br /><strong>--dns-servers</strong><br />By default, Nmap determines your DNS servers (for rDNS resolution) from your resolv.conf file (Unix) or the Registry (Win32). Alternatively, you may use this option to specify alternate servers.<br />If we find DNS name server into the network we could use them to try reverse DNS (determine the domain name associated with an IP address). <br /><div class="codebox"><pre>nmap -sS -sV --dns-servers [IpDNS] [addressRange]</pre></div><br /></div>
</body>
</html>
