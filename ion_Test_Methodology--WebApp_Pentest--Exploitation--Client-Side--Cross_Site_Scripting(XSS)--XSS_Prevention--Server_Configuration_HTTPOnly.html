<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Server Configuration: HTTPOnly</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Server Configuration: HTTPOnly</h1><br/><br /><strong><h3>Prevention</h3></strong><br />In order to prevent cookie stealing through XSS, we need to set the <strong>HttpOnly</strong> flag. That tells the browser to expose the cookie only through HTTP (and HTTPS) requests (no JavaScript, Flash, Java)<br /><span style="text-decoration:underline;">Attack Scenario</span> seen in <a href="Home--Penetration_Test_Methodology--WebApp_Pentest--Exploitation--Server-side--Session_Tokens_stealing--Session_Abuse.html">XSS → How Discovery XSS → Session Abuse</a><br /><br />Before any session-related operation is performed, you should run the following instruction:<br />• PHP 5.2.0 and later<br />    <div class="codebox"><pre>&lt;?php<br />    ini_set(&quot;session.cookie_httponly&quot;, 1);<br />?&gt;</pre></div><br />    When session_start() is invoked, if a valid session does not already exist, a new one will be created.<br />• Tomcat (a Java Servlet and JSP server) version 6.0.19 and later<br />    <div class="codebox"><pre>&lt;Context&gt;<br />    &lt;Manager useHttpOnly=&quot;true&quot; /&gt;<br />&lt;/Context&gt;</pre></div><br />• javaee6.0<br />   ◇ setHttpOnly() →  This method is used to mark or unmark the cookie HttpOnly<br />   ◇ isHttpOnly() →  This method is used to identify for whether the cookie has been noticed for HttpOnly<br />    <div class="codebox"><pre>Cookie.setHttpOnly(true);<br />boolean bol = cookie.isHttpOnly();<br />out.println(&quot;&lt;br&gt;Cookie is Marked as HttpOnly = &quot; + bol);</pre></div><br />• .NET<br />    By default, starting from .NET 2.0, the framework sets the HttpOnly attribute for both SessionIDs and Forms Authentication cookie<br /><br /><br /><br /><br /><br />Bibliography:<br />• <a href="https://owasp.org/www-community/HttpOnly">https://owasp.org/www-community/HttpOnly</a><br />• <a href="https://www.programmersought.com/article/42067480022/">https://www.programmersought.com/article/42067480022/</a><br />• java ee: <a href="https://www.roseindia.net/java/javaee6/servlet3CookieExample.shtml">https://www.roseindia.net/java/javaee6/servlet3CookieExample.shtml</a><br />• <a href="https://hub.packtpub.com/blocking-common-attacks-using-modsecurity-25-part-2/">https://hub.packtpub.com/blocking-common-attacks-using-modsecurity-25-part-2/</a></div>
</body>
</html>
