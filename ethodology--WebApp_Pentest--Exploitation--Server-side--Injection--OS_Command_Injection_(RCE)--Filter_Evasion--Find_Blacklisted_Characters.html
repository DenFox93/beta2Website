<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Find Blacklisted Characters</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Find Blacklisted Characters</h1><br/><br />A web application may have a list of blacklisted characters, and if the command contains them, it would deny the request<br /><span style="color:#865e3c;">example PHP code:</span><br />	If any character in the string we sent matches a character in the blacklist, our request is denied. Before we start our attempts at bypassing the filter, we should try to identify which character caused the denied request.<br />	<div class="codebox"><pre>$blacklist = [&#39;&amp;&#39;, &#39;|&#39;, &#39;;&#39;, ...SNIP...];<br />foreach ($blacklist as $character) {<br />    if (strpos($_POST[&#39;ip&#39;], $character) !== false) {<br />        echo &quot;Invalid input&quot;;<br />    }<br />}</pre></div><br /><br /><strong>List of Injections Characters to try</strong><br /><div class="codebox"><pre>;<br />%3b<br />%0A<br />&amp;<br />%26<br />|<br />%7c<br />&amp;&amp;<br />%26%26<br />||<br />%7c%7c<br />``<br />%60%60<br />$()<br />%24%28%29</pre></div><br />	<a href=""><img src="images/2414-1.png" alt="images/2414-1.png" /></a><br /><br /><br /><strong>Injection Characters/Operators that could be NOT Blacklisted</strong><br />The <span style="text-decoration:underline;">new-line character is usually not blacklisted</span>, as it may be needed in the payload itself   <br />	<a href=""><img src="images/2414-2.png" alt="images/2414-2.png" /></a><br />    In a CURL command to express the \n we need to to use <strong>\x0a</strong><br />    <div class="codebox"><pre>--data-binary $<span style="color:#3ad900;font-weight:400">&#39;ip=127.0.0.1\x0awhoami&#39;</span> </pre></div><br />    for more see the <a href="-Penetration_Test_Methodology--WebApp_Pentest--Exploitation--Server-side--Injection--OS_Command_Injection_(RCE)--Detection--New_Line_(-n).html">Detectionâ†’ New Line (\n)</a> chapter !<br />    </div>
</body>
</html>
