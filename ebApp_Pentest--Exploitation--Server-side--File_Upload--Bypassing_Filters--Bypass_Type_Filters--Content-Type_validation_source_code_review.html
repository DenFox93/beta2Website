<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Content-Type validation: source code review</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Content-Type validation: source code review</h1><br/><br /><strong><h3>Source Code Review Content-Type validation</h3></strong><br /><strong>php</strong><br /><div class="codebox"><pre>$type = $_FILES[&#39;uploadFile&#39;][&#39;type&#39;];<br /><br />if (!in_array($type, array(&#39;image/jpg&#39;, &#39;image/jpeg&#39;, &#39;image/png&#39;, &#39;image/gif&#39;))) {<br />    echo &quot;Only images are allowed&quot;;<br />    die();<br />}</pre></div><br />The code sets the ($type) variable from the uploaded file&#39;s Content-Type header in the request</div>
</body>
</html>
