<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Input Sanitization</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Input Sanitization</h1><br/><strong><h3>Input Sanitization</h3></strong><br />Injection can be avoided by sanitizing any user input, rendering injected queries useless. <br /><span style="color:#a52a2a;">PHP: vulnerable authentication code</span><br /><div class="codebox"><pre>&lt;SNIP&gt;<br />  $username = $_POST[&#39;username&#39;];<br />  $password = $_POST[&#39;password&#39;];<br /><br />  $query = &quot;SELECT * FROM logins WHERE username=&#39;&quot;. $username. &quot;&#39; AND password = &#39;&quot; . $password . &quot;&#39;;&quot; ;<br />  echo &quot;Executing query: &quot; . $query . &quot;&lt;br /&gt;&lt;br /&gt;&quot;;<br /><br />  if (!mysqli_query($conn ,$query))<br />  {<br />          die(&#39;Error: &#39; . mysqli_error($conn));<br />  }<br /><br />  $result = mysqli_query($conn, $query);<br />  $row = mysqli_fetch_array($result);<br />&lt;SNIP&gt;</pre></div><code><br /></code>    This PHP script is vulnerable because it takes in the &quot;username&quot; and &quot;password&quot; from the POST request and passes it to the query directly. <br /><strong><span style="text-decoration:underline;">How to Prevent</span></strong><br />Libraries provide multiple functions to achieve this<br />•  PHP <a href="https://www.php.net/manual/en/mysqli.real-escape-string.php">mysqli_real_escape_string()</a> → This function escapes characters such as &#39; and &quot; for querying MySQL database , so they don&#39;t hold any special meaning.<br />    <div class="codebox"><pre>$username = mysqli_real_escape_string($conn, $_POST[&#39;username&#39;]);<br />$password = mysqli_real_escape_string($conn, $_POST[&#39;password&#39;]);<br /><br />$query = &quot;SELECT * FROM logins WHERE username=&#39;&quot;. $username. &quot;&#39; AND password = &#39;&quot; . $password . &quot;&#39;;&quot; ;<br />echo &quot;Executing query: &quot; . $query . &quot;&lt;br /&gt;&lt;br /&gt;&quot;;</pre></div><br />    <a href=""><img src="images/2520-1.png" alt="images/2520-1.png" /></a><br />• PHP <a href="https://www.php.net/manual/en/function.pg-escape-string.php">pg_escape_string()</a> → This function escapes a string for querying the PostgreSQL database. It returns an escaped string in the PostgreSQL format without quotes<br /></div>
</body>
</html>
