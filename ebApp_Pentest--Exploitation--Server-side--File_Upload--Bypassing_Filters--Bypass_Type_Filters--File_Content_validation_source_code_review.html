<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>File Content validation: source code review</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>File Content validation: source code review</h1><br/><br /><br /><strong><h3>Source Code Review File Content Validation</h3></strong><br /><br /><strong>PHP</strong><br /><div class="codebox"><pre>$type = mime_content_type($_FILES[&#39;uploadFile&#39;][&#39;tmp_name&#39;]);<br /><br />if (!in_array($type, array(&#39;image/jpg&#39;, &#39;image/jpeg&#39;, &#39;image/png&#39;, &#39;image/gif&#39;))) {<br />    echo &quot;Only images are allowed&quot;;<br />    die();<br />}</pre></div><br /><br /><br /><br /> MIME types are similar to the ones found in “<a href="ebApp_Pentest--Exploitation--Server-side--File_Upload--Bypassing_Filters--Bypass_Type_Filters--Content-Type_validation_source_code_review.html">Content-Type validation: source code review</a>”, but their source is different, as PHP uses the mime_content_type() function to get a file&#39;s MIME type. </div>
</body>
</html>
