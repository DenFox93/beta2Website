<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>SSTI Jinja2 Template Engine</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>SSTI Jinja2 Template Engine</h1><br/><br /><br /><a href=""><img src="images/2580-1.png" alt="images/2580-1.png" /></a><br /><br /><br />1. Send some test characters<br />    <a href=""><img src="images/2580-2.png" alt="images/2580-2.png" /></a><br />    User input is submitted via the <code>cmd</code> parameter through a GET request.<br />     <br />2. Test some general payloads<br />    Let&#39;s submit mathematical expressions in curly brackets in the input field<br />    <div class="codebox"><pre>{7*7}<br />${7*7}<br />{{7*7}}</pre></div><br />    <a href=""><img src="images/2580-3.png" alt="images/2580-3.png" /></a><br />    <a href=""><img src="images/2580-4.png" alt="images/2580-4.png" /></a><br />    <a href=""><img src="images/2580-5.png" alt="images/2580-5.png" /></a><br />    Found it! It looks like we may be dealing with an SSTI vulnerability!<br />    <br />3. Let&#39;s use <a href="https://portswigger.net/research/server-side-template-injection">PortsSwigger</a>&#39;s diagram in the SSTI Identification<br />    <a href=""><img src="images/2580-6.png" alt="images/2580-6.png" /></a><br />    We already know that the {{7*7}} expression was evaluated successfully. The next expression the diagram suggests trying is {{7*&#39;7&#39;}}. Let us try it and see how the application responds.<br /><br />4.  The diagram suggest to try: {{7*&#39;7&#39;}}<br />    <a href=""><img src="images/2580-7.png" alt="images/2580-7.png" /></a><br />    The application successfully evaluated this expression as well. According to PortSwigger&#39;s diagram, we are dealing with either a Jinja2 or a Twig template engine<br /><br />5. Since the payload {{7*&#39;7&#39;}} is been evaluated as 7777777 the Template Engine is Jinja2 but let&#39;s do another confirmation<br />    <div class="codebox"><pre>{{config.items()}}</pre></div><br />    <a href=""><img src="images/2580-8.png" alt="images/2580-8.png" /></a> <br /><br />6. RCE with tplmap<br />    <a href=""><img src="images/2580-9.png" alt="images/2580-9.png" /></a></div>
</body>
</html>
