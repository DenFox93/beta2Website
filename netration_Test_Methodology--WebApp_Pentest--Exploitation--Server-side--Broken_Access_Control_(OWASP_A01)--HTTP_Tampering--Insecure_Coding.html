<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Insecure Coding</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Insecure Coding</h1><br/><strong><h3>Insecure Coding</h3></strong><br /><br />Insecure Coding is commonly found in security filters that detect malicious requests<br />example: if a security filter was being used to detect injection vulnerabilities and only checked for injections in POST parameters (e.g. $_POST[&#39;parameter&#39;]), it may be possible to bypass it by simply changing the request method to GET.<br /><br />Insecure Coding Vulnerabilities can be found in input Fields<br />	<a href=""><img src="images/2658-1.png" alt="images/2658-1.png" /></a><br /><br />1. Identify<br />	when we try to input special characers in an input field, the web application uses certain filters on the back-end to identify injection attempts and then blocks any malicious requests<br />	<a href=""><img src="images/2658-2.png" alt="images/2658-2.png" /></a><br /><br />2. Exploit<br />	As base request we have this one<br />   <a href=""><img src="images/2658-3.png" alt="images/2658-3.png" /></a><br />	<a href=""><img src="images/2658-4.png" alt="images/2658-4.png" /></a><br />	Try to change the Verb with one of those:<br />	<div class="codebox"><pre>HEAD<br />POST<br />PUT<br />DELETE<br />OPTIONS<br />PATCH<br /></pre></div><br />	<br />	<a href=""><img src="images/2658-5.png" alt="images/2658-5.png" /></a><br />	<a href=""><img src="images/2658-6.png" alt="images/2658-6.png" /></a><br />	We can see that the operation sucseed <br />	<br />	<br />	<br />	<br /><br /><strong><h3>Insecure Code</h3></strong><br />The insecure code here reside in the line 2 where the pregmatch is done only on the GET parameter and not on the others<br /><div class="codebox"><pre>if (isset($_REQUEST[&#39;filename&#39;])) {<br />    if (!preg_match(&#39;/[^A-Za-z0-9. _-]/&#39;, $_GET[&#39;filename&#39;])) {<br />        system(&quot;touch &quot; . $_REQUEST[&#39;filename&#39;]);<br />        header(&quot;Refresh:0; url=index.php&quot;);<br />    } else {<br />        echo &quot;Malicious Request Denied!&quot;;<br />    }<br />}</pre></div></div>
</body>
</html>
