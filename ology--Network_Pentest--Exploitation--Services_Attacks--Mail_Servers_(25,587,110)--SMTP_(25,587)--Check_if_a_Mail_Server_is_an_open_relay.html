<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Check if a Mail Server is an open relay</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Check if a Mail Server is an open relay</h1><br/><br /><br />An SMTP server that works as an open relay, is a email server that does not verify if the user is authorised to send email from the specified email address. Therefore, users would be able to send email originating from any third-party email address that they want.<br />Test: <br />   ◇ Internal Source Address → External Destination Address<br />   ◇ External Source Address →  External Destination Address<br />   ◇ External Source Address →  Internal Destination Address<br />   ◇ Internal Source Address →  Internal Destination Address<br /><br /><br /><div class="codebox"><pre>dig -t mx &lt;domain&gt; @1.1.1.1               <span style="color:#0088ff;font-weight:400">#mail servers of google.com</span><br />nmap -p25  &lt;mail-server&gt;                  <span style="color:#0088ff;font-weight:400">#check if the smatp port is open</span><br />nc &lt;mail-server&gt; 25                       <span style="color:#0088ff;font-weight:400">#connect with netcat</span><br />    HELO &lt;<span style="color:#ff9d00;font-weight:700">hostname</span>&gt;<br />    MAIL FROM<span style="color:#ff9d00;font-weight:700">:</span> example1@domain1.com      <span style="color:#0088ff;font-weight:400">#source address</span><br />    RCPT TO<span style="color:#ff9d00;font-weight:700">:</span> example2@domain2.com        <span style="color:#0088ff;font-weight:400">#destination address</span></pre></div><br />    <a href=""><img src="images/1049-1.png" alt="images/1049-1.png" /></a><br />    <a href=""><img src="images/1049-2.png" alt="images/1049-2.png" /></a><br /><br />Several methods exist that can be used to abuse SMTP to enumerate valid usernames and addresses; namely VRFY, EXPN, and RCPT TO:<br /><a href="https://www.nccgroup.com/uk/about-us/newsroom-and-events/blogs/2015/june/username-enumeration-techniques-and-their-value/">https://www.nccgroup.com/uk/about-us/newsroom-and-events/blogs/2015/june/username-enumeration-techniques-and-their-value/</a><br /><br /><strong>Alternative: test using nmap script</strong><br />From my test, manually testing with netcat give more precise results<br /><a href="https://nmap.org/nsedoc/scripts/smtp-open-relay.html">https://nmap.org/nsedoc/scripts/smtp-open-relay.html</a><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div>
</body>
</html>
