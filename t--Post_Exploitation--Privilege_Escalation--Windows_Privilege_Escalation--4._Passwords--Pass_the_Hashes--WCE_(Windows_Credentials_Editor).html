<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>WCE (Windows Credentials Editor)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>WCE (Windows Credentials Editor)</h1><br/><strong>Prerequisite:</strong><br />• password hash of an Administrator Account<br />• WCE supports Windows XP, 2003, Vista, 7, 2008 and Windows 8<br /><br /><strong><h3>WCE (Windows Credentials Editor)</h3></strong><br />Site: <a href="https://www.ampliasecurity.com/research/windows-credentials-editor/">https://www.ampliasecurity.com/research/windows-credentials-editor/</a><br /><br />Hernán Ochoa developed a Windows-based pass-the-hash attack tool called the Windows Credentials Editor(WCE).<br />Since it is a windows binary, you will have to upload it on the remote machine and then run it from the meterpreter session<br /><br />The WCE tool is an evolutionary advancement over Ochoa&#39;s earlier tool, known as the Pass-the-Hash Toolkit (PTH). <br />In in addition to grabbing and injecting LANMAN and NT hashes, recent versions of the WCE tool can also inject Kerberos tickets into memory so that an attacker can use them to authenticate to a target in a pass-the-ticket attack, directly analogous to a pass-the-hash attack.<br /><br />OPTIONS:<br /><strong>-l</strong> → list hashes available to the current session<br />-s → inject the hashes so that they can be used<br />-d →  remove injected hashes<br />-K →  list Microsoft Kerberos tokens<br />-k →  to inject the Kerberos tokens<br /><br />and upload it with meterpreter:<br /><div class="codebox"><pre>meterpreter &gt; upload <span style="color:#ff9d00;font-weight:700">/</span>home<span style="color:#ff9d00;font-weight:700">/</span>kali<span style="color:#ff9d00;font-weight:700">/</span>Downloads<span style="color:#ff9d00;font-weight:700">/</span>wce.exe <span style="color:#ff9d00;font-weight:700">.</span>    <span style="color:#0088ff;font-weight:400">#the dot(.) mean that the file will be uploaded in</span><br />                                                       <span style="color:#0088ff;font-weight:400">#the actual folder of the target machine</span></pre></div><br /><a href=""><img src="images/861-1.png" alt="images/861-1.png" /></a><br /><br />now we can execute the file wce:<br /><div class="codebox"><pre>meterpreter &gt; execute -i -f wce.exe -a -h</pre></div><br />    execute <strong>-i</strong>  → Interact with the process after creating it<br />    execute <strong>-f &lt;executable&gt;</strong> → The executable command to run<br />    execute -f &lt;executable&gt; <strong>-a &lt;argument&gt;</strong> → The arguments to pass to the executable<br />    wce.exe <strong>-h</strong> → help manual<br />    <a href=""><img src="images/861-2.png" alt="images/861-2.png" /></a></div>
</body>
</html>
