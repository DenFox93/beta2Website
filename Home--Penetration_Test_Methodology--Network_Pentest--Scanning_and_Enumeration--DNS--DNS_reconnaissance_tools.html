<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>DNS reconnaissance tools</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>DNS reconnaissance tools</h1><br/><br /><strong>Useful DNS Reconnaissance Tools</strong><br />• <strong>nslookup</strong><br />    Most of the time we can start interrogating DNS via nslookup and then move to dig which is far more powerful<br />    <div class="codebox"><pre>root@kali<span style="color:#ff9d00;font-weight:700">:/</span># nslookup &lt;domain&gt;</pre></div><br />   ◇ PROS<br />      ▪ Near-universal availability, including UNIX, Linux, macOS, and Windows<br />   ◇ Cons:<br />      ▪ It has limited functionality compared to dig<br />• <strong>dig</strong><br />    <div class="codebox"><pre>root@kali<span style="color:#ff9d00;font-weight:700">:/</span># dig @&lt;nameserver&gt; &lt;domain&gt; -t any         <span style="color:#0088ff;font-weight:400">#Look up all domain records (SOA, A, NS, MX, ..)</span><br />root@kali<span style="color:#ff9d00;font-weight:700">:/</span># dig @&lt;nameserver&gt; &lt;domain&gt; -t mx          <span style="color:#0088ff;font-weight:400">#Look up MX records</span><br />root@kali<span style="color:#ff9d00;font-weight:700">:/</span># dig @&lt;nameserver&gt; &lt;domain&gt; -t axfr        <span style="color:#0088ff;font-weight:400">#attempt zone transfer</span><br />root@kali<span style="color:#ff9d00;font-weight:700">:/</span># dig @&lt;nameserver&gt; version.bind chaos txt  <span style="color:#0088ff;font-weight:400">#Query the nameserver&#39;s version of BIND</span></pre></div><br />   ◇ PROS:<br />      ▪ Available natively on macOS and most UNIX/Linux distros<br />   ◇ CONS:<br />      ▪ It is not installed natively on Windows<br />• <strong>Nmap NSE Scripts</strong><br />    <div class="codebox"><pre>root@kali<span style="color:#ff9d00;font-weight:700">:/</span># <span style="color:#ff9d00;font-weight:700">ls</span> <span style="color:#ff9d00;font-weight:700">/</span>usr<span style="color:#ff9d00;font-weight:700">/</span>share<span style="color:#ff9d00;font-weight:700">/</span>nmap<span style="color:#ff9d00;font-weight:700">/</span>scripts<span style="color:#ff9d00;font-weight:700">/</span>dns*</pre></div><br />    <a href=""><img src="images/1475-1.png" alt="images/1475-1.png" /></a><br /><br />• <strong>DNSRecon</strong><br />    <div class="codebox"><pre>root@kali<span style="color:#ff9d00;font-weight:700">:/</span># dnsrecon -d &lt;domain&gt;</pre></div><br />   ◇ Check all NS Records for Zone Transfers.<br />   ◇ Enumerate General DNS Records for a given Domain (MX, SOA, NS, A, AAAA, SPF and TXT).<br />   ◇ Perform common SRV Record Enumeration.<br />   ◇ Top Level Domain (TLD) Expansion.<br />   ◇ Check for Wildcard Resolution.<br />   ◇ Brute Force subdomain and host A and AAAA records, given a domain and a wordlist.<br />   ◇ Perform a PTR Record lookup for a given IP Range or CIDR.<br />   ◇ Check a DNS Server Cached records for A, AAAA and CNAME Records provided a list of host records in a text file to check.<br />   ◇ Enumerate Common mDNS records in the Local Network.<br />   ◇ Enumerate Hosts and Subdomains using Google. 1<br /><br />• <strong>Metasploit</strong><br />    DNS information-gathering auxiliary modules<br />   ◇ post/multi/gather/dns_bruteforce → Performs a brute force dictionary DNS scan<br />   ◇ post/multi/gather/dns_cache_scraper → Queries DNS cache for previously resolved names<br />   ◇ post/multi/gather/dns_info → Gathers general DNS information<br />   ◇ post/multi/gather/dns_reverse_lookup → Performs a reverse DNS (PTR) scan of a netblock, replicate DNSRecon&#39;s reverse brute force with same wordlist<br />   ◇ post/multi/gather/dns_srv_enum → Enumerates SRV (Server) records<br /></div>
</body>
</html>
