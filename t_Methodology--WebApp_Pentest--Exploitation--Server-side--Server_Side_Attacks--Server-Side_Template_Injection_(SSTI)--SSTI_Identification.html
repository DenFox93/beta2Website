<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>SSTI Identification</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>SSTI Identification</h1><br/><br />• We can detect SSTI vulnerabilities by injecting different tags in the inputs we control to see if they are evaluated in the response.<br />• Blind SSTI: Sometimes the injected data is not reflected in the response we receive. Sometimes it is just evaluated on different pages (blind)<br /><br /><strong>Ways to detect injections</strong><br />   ◇ supply mathematical expressions in curly brackets (easier)<br />       <div class="codebox"><pre>{7*7}<br />${7*7}<br />#{7*7}<br />%{7*7}<br />{{7*7}}</pre></div><br />       We will look for &quot;49&quot; in the response when injecting these payloads to identify that server-side evaluation occurred.<br />   ◇ fuzz the template by injecting combinations of special characters used in template expressions. <br />       <div class="codebox"><pre>${{&lt;%[%&#39;&quot;}}%\</pre></div><br />       If an exception is caused, this means that we have some control over what the server interprets in terms of template expressions.<br /><br /><strong>Tools</strong><br />• <a href="https://github.com/epinna/tplmap">Tplmap</a><br />• <a href="https://github.com/PortSwigger/j2ee-scan">J2EE Scan</a> (Burp Pro)<br />• create a payload list to use with Burp Intruder or ZAP<br />   ◇ <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/76993f86a64274629cf373cc67cd2ec4ec0232bf/Server%20Side%20Template%20Injection">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/76993f86a64274629cf373cc67cd2ec4ec0232bf/Server%20Side%20Template%20Injection</a><br />   ◇ <a href="https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/template-engines-special-vars.txt">https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/template-engines-special-vars.txt</a><br /><br /><strong>To Identify an SSTI</strong><br />To identify if we are dealing with an SSTI vulnerability and also to identify the underlying template engine we can:<br />• use the diagram below from <a href="https://portswigger.net/research/server-side-template-injection">PortsSwigger</a> <br /><a href=""><img src="images/2575-1.png" alt="images/2575-1.png" /></a><br />• Check verbose errors for technology names. Sometimes just copying the error in Google search can provide us with a straight answer regarding the underlying technology used<br />• Check for extensions.<br />   ◇ .jsp extensions → are associated with Java. When dealing with Java, we may be facing an expression language/OGNL injection vulnerability instead of traditional SSTI<br />• Send expressions with unclosed curly brackets to see if verbose errors are generated. Do not try this approach on production systems, as you may crash the webserver.<br /><br /><br /><br />List of Specific payload for Template Engines:<br />•  PayloadsAllTheThings: <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#jinja2">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#jinja2</a><br />•  HackTricks: <a href="https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection">https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection</a><br />•  SecLists: <a href="https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/template-engines-special-vars.txt">https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/template-engines-special-vars.txt</a><br /><br /><br /><br /><br /><br /><br /></div>
</body>
</html>
