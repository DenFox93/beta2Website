<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>IDOR</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>IDOR</h1><br/><strong><h3>What are insecure direct object references (IDOR)?</h3></strong><br /><strong>Insecure direct object references (IDOR)</strong> are a type of <span style="text-decoration:underline;">access control</span> vulnerability that arises when a web application exposes a direct reference to an object, like a file or a database resource, which the end-user can directly control to obtain access to other similar objects.<br />If any user can access any resource due to the lack of a solid access control system, the system is considered to be vulnerable.<br /><br /><strong>Direct reference to database objects</strong><br /><span style="text-decoration:underline;">example:</span> if users request access to a file they recently uploaded, they may get a link to it such as (download.php?file_id=123). So, as the link directly references the file with (file_id=123), what would happen if we tried to access another file (which may not belong to us) with (download.php?file_id=124). This lead to an <span style="text-decoration:underline;">horizontal privilege escalation</span><br /><br /><br /><strong>Inject ID parameters</strong><br />Anytime you see a request and the postdata is JSON, <code>{&quot;example&quot;:&quot;example&quot;}</code>, try simply injecting a new parameter name, <code>{&quot;example&quot;:&quot;example&quot;,</code><code><span style="color:#e20000;">&quot;id&quot;:&quot;1&quot;</span></code><code>}</code>. When the JSON is parsed server-side you literally have no idea how it may handle it, so why not try? This not only applies to JSON requests but all requests, but I typically have a higher success rate when it&#39;s a JSON payload. (look for PUT requests!)<br /><br /><br /><strong>Direct reference to static files</strong><br />IDOR vulnerabilities often arise when sensitive resources are located in static files on the server-side filesystem. For example, a website might save chat message transcripts to disk using an incrementing filename, and allow users to retrieve these by visiting a URL like the following:<br /><code>https://insecure-website.com/static/12144.txt</code><br />In this situation, an attacker can simply modify the filename to retrieve a transcript created by another user and potentially obtain user credentials and other sensitive data.<br /><br /><br />Bibliography:<br />• <a href="https://portswigger.net/web-security/access-control/idor">https://portswigger.net/web-security/access-control/idor</a><br />• Zseano Methodology: <a href="https://www.bugbountyhunter.com/methodology/">https://www.bugbountyhunter.com/methodology/</a></div>
</body>
</html>
