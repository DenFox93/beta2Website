<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Remote FIle Inclusion (RFI)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Remote FIle Inclusion (RFI)</h1><br/><br /><strong><h3>Remote File Inclusion (RFI)</h3></strong><br />In some cases, we may also be able to include remote files &quot;<a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/07-Input_Validation_Testing/11.2-Testing_for_Remote_File_Inclusion">Remote File Inclusion (RFI)</a>&quot;, if the vulnerable function allows the inclusion of remote URLs. This allows two main benefits:<br />   1) Enumerating local-only ports and web applications. This would be a SSRF through RFI<br />   2) Gaining remote code execution by including a malicious script that we host<br /><br /><br /><strong>Local vs. Remote File Inclusion</strong><br />When a vulnerable function allows us to include remote files, we may be able to host a malicious script, and then include it in the vulnerable page to execute malicious functions and gain remote code execution. <br />If we refer to the table in the Cheat Sheet → <a href="Home--Penetration_Test_Methodology--WebApp_Pentest--Exploitation--Server-side--File_Inclusion--Cheat_Sheet--Vulnerable_Functions_Table.html">Vulnerable Functions Table</a>, we see that the following are some of the functions that (if vulnerable) would allow RFI:<br /><table class="table"><tr><th>Function</th><th>Read Content</th><th>Execute</th><th>Remote URL</th></tr></table><br /><table class="table"><tr><th>PHP</th><th> </th><th> </th><th> </th></tr><tr><td>include()/include_once()</td><td>✅</td><td>✅</td><td>✅</td></tr><tr><td>file_get_contents()</td><td>✅</td><td>❌</td><td>✅</td></tr></table><br /><table class="table"><tr><th>Java</th><th> </th><th> </th><th> </th></tr><tr><td>import</td><td>✅</td><td>✅</td><td>✅</td></tr></table><br /><table class="table"><tr><th>.NET</th><th> </th><th> </th><th> </th></tr><tr><td>@Html.RemotePartial()</td><td>✅</td><td>❌</td><td>✅</td></tr><tr><td>include</td><td>✅</td><td>✅</td><td>✅</td></tr></table><br /><br /><br />Almost any <span style="text-decoration:underline;">RFI vulnerability is also an LFI vulnerability</span>, as any function that allows including remote URLs usually also allows including local ones. <br />However, an <span style="text-decoration:underline;">LFI is not necessarily an RFI</span>. <br />This is primarily because of 3 reasons:<br />   1) The vulnerable function may not allow including remote URLs<br />   2) You may only control a portion of the filename and not the entire protocol wrapper (ex: <code>http://</code>, <code>ftp://</code>, <code>https://</code>).<br />   3) The configuration may prevent RFI altogether, as most modern web servers disable including remote files by default.<br /><br /><br /><strong>Bibliography:</strong><br /><a href="https://academy.hackthebox.com/">https://academy.hackthebox.com/</a></div>
</body>
</html>
