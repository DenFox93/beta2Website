<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Port scanner</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Port scanner</h1><br/><br />The main difference when we want to make a client <span style="text-decoration:underline;">port scanner</span> is to use <strong>connect_ex()</strong> instead of connect().<br /><strong>connect_ex()</strong> returns 0 if the operation succeeded; otherwise, it returns an error code. <br />    It is also a much faster functions because when the connection is interrupted by a signal instead of raising an exception object (heavy) return an integer errno variable(light)<br />    <br /><strong><h2>Scanning for the open ports</h2></strong><br /><div class="codebox"><pre><span style="color:#0088ff;font-weight:400">#!/usr/bin/env python3</span><br /><br /><span style="color:#333333;font-weight:400">import</span> socket<br /><br />SERVER_ADDRESS = <span style="color:#3ad900;font-weight:400">&quot;192.168.1.29&quot;</span>  <span style="color:#0088ff;font-weight:400"># The server&#39;s hostname or IP address</span><br />LOW_PORT = <span style="color:#ff0044;font-weight:400">65000</span>       <span style="color:#0088ff;font-weight:400"># Lowest port that the server can use</span><br />HIGH_PORT = <span style="color:#ff0044;font-weight:400">65536</span>       <span style="color:#0088ff;font-weight:400"># Highest port that the server can use</span><br /><br /><span style="color:#ff9d00;font-weight:700">print</span>(<span style="color:#3ad900;font-weight:400">&quot;I&#39;m scanning host&quot;</span>,SERVER_ADDRESS,<span style="color:#3ad900;font-weight:400">&quot;from port&quot;</span>,LOW_PORT,<span style="color:#3ad900;font-weight:400">&quot;to port&quot;</span>,HIGH_PORT)<br /><br /><span style="color:#ff9d00;font-weight:700">for</span> port <span style="color:#ff9d00;font-weight:700">in</span> <span style="color:#ff9d00;font-weight:700">range</span>(LOW_PORT,HIGH_PORT):<br />    s= socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br />    status= s.connect_ex((SERVER_ADDRESS, port))<br />    <span style="color:#ff9d00;font-weight:700">if</span> (status==<span style="color:#ff0044;font-weight:400">0</span>):<br />        <span style="color:#ff9d00;font-weight:700">print</span>(<span style="color:#3ad900;font-weight:400">&quot;------&gt; port&quot;</span>,port,<span style="color:#3ad900;font-weight:400">&quot;is open! &lt;------&quot;</span>)<br />    <span style="color:#ff9d00;font-weight:700">else</span>:<br />        <span style="color:#ff9d00;font-weight:700">print</span>(<span style="color:#3ad900;font-weight:400">&quot;port closed:&quot;</span>, port)<br />    s.close()<br /></pre></div><br />    <br />    <br /><strong><h2>Send messages to the first open port of the server</h2></strong><br /><div class="codebox"><pre><span style="color:#0088ff;font-weight:400">#!/usr/bin/env python3</span><br /><br /><span style="color:#333333;font-weight:400">import</span> socket<br /><br />SERVER_ADDRESS = <span style="color:#3ad900;font-weight:400">&quot;192.168.1.29&quot;</span>  <span style="color:#0088ff;font-weight:400"># The server&#39;s hostname or IP address</span><br />LOW_PORT = <span style="color:#ff0044;font-weight:400">65000</span>       <span style="color:#0088ff;font-weight:400"># Lowest port </span><br />HIGH_PORT = <span style="color:#ff0044;font-weight:400">65536</span>       <span style="color:#0088ff;font-weight:400"># Highest port &lt; 65536</span><br /><br /><span style="color:#ff9d00;font-weight:700">print</span>(<span style="color:#3ad900;font-weight:400">&quot;I&#39;m scanning host&quot;</span>,SERVER_ADDRESS,<span style="color:#3ad900;font-weight:400">&quot;from port&quot;</span>,LOW_PORT,<span style="color:#3ad900;font-weight:400">&quot;to port&quot;</span>,HIGH_PORT)<br /><br /><span style="color:#ff9d00;font-weight:700">for</span> port <span style="color:#ff9d00;font-weight:700">in</span> <span style="color:#ff9d00;font-weight:700">range</span>(LOW_PORT,HIGH_PORT):<br />    s= socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br />    status= s.connect_ex((SERVER_ADDRESS, port))<br />    <span style="color:#ff9d00;font-weight:700">if</span> (status==<span style="color:#ff0044;font-weight:400">0</span>):    <span style="color:#0088ff;font-weight:400">#port open</span><br />        <span style="color:#ff9d00;font-weight:700">print</span>(<span style="color:#3ad900;font-weight:400">&quot;port&quot;</span>,port,<span style="color:#3ad900;font-weight:400">&quot;is open!&quot;</span>)<br />        <span style="color:#ff9d00;font-weight:700">while</span> <span style="color:#ff0044;font-weight:400">True</span>:<br />            message=<span style="color:#ff9d00;font-weight:700">input</span>(<span style="color:#3ad900;font-weight:400">&quot;Message to send: &quot;</span>)<br />            s.sendall(message.encode())<br />            data = s.recv(<span style="color:#ff0044;font-weight:400">1024</span>)<br />            <span style="color:#ff9d00;font-weight:700">print</span>(data.decode(<span style="color:#3ad900;font-weight:400">&quot;utf-8&quot;</span>))<br />    <span style="color:#ff9d00;font-weight:700">else</span>:  <span style="color:#0088ff;font-weight:400">#port closed</span><br />        <span style="color:#ff9d00;font-weight:700">print</span>(<span style="color:#3ad900;font-weight:400">&quot;port closed&quot;</span>, port)<br />    s.close()</pre></div><br /><br /></div>
</body>
</html>
