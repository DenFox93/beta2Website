<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Prevention</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Prevention</h1><br/><br /><br /><strong><h3>AppArmor</h3></strong> (<a href="https://wiki.ubuntu.com/AppArmor">https://wiki.ubuntu.com/AppArmor</a>)<br />AppArmor is a Linux kernel security module that allows the system administrator to restrict programs&#39; capabilities with per-program profiles. <br />Profiles can allow capabilities like network access, raw socket access, and the permission to read, write, or execute files on matching paths.<br />AppArmor supplements the traditional Unix discretionary access control (DAC) model by providing mandatory access control (MAC).<br /><br /><strong>Apparmor and Sudo rights</strong><br />AppArmor in more recent distributions has predefined the commands used with the <code>postrotate-command</code>, effectively preventing command execution.<br /><br /><strong>Best practices when provisioning sudo rights</strong><br />• Always <span style="text-decoration:underline;">specify the absolute path</span> to any binaries listed in the sudoers file entry.<br />	Otherwise, an attacker may be able to leverage PATH abuse (which we will see in the next section) to create a malicious binary that will be executed when the command runs (i.e., if the sudoers entry specifies cat instead of /bin/cat this could likely be abused)<br />• <span style="text-decoration:underline;">Grant sudo rights sparingly</span> and <span style="text-decoration:underline;">based on the principle of least privilege</span>. Does the user need full sudo rights? Can they still perform their job with one or two entries in the sudoers file? Limiting the privileged command that a user can run will greatly reduce the likelihood of successful privilege escalation.<br /></div>
</body>
</html>
