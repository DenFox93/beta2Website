<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>FTP credentials (.netrc)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>FTP credentials (.netrc)</h1><br/><br /><br />The .netrc file contains <span style="text-decoration:underline;">data for logging into a remote host for file transfers via </span><strong><span style="text-decoration:underline;">FTP</span></strong>.<br />While the system administrator can establish secure permissions for users&#39; .netrc files, the users can easily override these.<br />Note: While the complete removal of .netrc files is recommended, if any are required on the system secure permissions must be applied.<br /><br /><br />Run the following script. This script will return:<br />   ◇ FAILED: for any .netrc file with permissions less restrictive than 600<br />   ◇ WARNING: for any .netrc files that exist in interactive users&#39; home directories.<br /><div class="codebox"><pre><span style="color:#0088ff;font-weight:400">#!/bin/bash</span><br /><br /><span style="color:#ff9d00;font-weight:700">awk</span> -F<span style="color:#ff9d00;font-weight:700">:</span> <span style="color:#3ad900;font-weight:400">&#39;($1!~/(halt|sync|shutdown)/ &amp;&amp; $7!~/^(\/usr)?\/sbin\/nologin(\/)?$/ &amp;&amp; $7!~/(\/usr)?\/bin\/false(\/)?$/) { print $1 &quot; &quot; $6 }&#39;</span> <span style="color:#ff9d00;font-weight:700">/</span>etc<span style="color:#ff9d00;font-weight:700">/passwd</span> <span style="color:#ff9d00;font-weight:700">|</span> <span style="color:#ff9d00;font-weight:700">while</span> <span style="color:#ff9d00;font-weight:700">read</span> -r user <span style="color:#ff9d00;font-weight:700">dir;</span> <span style="color:#ff9d00;font-weight:700">do</span><br />    <span style="color:#ff9d00;font-weight:700">if</span> [ -d <span style="color:#3ad900;font-weight:400">&quot;$dir&quot;</span> ]<span style="color:#ff9d00;font-weight:700">;</span> <span style="color:#ff9d00;font-weight:700">then</span><br />        <span style="color:#7f0044;font-weight:400">file</span>=<span style="color:#3ad900;font-weight:400">&quot;$dir/.netrc&quot;</span><br />        <span style="color:#ff9d00;font-weight:700">if</span> [ <span style="color:#ff9d00;font-weight:700">!</span> -h <span style="color:#3ad900;font-weight:400">&quot;$file&quot;</span> ] <span style="color:#ff9d00;font-weight:700">&amp;&amp;</span> [ -f <span style="color:#3ad900;font-weight:400">&quot;$file&quot;</span> ]<span style="color:#ff9d00;font-weight:700">;</span> <span style="color:#ff9d00;font-weight:700">then</span><br />            <span style="color:#ff9d00;font-weight:700">if</span> <span style="color:#ff9d00;font-weight:700">stat</span> -L -c <span style="color:#3ad900;font-weight:400">&quot;%A&quot;</span> <span style="color:#3ad900;font-weight:400">&quot;$file&quot;</span> <span style="color:#ff9d00;font-weight:700">|</span> <span style="color:#ff9d00;font-weight:700">cut</span> -c4-10 <span style="color:#ff9d00;font-weight:700">|</span> <span style="color:#ff9d00;font-weight:700">grep</span> -Eq <span style="color:#3ad900;font-weight:400">&#39;[^-]+&#39;</span><span style="color:#ff9d00;font-weight:700">;</span> <span style="color:#ff9d00;font-weight:700">then</span><br />                <span style="color:#ff9d00;font-weight:700">echo</span> <span style="color:#3ad900;font-weight:400">&quot;FAILED: User: \&quot;$user\&quot; file: \&quot;$file\&quot; exists with permissions: \&quot;$(stat -L -c &quot;</span>%a<span style="color:#3ad900;font-weight:400">&quot; &quot;</span><span style="color:#7f0044;font-weight:400">$file</span><span style="color:#3ad900;font-weight:400">&quot;)\&quot;, remove file or excessive permissions&quot;</span><br />            <span style="color:#ff9d00;font-weight:700">else</span><br />                <span style="color:#ff9d00;font-weight:700">echo</span> <span style="color:#3ad900;font-weight:400">&quot;WARNING: User: \&quot;$user\&quot; file: \&quot;$file\&quot; exists with permissions: \&quot;$(stat -L -c &quot;</span>%a<span style="color:#3ad900;font-weight:400">&quot; &quot;</span><span style="color:#7f0044;font-weight:400">$file</span><span style="color:#3ad900;font-weight:400">&quot;)\&quot;, remove file unless required&quot;</span><br />            <span style="color:#ff9d00;font-weight:700">fi</span><br />        <span style="color:#ff9d00;font-weight:700">fi</span><br />    <span style="color:#ff9d00;font-weight:700">fi</span><br /><span style="color:#ff9d00;font-weight:700">done</span></pre></div><br /><br /><br /><br /><strong>Bibliography:</strong><br />CIS Ubuntu Linux 20.04 benchmark</div>
</body>
</html>
