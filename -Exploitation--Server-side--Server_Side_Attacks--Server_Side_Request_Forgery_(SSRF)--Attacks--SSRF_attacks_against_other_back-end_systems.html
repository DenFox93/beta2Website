<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>SSRF attacks against other back-end systems</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>SSRF attacks against other back-end systems</h1><br/><br /><br />SSRF can also be used to interact with other back-end systems that are not directly reachable by users. <br />In many cases, internal back-end systems contain sensitive functionality that can be accessed without authentication by anyone who is able to interact with the systems.<br /><br /><strong><span style="color:#a52a2a;">Theoretical Example</span></strong><br />Suppose there is an administrative interface at the back-end URL https://192.168.0.68/admin. Here, an attacker can exploit the SSRF vulnerability to access the administrative interface by submitting the following request:<br /><br /><div class="codebox"><pre>POST <span style="color:#ff9d00;font-weight:700">/</span>product<span style="color:#ff9d00;font-weight:700">/</span>stock HTTP<span style="color:#ff9d00;font-weight:700">/</span>1.0<br />Content-Type<span style="color:#ff9d00;font-weight:700">:</span> application<span style="color:#ff9d00;font-weight:700">/</span>x-www-form-urlencoded<br />Content-Length<span style="color:#ff9d00;font-weight:700">:</span> 118<br /><br /><span style="color:#7f0044;font-weight:400">stockApi</span>=http<span style="color:#ff9d00;font-weight:700">://</span>192.168.0.68<span style="color:#ff9d00;font-weight:700">/</span>admin<br /><br /></pre></div><br /><br /><br /><strong><span style="color:#a52a2a;">Practical Example</span></strong>: <strong>Scan the internal 192.168.0.X range Network</strong><br />1. Visit a product, click &quot;Check stock&quot;, intercept the request in Burp Suite<br />    <a href=""><img src="images/2232-1.png" alt="images/2232-1.png" /></a><br />2. Send it to Burp Intruder<br />3. Click &quot;Clear §&quot;, change the <code>stockApi</code> parameter to <code>http://192.168.0.1:8080/admin</code> then highlight the final octet of the IP address (the number <code>1</code>), click &quot;Add §&quot;.<br />    <a href=""><img src="images/2232-2.png" alt="images/2232-2.png" /></a><br />4. Switch to the Payloads tab, change the payload type to Numbers, and enter 1, 255, and 1 in the &quot;From&quot; and &quot;To&quot; and &quot;Step&quot; boxes respectively.<br />    <a href=""><img src="images/2232-3.png" alt="images/2232-3.png" /></a><br />5. Click &quot;Start attack&quot;. <br />6. The only different response (404) is from the host 192.168.0.107, this should be reachable<br />    <a href=""><img src="images/2232-4.png" alt="images/2232-4.png" /></a><br />    <a href=""><img src="images/2232-5.png" alt="images/2232-5.png" /></a><br />7. Check if give us status of 200, showing an admin interface.<br />    <a href=""><img src="images/2232-6.png" alt="images/2232-6.png" /></a><br />    <a href=""><img src="images/2232-7.png" alt="images/2232-7.png" /></a><br />8. Click on this request, send it to Burp Repeater, and change the path in the <code>stockApi</code> to: <code>/admin/delete?username=carlos</code><br />    <a href=""><img src="images/2232-8.png" alt="images/2232-8.png" /></a><br /><br /><br /><br /><br /><br /><br /><br /><br /><strong>Bibliography:</strong><br /><a href="https://portswigger.net/web-security/ssrf/lab-basic-ssrf-against-backend-system">https://portswigger.net/web-security/ssrf/lab-basic-ssrf-against-backend-system</a></div>
</body>
</html>
