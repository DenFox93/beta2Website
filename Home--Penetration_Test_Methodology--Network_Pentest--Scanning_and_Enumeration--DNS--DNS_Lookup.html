<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>DNS Lookup</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>DNS Lookup</h1><br/><br />With the Whois lookup we have retrieved a list of DNS servers associated with the target, now we want to query those servers to gain an inventory of potential target machines associated with the given target domain(s).<br />    <div class="codebox"><pre>whois google.com</pre></div><br />    <a href=""><img src="images/1473-1.png" alt="images/1473-1.png" /></a><br /><br /><br /><br />To examine(query) a DNS servers and potentially obtain records about the various hosts of which it is aware we can use:<br />• nslookup (from command line for Windows)<br />• nslookup (from shell, it has some limitations on linux, because of that is better dig)<br />• dig (from shell for linux)<br />• <a href="http://network-tools.com/nslook/">http://network-tools.com/nslook/</a><br />• <a href="https://www.dnsqueries.com/en/">https://www.dnsqueries.com/en/</a><br />• <a href="https://mxtoolbox.com/SuperTool.aspx">https://mxtoolbox.com/SuperTool.aspx</a><br /><br /><br /><span style="color:#a020f0;">• (Forward) </span><h3>DNS Lookup</h3><br />DNS zone as common practice has:<br />   ◇ more A (name -&gt; IP) records point usually to the same IP<br />   ◇ each PTR (IP -&gt; name) record usually points only to one name. <br />Query that asks to the DNS to resolve a hostname to the corresponding IP.<br /><a href="rk_Pentest--Recoinnaissance_(OSINT_Open_Source_Information_Gathering)--Document_Metadata_Analysis--Google_Dork_find_files_and_directories.html">A</a><a href="rk_Pentest--Recoinnaissance_(OSINT_Open_Source_Information_Gathering)--Document_Metadata_Analysis--Google_Dork_find_files_and_directories.html"> record</a> maps the domain name to an IP address<br /><div class="codebox"><pre>nslookup <span style="color:#ff9d00;font-weight:700">-type=</span>A www.elsfoo.com          <span style="color:#0088ff;font-weight:400">#windows</span><br />nslookup <span style="color:#ff9d00;font-weight:700">-</span>query<span style="color:#ff9d00;font-weight:700">=</span>A www.elsfoo.com         <span style="color:#0088ff;font-weight:400">#linux</span><br />dig <span style="color:#ff9d00;font-weight:700">-</span>t A www.elsfoo.com                  <span style="color:#0088ff;font-weight:400">#linux</span><br />host www.elsfoo.com                      <span style="color:#0088ff;font-weight:400">#linux</span></pre></div><br />   <span style="color:#f6ff00;">◇ </span><strong><span style="color:#f6ff00;">Reverse DNS Lookup</span></strong><br />    <a href="rk_Pentest--Recoinnaissance_(OSINT_Open_Source_Information_Gathering)--Document_Metadata_Analysis--Google_Dork_find_files_and_directories.html">PTR</a><a href="rk_Pentest--Recoinnaissance_(OSINT_Open_Source_Information_Gathering)--Document_Metadata_Analysis--Google_Dork_find_files_and_directories.html"> record</a> is the reverse version of an A record. the PTR record maps the IP address to a hostname. <br />    <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">PS</span>&gt; <span style="color:#ff9d00;font-weight:700">iex</span> (<span style="color:#ff9d00;font-weight:700">New-Object</span> Net.WebClient).DownloadString(<span style="color:#3ad900;font-weight:400">&quot;https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/Invoke-ReverseDnsLookup.ps1&quot;</span>); <span style="color:#00117f;font-weight:400">Invoke-ReverseDnsLookup</span> <span style="color:#ff9d00;font-weight:700">-</span>CIDR <span style="color:#333333;font-weight:400">192.178</span>.<span style="color:#333333;font-weight:400">124.83</span><span style="color:#ff9d00;font-weight:700">/</span><span style="color:#333333;font-weight:400">24</span>     <span style="color:#0088ff;font-weight:400">#Windows</span></pre></div><br />    <a href=""><img src="images/1473-2.png" alt="images/1473-2.png" /></a><br />    <div class="codebox"><pre>nslookup <span style="color:#333333;font-weight:400">198.178</span>.<span style="color:#333333;font-weight:400">124.83</span>               <span style="color:#0088ff;font-weight:400">#windows</span><br />nslookup <span style="color:#ff9d00;font-weight:700">-</span>query<span style="color:#ff9d00;font-weight:700">=</span>PTR <span style="color:#333333;font-weight:400">198.178</span>.<span style="color:#333333;font-weight:400">124.83</span>    <span style="color:#0088ff;font-weight:400">#linux</span><br />dig <span style="color:#ff9d00;font-weight:700">-</span>t PTR <span style="color:#ff9d00;font-weight:700">-</span>x <span style="color:#333333;font-weight:400">198.178</span>.<span style="color:#333333;font-weight:400">124.83</span>          <span style="color:#0088ff;font-weight:400">#linux</span><br />host <span style="color:#333333;font-weight:400">198.178</span>.<span style="color:#333333;font-weight:400">124.83</span>                   <span style="color:#0088ff;font-weight:400">#linux</span></pre></div><br /><a href=""><img src="images/1473-3.png" alt="images/1473-3.png" /></a><br /><h3>• </h3><strong><h3>Name Server(NS) Lookup</h3></strong><br />Here we want to know the Name Server(s)<br /><div class="codebox"><pre>dig -t NS elsfoo.com </pre></div><br />    <a href=""><img src="images/1473-4.png" alt="images/1473-4.png" /></a><br />    now we want to get the IP address of each of these NS Server(we have to do a DNS Lookup)<br />    <div class="codebox"><pre>dig -t A ns3.elsfoo.com<br />dig -t A ns2.elsfoo.com</pre></div><br /><br /><br /><span style="color:#ff1b00;">• </span><strong><h3>MX(Mail Exchange) Lookup</h3></strong><br />list of servers responsible for delivering e-mails for that domain<br /><div class="codebox"><pre>nslookup <span style="color:#ff9d00;font-weight:700">-type=</span>MX example.com  &lt;IP_address_DNS_server&gt;                  <span style="color:#0088ff;font-weight:400">#windows</span><br />nslookup <span style="color:#ff9d00;font-weight:700">-</span>query<span style="color:#ff9d00;font-weight:700">=</span>MX example.com  &lt;IP_address_DNS_server&gt;                 <span style="color:#0088ff;font-weight:400">#linux</span><br />dig <span style="color:#ff9d00;font-weight:700">-</span>t MX example.com @&lt;IP_address_DNS_server&gt;                          <span style="color:#0088ff;font-weight:400">#linux</span></pre></div><br />@ns3.elsfoo.com →  set the server that we want to query (anyway this parameter is optional)<br />    now we want to get the IP address of each of these MX Server(we have to do a DNS Lookup)<br />    <div class="codebox"><pre>dig -t A alt2.aspmx.l.google.com<br />dig -t A aspmx2.googlemail.com</pre></div><br /><br /><br /><br />Bibliography:<br />• <a href="https://www.cloudflare.com/learning/dns/glossary/dns-root-server/">https://www.cloudflare.com/learning/dns/glossary/dns-root-server/</a><br />• <a href="https://www.cloudflare.com/learning/dns/dns-server-types/">https://www.cloudflare.com/learning/dns/dns-server-types/</a><br />• <a href="https://www.cloudflare.com/learning/dns/dns-server-types/">https://www.cloudflare.com/learning/dns/dns-server-types/</a><br /><br /><br /><br /></div>
</body>
</html>
