<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>nmap</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>nmap</h1><br/><br />Even if is mainly used for network discovery, port scanning etc.. with it we can run also scripts, these scripts can be used to check if a remote system is vulnerable to specific vulnerability such us <span style="text-decoration:underline;">null session</span> and then get informations from the remote system. <br /><br />Version service port scanning:<br />    <div class="codebox"><pre>nmap -sS -sU -sV &lt;address&gt; -p135,137,139,445 --open</pre></div><br /><br />The script for null session vulnerability are:<br />• <strong>smb-vuln*<br />    </strong><div class="codebox"><pre>nmap -script=smb-vuln* -p 139,445 &lt;address&gt;</pre></div><br />    The script connects to the $IPC tree, executes a transaction on FID 0 and checks if the error “STATUS_INSUFF_SERVER_RESOURCES” is returned to determine if the target is not patched against ms17-010. Additionally, it checks for known error codes returned by patched systems.<br /><br />• <strong>smb-enum-shares</strong><br />    <div class="codebox"><pre>nmap -script=smb-enum-shares &lt;address&gt;</pre></div><br />    if we have anonymous access to IPC$ share the system is vulnerable to null session<br />• <strong>smb-enum-brute</strong><br />    <div class="codebox"><pre>nmap -script=smb-brute &lt;address&gt;</pre></div><br />    this script will try to brute-force the remote username and password <br />• <strong>smb-enum-users</strong><br />    <div class="codebox"><pre>nmap -script=smb-enum-users &lt;address&gt;</pre></div><br />    we can see all the users available, their RIDs and some password informations<br />   ◇ If we have discovered working credentials, we can use them to have more informations<br />       <div class="codebox"><pre>nmap --script=smb-enum-users -p 445 10.130.40.70 --script-args smbuser=administrator,smbpass=password</pre></div><br />       Note we can specify the credentials also with &quot;smbclient&quot; on Linux and &quot;net use&quot; and “net view” on windows<strong><br /></strong></div>
</body>
</html>
