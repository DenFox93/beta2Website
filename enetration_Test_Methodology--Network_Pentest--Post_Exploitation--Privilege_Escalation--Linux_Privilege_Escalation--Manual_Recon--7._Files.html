<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>7. Files</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>7. Files</h1><br/><br /><strong>Files and directories that have world-writable permissions</strong><br />Files with world-writable permissions can be modified by any user on the system<br />   ◇ <span style="text-decoration:underline;">World Writeable Directories for Users other than Root</span>:<br />    <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">find</span> <span style="color:#ff9d00;font-weight:700">/</span> <span style="color:#333333;font-weight:400">\(</span> -wholename <span style="color:#3ad900;font-weight:400">&#39;/home/homedir*&#39;</span> -prune <span style="color:#333333;font-weight:400">\)</span> -o <span style="color:#333333;font-weight:400">\(</span> -type d -perm -0002 <span style="color:#333333;font-weight:400">\)</span> -exec <span style="color:#ff9d00;font-weight:700">ls</span> -ld <span style="color:#3ad900;font-weight:400">&#39;{}&#39;</span> <span style="color:#3ad900;font-weight:400">&#39;;&#39;</span> 2&gt;<span style="color:#ff9d00;font-weight:700">/</span>dev<span style="color:#ff9d00;font-weight:700">/</span>null <span style="color:#ff9d00;font-weight:700">|</span> <span style="color:#ff9d00;font-weight:700">grep</span> -v root</pre></div><br />   ◇ <span style="text-decoration:underline;">World Writeable Directories for User/Group &#39;Root&#39;</span>:<br />    <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">find</span> <span style="color:#ff9d00;font-weight:700">/</span> <span style="color:#333333;font-weight:400">\(</span> -wholename <span style="color:#3ad900;font-weight:400">&#39;/home/homedir*&#39;</span> -prune <span style="color:#333333;font-weight:400">\)</span> -o <span style="color:#333333;font-weight:400">\(</span> -type d -perm -0002 <span style="color:#333333;font-weight:400">\)</span> -exec <span style="color:#ff9d00;font-weight:700">ls</span> -ld <span style="color:#3ad900;font-weight:400">&#39;{}&#39;</span> <span style="color:#3ad900;font-weight:400">&#39;;&#39;</span> 2&gt;<span style="color:#ff9d00;font-weight:700">/</span>dev<span style="color:#ff9d00;font-weight:700">/</span>null <span style="color:#ff9d00;font-weight:700">|</span> <span style="color:#ff9d00;font-weight:700">grep</span> root </pre></div><br />   ◇ <span style="text-decoration:underline;">world writable files</span>:<br />    <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">find</span> <span style="color:#ff9d00;font-weight:700">/</span> <span style="color:#333333;font-weight:400">\(</span> -wholename <span style="color:#3ad900;font-weight:400">&#39;/home/homedir/*&#39;</span> -prune -o -wholename <span style="color:#3ad900;font-weight:400">&#39;/proc/*&#39;</span> -prune <span style="color:#333333;font-weight:400">\)</span> -o <span style="color:#333333;font-weight:400">\(</span> -type f -perm -0002 <span style="color:#333333;font-weight:400">\)</span> -exec <span style="color:#ff9d00;font-weight:700">ls</span> -l <span style="color:#3ad900;font-weight:400">&#39;{}&#39;</span> <span style="color:#3ad900;font-weight:400">&#39;;&#39;</span> 2&gt;<span style="color:#ff9d00;font-weight:700">/</span>dev<span style="color:#ff9d00;font-weight:700">/</span>null</pre></div><br />   ◇ <span style="text-decoration:underline;">world-writable files in /etc:</span><br />    <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">find</span> <span style="color:#ff9d00;font-weight:700">/</span>etc -perm -2 -type f 2&gt;<span style="color:#ff9d00;font-weight:700">/</span>dev<span style="color:#ff9d00;font-weight:700">/</span>null</pre></div><br />   ◇ <span style="text-decoration:underline;">searches for world-writable directories:</span><br />    <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">find</span> <span style="color:#ff9d00;font-weight:700">/</span> -writable -type d 2&gt;<span style="color:#ff9d00;font-weight:700">/</span>dev<span style="color:#ff9d00;font-weight:700">/</span>null</pre></div><br />   ◇ <br /><br /><strong>Find files that are own by other users</strong><br />   ◇ readable by our actual user but own by another user<br />        <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">find</span> <span style="color:#ff9d00;font-weight:700">/</span> -perm <span style="color:#ff9d00;font-weight:700">/</span>u=r -user [USER] 2&gt;<span style="color:#ff9d00;font-weight:700">/</span>dev<span style="color:#ff9d00;font-weight:700">/</span>null</pre></div><br />   ◇ writable by our actual user but own by another user<br />        <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">find</span> <span style="color:#ff9d00;font-weight:700">/</span> -perm <span style="color:#ff9d00;font-weight:700">/</span>u=<span style="color:#ff9d00;font-weight:700">w</span> -user [USER] 2&gt;<span style="color:#ff9d00;font-weight:700">/</span>dev<span style="color:#ff9d00;font-weight:700">/</span>null</pre></div><br /><br /><br />  <br /><br /><br /><strong>list open files</strong>(<a href="https://en.wikipedia.org/wiki/Lsof">https://en.wikipedia.org/wiki/Lsof</a>)<br /><div class="codebox"><pre>target@linux<span style="color:#ff9d00;font-weight:700">:</span>~$ lsof</pre></div><br /><br /><br /><strong>Find files</strong><br />   ◇ Find Files with “history” In Their Name (.bash_history, etc.)<br />        <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">find</span> <span style="color:#ff9d00;font-weight:700">/</span>* -name *.*history* -print 2&gt; <span style="color:#ff9d00;font-weight:700">/</span>dev<span style="color:#ff9d00;font-weight:700">/</span>null</pre></div><br />   ◇ Find Files Owned By A Particular User<br />        <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">find</span> <span style="color:#ff9d00;font-weight:700">/</span> -user <span style="color:#7f0044;font-weight:400">$user</span></pre></div><br />        <span style="color:#a5452a;">example:</span> find / -user www-data<br />   ◇ Apache access.log file, grep for “user” and “pass” strings<br />        <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">cat</span> <span style="color:#ff9d00;font-weight:700">/</span>var<span style="color:#ff9d00;font-weight:700">/</span>log<span style="color:#ff9d00;font-weight:700">/</span>apache<span style="color:#ff9d00;font-weight:700">/</span>access.log <span style="color:#ff9d00;font-weight:700">|grep</span> -E <span style="color:#3ad900;font-weight:400">&quot;^user|^pass&quot;</span></pre></div><br />   ◇ Dump cleartext Pre-Shared Wireless Keys from Network Manager<br />        <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">cat</span> <span style="color:#ff9d00;font-weight:700">/</span>etc<span style="color:#ff9d00;font-weight:700">/</span>NetworkManager<span style="color:#ff9d00;font-weight:700">/</span>system-connections<span style="color:#ff9d00;font-weight:700">/</span>* <span style="color:#ff9d00;font-weight:700">|grep</span> -E <span style="color:#3ad900;font-weight:400">&quot;^id|^psk&quot;</span></pre></div><br />   ◇ Find Files Owned By A Particular Group<br />        <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">find</span> <span style="color:#ff9d00;font-weight:700">/</span> -group <span style="color:#7f0044;font-weight:400">$group</span></pre></div><br />        <span style="color:#a5452a;">example:</span> find / -group sudo    <br />   ◇ Find File Types Owned by a Particular User<br />        <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">find</span> <span style="color:#ff9d00;font-weight:700">/</span> -user admin -name “*.sh”</pre></div><br />   ◇ search for id_rsa file<br />        <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">find</span> <span style="color:#ff9d00;font-weight:700">/</span> -name id_rsa 2&gt; <span style="color:#ff9d00;font-weight:700">/</span>dev<span style="color:#ff9d00;font-weight:700">/</span>null</pre></div><br />        <a href=""><img src="images/917-1.png" alt="images/917-1.png" /></a><br />   </div>
</body>
</html>
