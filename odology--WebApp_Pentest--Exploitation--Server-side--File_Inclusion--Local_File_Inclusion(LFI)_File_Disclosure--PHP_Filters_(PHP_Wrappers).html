<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>PHP Filters (PHP Wrappers)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>PHP Filters (PHP Wrappers)</h1><br/><br /><h1>PHP Filters</h1><br />Many web applications in PHP are built with PHP frameworks:<br />   ◇ Laravel<br />      ▪ Wappalyzer<br />         <a href=""><img src="images/2337-1.png" alt="images/2337-1.png" /></a><br />   ◇ Symfony<br />      ▪ Wappalyzer<br />      	<a href=""><img src="images/2337-2.png" alt="images/2337-2.png" /></a><br />   ◇ ...<br />Once found a LFI vulnerability in PHP webapp, we can utilize <a href="https://www.php.net/manual/en/wrappers.php.php">PHP Wrappers</a> to extend our LFI exploitation to reach:<br />   ◇  <a href="Home--Penetration_Test_Methodology--WebApp_Pentest--Exploitation--Server-side--File_Inclusion--Remote_Code_Execution_(RCE)--PHP_wrappers.html">RCE</a> (in the Remote Code Execution Section)<br />   ◇  <a href="tation--Server-side--File_Inclusion--Local_File_Inclusion(LFI)_File_Disclosure--PHP_Filters_(PHP_Wrappers)--2._PHP_Source_Code_Disclosure.html">PHP Source Code Disclosure</a> (THIS)<br />PHP Wrappers allow to access I/O streams at the application level:<br />   ◇ standard input/output<br />   ◇ file descriptors<br />   ◇ memory streams<br />   ◇ ...<br /><br />PHP wrappers can be used also for XXE attacks<br /><br /><strong><h3>PHP Input Filters</h3></strong><br /><a href="https://www.php.net/manual/en/filters.php">PHP Filters</a> are a <span style="text-decoration:underline;">type of PHP wrappers</span><br />We can pass an input and have it filtered by the filter we specify. <br />• PHP wrapper streams →  <code>php://</code> <br />   ◇ <span style="color:#9141ac;">PHP filter wrapper</span> →  <code>php://</code><code><span style="color:#9141ac;">filter</span></code><code>/</code><br />      ▪ parameter: resource → <code>php:/</code><code><span style="color:#9141ac;">/filter</span></code><code>/resource=....</code><br />      	It is possible specify the stream we would like to apply (e.g. a local file)<br />      ▪ parameter: read → <code>php://</code><code><span style="color:#9141ac;">filter</span></code><code>/read=....</code><br />        It is possible specify which filter apply on the input resource<br />Types of <span style="color:#9141ac;">PHP Filters</span>:<br />• <a href="https://www.php.net/manual/en/filters.string.php">String Filters</a><br />• <a href="https://www.php.net/manual/en/filters.convert.php">Conversion Filters</a><br />   ◇ <code>convert.base64-encode</code> is the one useful for LFI attacks<br />• <a href="https://www.php.net/manual/en/filters.compression.php">Compression Filters</a><br />• <a href="https://www.php.net/manual/en/filters.encryption.php">Encryption Filters</a><br /><br /><br /><br /></div>
</body>
</html>
