<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>by redirecting output</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>by redirecting output</h1><br/><br />Possible redirect the output from the injected command into a file within the web root that you can then retrieve using your browser. <br />For example, if the application serves static resources from the filesystem location <br />• /var/www/static/[app]<br />• /var/www/[app]<br />• /usr/local/[app]<br />• /srv/[app]<br />• /srv/www/[app]<br />Then you can submit the following input:<br /><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">&amp;</span> <span style="color:#ff9d00;font-weight:700">whoami</span> &gt; <span style="color:#ff9d00;font-weight:700">/</span>var<span style="color:#ff9d00;font-weight:700">/</span>www<span style="color:#ff9d00;font-weight:700">/</span>static<span style="color:#ff9d00;font-weight:700">/</span>whoami.txt <span style="color:#ff9d00;font-weight:700">&amp;</span></pre></div><br />The &gt; character sends the output from the whoami command to the specified file that is situated in <span style="text-decoration:underline;">writable folder of the WebApp</span>. You can then use your browser to fetch:<br /><div class="codebox"><pre>https<span style="color:#ff9d00;font-weight:700">://</span>vulnerable-website.com<span style="color:#ff9d00;font-weight:700">/</span>whoami.txt </pre></div><br />to retrieve the file, and view the output from the injected command.<br /><br /><br /><strong><span style="color:#a52a2a;">Exercise:</span></strong><br /><br />1. Find a writable folder<br />    <div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">/</span>var<span style="color:#ff9d00;font-weight:700">/</span>www<span style="color:#ff9d00;font-weight:700">/</span>images<span style="color:#ff9d00;font-weight:700">/</span></pre></div><br />2. Use Burp Suite to intercept and modify the request that submits feedback.<br />    <a href=""><img src="images/2250-1.png" alt="images/2250-1.png" /></a><br />3. Modify the email parameter, changing it to:<br />    <div class="codebox"><pre><span style="color:#7f0044;font-weight:400">email</span>=<span style="color:#ff9d00;font-weight:700">||whoami</span>&gt;<span style="color:#ff9d00;font-weight:700">/</span>var<span style="color:#ff9d00;font-weight:700">/</span>www<span style="color:#ff9d00;font-weight:700">/</span>images<span style="color:#ff9d00;font-weight:700">/</span>output.txt<span style="color:#ff9d00;font-weight:700">||</span></pre></div><br />    <a href=""><img src="images/2250-2.png" alt="images/2250-2.png" /></a><br />4. Now use Burp Suite to intercept and modify the request that loads an image of a product.<br />    <a href=""><img src="images/2250-3.png" alt="images/2250-3.png" /></a><br />5. Modify the filename parameter, changing the value to the name of the file you specified for the output of the injected command:<br />    <div class="codebox"><pre><span style="color:#7f0044;font-weight:400">filename</span>=output.txt</pre></div><br />    <a href=""><img src="images/2250-4.png" alt="images/2250-4.png" /></a><br />    Observe that the response contains the output from the injected command.<br /><br /><br /><br /><br /><br />Bibliography:<br /><a href="https://portswigger.net/web-security/os-command-injection/lab-blind-output-redirection">https://portswigger.net/web-security/os-command-injection/lab-blind-output-redirection</a></div>
</body>
</html>
