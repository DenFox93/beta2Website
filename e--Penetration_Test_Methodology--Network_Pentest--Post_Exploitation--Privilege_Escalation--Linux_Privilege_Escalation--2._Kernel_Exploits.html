<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>2. Kernel Exploits</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>2. Kernel Exploits</h1><br/><strong><h3>Prerequisite:</h3></strong><br />One of the requirements, of course, is that GNU C/C++ Compiler is installed on the target.<br />We can determine this by simply running “gcc --version” on the target system. <br />    <a href=""><img src="images/1282-1.png" alt="images/1282-1.png" /></a><br /><br /><strong><h3>Kernel</h3></strong><br />• Kernels are the core of any operating system.<br />• It as a layer between application software and the actual computer hardware.<br />• The kernel has complete control over the operating system.<br />• Exploiting a kernel vulnerability can result in execution as the root user.<br />• <span style="color:#ff0000;">Warning:</span> Kernel exploits can often be unstable and may be one-shot or cause a system crash<br /><br /><strong>Kernel exploits</strong><br />1. enumerate the kernel version<br />    <div class="codebox"><pre>target@debian<span style="color:#ff9d00;font-weight:700">:</span>~$ <span style="color:#ff9d00;font-weight:700">uname</span> -a                    <span style="color:#0088ff;font-weight:400">#system kernel information</span></pre></div><br />    <a href=""><img src="images/1282-2.png" alt="images/1282-2.png" /></a><br />	<div class="codebox"><pre>target@debian<span style="color:#ff9d00;font-weight:700">:</span>~$ <span style="color:#ff9d00;font-weight:700">cat</span> <span style="color:#ff9d00;font-weight:700">/</span>etc<span style="color:#ff9d00;font-weight:700">/</span>lsb-release      <span style="color:#0088ff;font-weight:400">#OS version (not all distribution have it, not standard)</span><br />target@debian<span style="color:#ff9d00;font-weight:700">:</span>~$ <span style="color:#ff9d00;font-weight:700">cat</span> <span style="color:#ff9d00;font-weight:700">/</span>etc<span style="color:#ff9d00;font-weight:700">/</span>os-release       <span style="color:#0088ff;font-weight:400">#OS version (standard)</span></pre></div><br />3. Search for a Kernel Exploit with: SearchSploit(ExploitDB), linux-exploit-suggester-2, Google, GitHub<br />   ◇ use <strong>google</strong> →  linux &lt;kernel-version&gt; exploit<br />   		<div class="codebox"><pre>linux 2.6.32-5-amd64 exploit</pre></div><strong><br /></strong>   ◇ Use <strong>searchsploit</strong> → specific <span style="text-decoration:underline;">kernel version</span><br />       <div class="codebox"><pre>attacker@kali<span style="color:#ff9d00;font-weight:700">:/</span># searchsploit linux kernel 2.6.32 privilege escalation</pre></div><br />   ◇  Use <strong>searchsploit</strong> → specific <span style="text-decoration:underline;">distribution</span><br />       <div class="codebox"><pre>attacker@kali<span style="color:#ff9d00;font-weight:700">:/</span># searchsploit linux kernel 2.6 priv esc debian</pre></div><br />   ◇ use <a href="work_Pentest--Post_Exploitation--Privilege_Escalation--Linux_Privilege_Escalation--Automated_Recon_with_Tools--linux-exploit-suggester.sh.html">linux-exploit-suggester-suggester</a> (bash version) to find exploits for a specific version of the kernel<br />       <div class="codebox"><pre>attacker@kali<span style="color:#ff9d00;font-weight:700">:/</span># <span style="color:#ff9d00;font-weight:700">wget</span> https<span style="color:#ff9d00;font-weight:700">://</span>raw.githubusercontent.com<span style="color:#ff9d00;font-weight:700">/</span>mzet-<span style="color:#ff9d00;font-weight:700">/</span>linux-exploit-suggester<span style="color:#ff9d00;font-weight:700">/</span>master<span style="color:#ff9d00;font-weight:700">/</span>linux-exploit-suggester.sh<br />attacker@kali<span style="color:#ff9d00;font-weight:700">:/</span># <span style="color:#ff9d00;font-weight:700">chmod</span> +x linux-exploit-suggester.sh<br />attacker@kali<span style="color:#ff9d00;font-weight:700">:/</span># .<span style="color:#ff9d00;font-weight:700">/</span>linux-exploit-suggester.sh         <span style="color:#0088ff;font-weight:400">#Execute</span></pre></div><br />        <a href=""><img src="images/1282-3.png" alt="images/1282-3.png" /></a><br />   ◇ use <strong>linux-exploit-suggester-2</strong> (perl version) to find exploits for a specific version of the kernel<br />      GitHub: <a href="https://github.com/jondonas/linux-exploit-suggester-2">https://github.com/jondonas/linux-exploit-suggester-2</a><br />       Attacker machine<br />       <div class="codebox"><pre>attacker@kali<span style="color:#ff9d00;font-weight:700">:/</span># <span style="color:#ff9d00;font-weight:700">wget</span> https<span style="color:#ff9d00;font-weight:700">://</span>raw.githubusercontent.com<span style="color:#ff9d00;font-weight:700">/</span>jondonas<span style="color:#ff9d00;font-weight:700">/</span>linux-exploit-suggester-2<span style="color:#ff9d00;font-weight:700">/</span>master<span style="color:#ff9d00;font-weight:700">/</span>linux-exploit-suggester-2.pl<br />attacker@kali<span style="color:#ff9d00;font-weight:700">:/</span># .<span style="color:#ff9d00;font-weight:700">/</span>linux-exploit-suggester-2.pl -k &lt;kernel-number&gt;</pre></div><br />       <a href=""><img src="images/1282-4.png" alt="images/1282-4.png" /></a><br />   ◇ use Kernelpop(<a href="https://github.com/spencerdodd/kernelpop">https://github.com/spencerdodd/kernelpop</a>) to search Kernel vulnerability for Mac <br />5. <a href="Network_Pentest--Post_Exploitation--Privilege_Escalation--Linux_Privilege_Escalation--2._Kernel_Exploits--compile_and_execute_the_exploit.html">Compile and Execute the Exploit</a><br /><br /><br /><strong>Bibliography:</strong><br />• TCM Security: Linux Privilege Escalation for Beginners (<a href="https://academy.tcm-sec.com/p/linux-privilege-escalation">https://academy.tcm-sec.com/p/linux-privilege-escalation</a>)<br />• Tib3rius: Linux Privilege Escalation for OSCP &amp; Beyond! (<a href="https://www.udemy.com/course/linux-privilege-escalation/">https://www.udemy.com/course/linux-privilege-escalation/</a>)<br /></div>
</body>
</html>
