<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>WAF Detection & Fingerprinting</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>WAF Detection & Fingerprinting</h1><br/><strong>NSE scripts all in one</strong><br /><div class="codebox"><pre>nmap -p80 --script http-waf-detect,http-waf-fingerprint &lt;target&gt;</pre></div><br /><br /><strong>Detect WAF</strong><br />• nmap --script=<code>http-waf-detect</code> (<a href="https://nmap.org/nsedoc/scripts/http-waf-detect.html">nmap reference</a>, <a href="https://github.com/nmap/nmap/blob/master/scripts/http-waf-detect.nse">github</a>)<br />    Attempts to determine whether a web server is protected by an IPS (Intrusion Prevention System), IDS (Intrusion Detection System) or WAF (Web Application Firewall) by probing the web server with malicious payloads and detecting changes in the response code and body.<br />    To do this the script will send a &quot;good&quot; request and record the response, afterwards it will match this response against new requests containing malicious payloads. In theory, web applications shouldn&#39;t react to malicious requests because we are storing the payloads in a variable that is not used by the script/file and only WAF/IDS/IPS should react to it. If aggro mode is set, the script will try all attack vectors (More noisy)<br />   ◇ <span style="text-decoration:underline;">Arguments</span>:<br />      ▪ --script-args <code>http-waf-detect.aggro</code><br />        If aggro mode is set, the script will try all attack vectors to trigger the IDS/IPS/WAF<br />      ▪ --script-args <code>http-waf-detect.uri</code>=/testphp.vulnweb.com/artists.php<br />        Target URI. Use a path that does not redirect to a different page<br /><br /><strong>Fingerprint</strong>    <br />• nmap --script=<code>http-waf-fingerprint</code> (<a href="https://nmap.org/nsedoc/scripts/http-waf-fingerprint.html">nmap reference</a>, <a href="https://github.com/PentestBox/nmap/blob/master/scripts/http-waf-fingerprint.nse">github</a>)<br />    Tries to detect the presence of a web application firewall and its type and version.<br />    This works by sending a number of requests and looking in the responses for known behavior and fingerprints such as Server header, cookies and headers values. Intensive mode works by sending additional WAF specific requests to detect certain behaviour<br />   ◇ <span style="text-decoration:underline;">Arguments</span>:<br />      ▪ --script-args <code>http-waf-fingerprint.intensive</code><br />        If set, will add WAF specific scans, which takes more time. Off by default.<br />       <div class="codebox"><pre>nmap --script=http-waf-fingerprint --script-args http-waf-fingerprint.intensive<span style="color:#ff0044;font-weight:400">=1</span> &lt;targets&gt;</pre></div><br />• wafw00f (<a href="https://github.com/EnableSecurity/wafw00f">github</a>)<br />    While the nmap script <code>http-waf-fingerprint</code> can detect only 19 different types of WAF.<br />    wafw00f can detect 152 different types of WAF! <div class="codebox"><pre>wafw00f https://example.org</pre></div></div>
</body>
</html>
