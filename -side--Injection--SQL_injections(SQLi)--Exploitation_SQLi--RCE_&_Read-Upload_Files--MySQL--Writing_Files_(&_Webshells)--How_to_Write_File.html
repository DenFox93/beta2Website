<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>How to Write File</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>How to Write File</h1><br/><br /><strong><h3>SELECT INTO OUTFILE statement</h3></strong><br />The <a href="https://mariadb.com/kb/en/select-into-outfile/">SELECT INTO OUTFILE</a> statement can be used to write data from select queries into files. This is usually used for exporting data from tables.<br />• Export data to file<br />   <div class="codebox"><pre>SELECT * from users INTO OUTFILE &#39;/tmp/credentials&#39;;</pre></div><br />        <a href=""><img src="images/2517-1.png" alt="images/2517-1.png" /></a><br />• SELECT string into files. This allow to write arbitrary files to the back-end server<br />    <div class="codebox"><pre>SELECT &#39;this is a test&#39; INTO OUTFILE &#39;/tmp/test.txt&#39;;</pre></div><br />    <span style="text-decoration:underline;">Note:</span> in order to be able to write long/advanced files, including binary data, utilize the &#39;FROM_BASE64(&quot;base64_data&quot;)&#39; function <br /><br /><br /><strong><h3>Write Files through SQL Injection</h3></strong><br />To write files, we must know the base web directory for the web server (i.e. web root).<br />• One way to find it is to use load_file to read the server configuration, like Apache&#39;s configuration found at /etc/apache2/apache2.conf, Nginx&#39;s configuration at /etc/nginx/nginx.conf, or IIS configuration at %WinDir%\System32\Inetsrv\Config\ApplicationHost.config, or we can search online for other possible configuration locations.<br />• Furthermore, we may run a fuzzing scan and try to write files to different possible web roots, using:<br />   ◇ wordlist for Linux: <a href="https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/default-web-root-directory-linux.txt">https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/default-web-root-directory-linux.txt</a><br />   ◇ wordlist for Windows: <a href="https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/default-web-root-directory-windows.txt">https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/default-web-root-directory-windows.txt</a><br />• Finally, if none of the above works, we can use server errors displayed to us and try to find the web directory that way.<br /><br /><div class="codebox"><pre>select &#39;file written successfully!&#39; into outfile &#39;/var/www/html/proof.txt&#39;</pre></div><br /><span style="color:#a52a2a;">examples of how to use this query during exploitation:</span><br />    <div class="codebox"><pre>input&#39; union select 1,&#39;file written successfully!&#39;,3,4 into outfile &#39;/var/www/html/proof.txt&#39;-- -</pre></div><br />    <a href=""><img src="images/2517-2.png" alt="images/2517-2.png" /></a><br />    We see the string we dumped along with &#39;1&#39;, &#39;3&#39; before it, and &#39;4&#39; after it. This is because the entire &#39;UNION&#39; query result was written to the file.<br />    To make the output cleaner, we can use &quot;&quot; instead of numbers.<br />    <div class="codebox"><pre>input&#39; union select &#39;&#39;,&#39;file written successfully!&#39;,&#39;&#39;,&#39;&#39; into outfile &#39;/var/www/html/proof2.txt&#39;-- -</pre></div><br />    <a href=""><img src="images/2517-3.png" alt="images/2517-3.png" /></a><br /></div>
</body>
</html>
