<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>VHosts Fuzzing</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>VHosts Fuzzing</h1><br/><br />When we need to visit a website that is not public but only local, and we want to access to it through a domain name we need add the domain to /etc/hosts.<br />This because Browsers only understand how to go to IPs, and if we provide them with a URL, they try to map the URL to an IP by looking into the local /etc/hosts file and the public DNS Domain Name System. If the URL is not in either, it would not know how to connect to it<br /><br /><div class="codebox"><pre>sudo sh -c &#39;echo &quot;SERVER_IP  academy.htb&quot; &gt;&gt; /etc/hosts&#39;</pre></div><br /><br /><br /><strong><h3>Vhost Fuzzing</h3></strong><br />How fuzz subdomins of a target that not have a public DNS record or the sub-domains under the websites are not public? <br /><br /><strong>Vhosts vs. Sub-domains</strong><br />VHost is basically a &#39;sub-domain&#39; served on the same server and has the same IP, such that a single IP could be serving two or more different websites.<br />VHosts may or may not have public DNS records.<br />Many websites would actually have sub-domains that are not public and will not publish them in public DNS records, and hence if we visit them in a browser, we would fail to connect, as the public DNS would not know their IP. <br />Once again, if we use the sub-domain fuzzing, we would only be able to identify public sub-domains but will not identify any sub-domains that are not public.<br />This is where we utilize VHosts Fuzzing on an IP we already have. We will run a scan and test for scans on the same IP, and then we will be able to identify both public and non-public sub-domains and VHosts.<br /><br />To scan for VHosts, without manually adding the entire wordlist to our /etc/hosts, we will be fuzzing HTTP headers, specifically the Host: header. To do that, we can use the -H flag to specify a header and will use the FUZZ keyword within it, as follows:<br /><br /><div class="codebox"><pre>ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://hackthebox.com/ -H &#39;Host: FUZZ.hackthebox.com&#39;</pre></div><br />	<a href=""><img src="images/2647-1.png" alt="images/2647-1.png" /></a><br /><br />ATTENTION: Once we have found a valid subdomain add it to the file /etc/hosts<br />	<div class="codebox"><pre>sudo sh -c &#39;echo &quot;SERVER_IP  subdomain.academy.htb&quot; &gt;&gt; /etc/hosts&#39;</pre></div><br />	<br /><strong>For local Websites</strong><br />all words in the wordlist should returning 200 OK! This is expected, as we are simply changing the header while visiting http://example.com:PORT/. So, we know that we will always get 200 OK. However, if the VHost does exist and we send a correct one in the header, we should get a different response size, as in that case, we would be getting the page from that VHosts, which is likely to show a different page.</div>
</body>
</html>
