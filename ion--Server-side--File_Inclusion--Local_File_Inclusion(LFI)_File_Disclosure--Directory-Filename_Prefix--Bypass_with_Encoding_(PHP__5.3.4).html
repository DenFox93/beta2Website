<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Bypass with: Encoding (PHP < 5.3.4)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Bypass with: Encoding (PHP < 5.3.4)</h1><br/><strong><h3>Encoding</h3></strong><br />Web filters may prevent input that include certain LFI-related characters used for path traversals, like dot <code>.</code> or slash <code>/</code> <br /> These filters may be <span style="text-decoration:underline;">bypassed by URL encoding our input</span>, such that it would no longer include these bad characters, but would still be decoded back to our path traversal string once it reaches the vulnerable function. <br /> <strong>Vulnerable code to bypass through URL encoding:</strong><br />   ◇ Core PHP filters on versions 5.3.4 and earlier <br />   ◇ Newer versions with custom filters<br /><br />To encode the characters you can use:<br />• CTRL+U inside Burp<br />• Decoder inside Burp<br />• Online Tools<br /><br /><span style="color:#a52a2a;">example BYPASS:</span><br />    ENCODING<br />    <a href=""><img src="images/2334-1.png" alt="images/2334-1.png" /></a><br /> <br /><strong>Web Application Filtering</strong><br />Web applications sometime perform filtering operations on these nasty characters:<br />   ◇ .<br />   ◇ \<br />   ◇ /<br />Because of that we should be aware of different <span style="text-decoration:underline;">encodings</span>:<br />    <table class="table"><tr><th>character</th><th>URL encoding</th><th>double URL encoding</th></tr><tr><td>.</td><td>%2e</td><td> </td></tr><tr><td>/</td><td>%2f</td><td>%252F</td></tr><tr><td>\</td><td>%5c</td><td>%255c</td></tr></table><br />    see here(<a href="https://owasp.org/www-community/Double_Encoding">https://owasp.org/www-community/Double_Encoding</a>) for more on Double Encoding<br />Payloads(combinations of the previous encodings):<br />    <table class="table"><tr><th>../</th><th>..\</th></tr><tr><td>%2e%2e%2f</td><td>%2e%2e%5c</td></tr><tr><td>%2e%2e/</td><td>%2e%2e\</td></tr><tr><td>..%2f</td><td>..%5c</td></tr><tr><td>..%252f</td><td>%252e%252e%255c</td></tr></table><br /><br /><br /><br /> <br /> <br /><span style="text-decoration:underline;">NOTE:</span> <br />• double encoding, may bypass other types of filters.<br />•  efer to the &quot;Command Injections&quot; chapter for more about bypassing various blacklisted characters, as the same techniques may be used with LFI as well.<br /><span style="text-decoration:underline;">Note:</span> This technique should work regardless of the back-end development language or framework.</div>
</body>
</html>
