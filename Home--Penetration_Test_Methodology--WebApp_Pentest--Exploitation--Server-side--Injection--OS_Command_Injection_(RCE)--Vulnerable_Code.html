<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Vulnerable Code</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Vulnerable Code</h1><br/><br /><strong><h3>PHP</h3></strong><br />Functions that allow to execute commands directly on the back-end server: <br /><div class="codebox"><pre>exec<br />system<br />shell_exec<br />passthru<br />popen</pre></div><br /><span style="color:#865e3c;">example vulnerable code: system()</span><br />	<h3> </h3>Example of a vulnerable functionality that allows users to create a new .pdf document that gets created in the /tmp directory with a file name supplied by the user<br />	<div class="codebox"><pre><span style="color:#333333;font-weight:400">&lt;?php</span><br /><span style="color:#ff9d00;font-weight:700">if</span> <span style="color:#ff9d00;font-weight:400">(isset(</span><span style="color:#333333;font-weight:400">$_GET[</span><span style="color:#3ad900;font-weight:400">&#39;filename&#39;</span><span style="color:#333333;font-weight:400">]</span><span style="color:#ff9d00;font-weight:400">))</span> {<br />    system<span style="color:#ff9d00;font-weight:400">(</span><span style="color:#3ad900;font-weight:400">&quot;touch /tmp/&quot;</span> <span style="color:#ff9d00;font-weight:400">.</span> <span style="color:#333333;font-weight:400">$_GET[</span><span style="color:#3ad900;font-weight:400">&#39;filename&#39;</span><span style="color:#333333;font-weight:400">]</span> <span style="color:#ff9d00;font-weight:400">.</span> <span style="color:#3ad900;font-weight:400">&quot;.pdf&quot;</span><span style="color:#ff9d00;font-weight:400">);</span><br />}<br /><span style="color:#333333;font-weight:400">?&gt;</span></pre></div><br /><br /><strong><h3>NodeJS</h3></strong><br />Functions that allow to execute commands directly on the back-end server: <br /><div class="codebox"><pre>child_process.exec<br />child_process.spawn</pre></div><br /><span style="color:#865e3c;">example vulnerable code: child_process.exec()</span><br />	Example of a vulnerable functionality that allows users to create a new .pdf document that gets created in the /tmp directory with a file name supplied by the user<br />	<div class="codebox"><pre>app.get(&quot;/createfile&quot;, function(req, res){<br />    child_process.exec(`touch /tmp/${req.query.filename}.txt`);<br />})</pre></div><br /><br /></div>
</body>
</html>
